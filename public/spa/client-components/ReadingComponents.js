(window.webpackJsonp=window.webpackJsonp||[]).push([[17],Array(335).concat([function(t,e,n){var i=n(513);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e,n){var i=n(515);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"Are you sure to delete this comment?":"您確定要刪除這則留言嗎？"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(518);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"Load previous {0} comments...":"Load previous {0} comment... | Load previous {0} comments...","Load next {0} comments...":"Load next {0} comment... | Load next {0} comments..."},"zh-TW":{"Load previous {0} comments...":"讀取前面 {0} 篇留言...","Load next {0} comments...":"讀取後面 {0} 篇留言...","Write the first comment now":"沒有留言，要不要寫下第一個留言呢？","No More":"沒有更多留言了"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(521);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"TEST_MESSAGE":"Test Message"},"zh-TW":null}'),delete t.options._Ctor}},function(t,e,n){var i=n(524);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"TEST_MESSAGE":"Test Message"},"zh-TW":{"TEST_MESSAGE":"測試訊息"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(527);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"TEST_MESSAGE":"Test Message"},"zh-TW":{"Hint":"顯示教學"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(530);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"TEST_MESSAGE":"Test Message"},"zh-TW":{"Hint":"顯示說明"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(533);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e,n){var i=n(535);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"ADD":"記下「重點」","UPDATE":"更新「重點」"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(538);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e,n){var i=n(540);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":null}'),delete t.options._Ctor}},function(t,e,n){var i=n(543);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"Write your question":"寫下您的問題","What is it?":"這是什麼？","Why is it?":"為什麼會發生這件事情？"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(546);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"Find your answer":"找尋解答","Find answers from Google":"從Google找解答","Find answers from Wikipedia":"從維基百科找解答"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(549);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"SAVE QUESTION":"記下「疑問」","SAVE ANSWER":"改為「已澄清」","WRITE LATER":"暫存「疑問」"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(552);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e,n){var i=n(554);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"I don\'t know what is \\"{0}\\"?":"I don\'t know what is \\"{0}\\"?","Why is \\"{0}\\"?":"Why is \\"{0}\\"?"},"zh-TW":{"I don\'t know what is \\"{0}\\"?":"我不知道什麼是「{0}」？","Why is \\"{0}\\"?":"為什麼是「{0}」？","Question":"問題","Answer":"解答","Do you want to use his comment as your answer?":"您要將這個評論作為您的解答嗎？","New question will overwrite your question. Are you sure?":"您要用新問題取代目前的問題嗎？"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(557);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"ADD":"記下「小節重點」","UPDATE":"更新「小節重點」"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(560);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e,n){var i=n(562);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e,n){var i=n(564);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"Find {0} Annotations":"Find {0} Annotations | Find {0} Annotations"},"zh-TW":{"Back to list":"回到列表","Back to full list":"回到完整列表","Finding":"正在搜尋","No Search Result":"沒有符合的標註","No More":"沒有更多標註了","Find {0} Annotations":"總共搜尋出{0}篇標註"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(567);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e,n){var i=n(569);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"Find {0} Annotations":"Find {0} Annotations | Find {0} Annotations"},"zh-TW":{"Back to list":"回到列表","Back to full list":"回到完整列表","Finding":"正在搜尋","No Search Result":"沒有符合的標註","No More":"沒有更多標註了","Find {0} Annotations":"總共搜尋出{0}篇標註"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(572);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"TEST_MESSAGE":"Test Message"},"zh-TW":{"Back to list":"回到列表","Back to full list":"回到完整列表","Finding":"正在搜尋"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(575);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e,n){var i=n(577);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"You are still editing. Are you sure to discard changes?":"您還在編輯中。您確定要放棄嗎？","You can add note for the annotation.":"您可以為標註添增筆記。","Click \\"ADD\\" to save it.":"按下記下「重點」即可儲存標註。"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(580);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"List Annotations":"列出標註","Select an annotation type to highlight the selected text.":"請為你要標註的文字選擇一種類型。","For example, if you choose \\"Main Idea\\" type.":"舉例來說，如果您選擇「重點」類型"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(583);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"List all {0} annotations...":"List all {0} annotation... | List all {0} annotations..."},"zh-TW":{"List all {0} annotations...":"列出全部{0}篇標註..."}}'),delete t.options._Ctor}},function(t,e,n){var i=n(586);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"You can read other\'s annotations.":"您可以看到其他讀者的標註了。","Select text to highlight.":"請選擇您看不懂或是覺得是重點的文字。"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(589);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"Check list":"檢核單","Write section main ideas":"撰寫小節重點","Edit section main ideas":"編輯小節重點","I have already read this section.":"我已經讀完了這一節的內容。","I have already written annotations on a sentence I don\'t understand.":"我看不懂的地方，已經用「疑問」標示了。","I have already written the main ideas of this section.":"我已經寫完小節重點了。","Please finish checklist.":"請完成這份檢核單","I have read this section!":"我已經讀完這一節了！"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(592);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"Write section main ideas":"撰寫小節重點","Edit section main ideas":"編輯小節重點"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(595);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"TEST_MESSAGE":"Test Message"},"zh-TW":{"TEST_MESSAGE":"測試訊息"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(598);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"You can see others\' section main ideas.":"您可以看到別人撰寫的小節重點標註了。","After reading a section of the article, you have to finish the section checklist.":"在讀完一個小節之後，請您完成這個小節的檢核單。","When you finish all section checklists, you will go to next step.":"當您完成所有小節檢核單之後，您將會前往下一個閱讀階段。"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(601);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"Search...":"搜尋..."}}'),delete t.options._Ctor}},function(t,e,n){var i=n(604);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"TEST_MESSAGE":"Test Message"},"zh-TW":{"OK":"我知道了！","Close":"略過","Start Tutorial":"我知道了，開始操作導覽"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(607);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"In {0} step":"In {0} step"},"zh-TW":{"In {0} step":"在 {0} 階段","Open Administration Panel":"開啟管理工具"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(610);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"About PACOR":"關於PACOR"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(613);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"All":"全部"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(616);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"TEST_MESSAGE":"Test Message"},"zh-TW":{"TEST_MESSAGE":"測試訊息"}}'),delete t.options._Ctor}},function(t,e,n){var i=n(619);"string"==typeof i&&(i=[[t.i,i,""]]);var o={insert:"head",singleton:!1};n(7)(i,o);i.locals&&(t.exports=i.locals)},function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":null,"zh-TW":{"All Types":"全部標註","Type Filtering":"選擇標註類型"}}'),delete t.options._Ctor}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i=n(335);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"[data-pacor-section-seq-id] [data-pacor-paragraph-seq-id] .pacor-selection{background-color:rgba(0,0,255,.7);color:#fff}[data-pacor-section-seq-id] [data-pacor-paragraph-seq-id] .pacor-hover{text-shadow:0 0 10px #fff,0 0 20px #ff0,0 0 30px #ff0}[data-pacor-section-seq-id] [data-pacor-paragraph-seq-id] .pacor-search-result{font-weight:700!important;background-color:#ff0!important;color:red!important}",""])},function(t,e,n){"use strict";var i=n(336);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".meta[data-v-7749c093]{float:right;user-select:none;line-height:2em!important;display:flex}.user[data-v-7749c093]{display:inline-block}.avatar[data-v-7749c093]{max-height:2em;width:auto}.avatar[data-v-7749c093],.colon[data-v-7749c093]{margin-right:.5em}.colon[data-v-7749c093],.username[data-v-7749c093]{max-width:5em;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.colon[data-v-7749c093],.note[data-v-7749c093],.username[data-v-7749c093]{display:inline-block;vertical-align:top;line-height:2em}.clickable[data-v-7749c093]{cursor:pointer!important}.meta .control-buttons[data-v-7749c093],.meta[data-v-7749c093]  .AnnotationInteractive{margin-left:.5em}.annotation-item-compact[data-v-7749c093]{padding-top:.5em!important;padding-bottom:.5em!important;margin-bottom:.5em!important}.annotation-item-compact .text-container[data-v-7749c093]{line-height:2em;display:inline-block;vertical-align:top}.annotation-item-compact .left.column[data-v-7749c093]{max-width:70vw;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.annotation-item-compact .note[data-v-7749c093]{display:inline-block;margin-left:.5em;white-space:nowrap;max-width:calc(100vw - 28em);text-overflow:ellipsis;overflow:hidden}@media (max-width:480px){.AnnotationItem.annotation-item-compact[data-v-7749c093]  .AnnotationTypeButton{text-indent:-9999px;padding-left:0;padding-right:0;width:1em}.AnnotationItem.annotation-item-compact .note[data-v-7749c093]{max-width:calc(100vw - 10em)}.AnnotationItem.annotation-item-compact .display-time[data-v-7749c093]{max-width:0;overflow-x:hidden}}",""])},function(t,e,n){"use strict";var i=n(337),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(338);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".AnnotationDiscussionList[data-v-e134047a]{overflow-y:auto;border-radius:.3em;border:0 solid #ccc}.no-more[data-v-e134047a]{text-align:center;color:grey;user-select:none;cursor:pointer}@media (max-width:767px){.AnnotationDiscussionList[data-v-e134047a]{height:inherit!important;max-height:inherit!important}.AnnotationDiscussionList.little-comments[data-v-e134047a]{padding-bottom:1em}}",""])},function(t,e,n){"use strict";var i=n(339),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(340);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".AnnotationDiscussionInput[data-v-55f1394b]{white-space:nowrap;overflow:hidden;padding-top:.5em;border-top:1px solid #ccc}img[data-v-55f1394b]{height:2em;width:auto;float:left;max-width:inherit!important}.username[data-v-55f1394b]{display:inline-block;max-width:5em;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;vertical-align:top;line-height:2em;margin-left:.5em;margin-right:.5em}.input-field[data-v-55f1394b]{width:calc(100% - 3em)!important;display:inline-block!important}.right-column[data-v-55f1394b]{float:right}.right-column>span[data-v-55f1394b]{display:inline-block;vertical-align:top}.right-column button[data-v-55f1394b]{height:42px}.left-column[data-v-55f1394b]{width:8em}.center-column[data-v-55f1394b],.left-column[data-v-55f1394b],.right-column[data-v-55f1394b]{display:inline-block;vertical-align:middle}",""])},function(t,e,n){"use strict";var i=n(341),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(342);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";var i=n(343),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(344);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"img[data-v-0a95f64e]{height:2em;width:auto;float:left;max-width:inherit!important}.username[data-v-0a95f64e]{display:inline-block;max-width:100%;text-overflow:ellipsis;vertical-align:top;line-height:2em;margin-left:.5em;margin-right:.5em}.UserInformation[data-v-0a95f64e],.username[data-v-0a95f64e]{white-space:nowrap;overflow:hidden}@media only screen and (max-width:767px){.edit-mode .user-avatar[data-v-0a95f64e],.edit-mode .username[data-v-0a95f64e]{display:none}}",""])},function(t,e,n){"use strict";var i=n(345),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(346);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".AnnotaionInstruction[data-v-a3af9796]{vertical-align:top;padding-top:.6em;padding-bottom:.6em;margin-top:-.1em}.show-instruction[data-v-a3af9796],.summary[data-v-a3af9796]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:100%;vertical-align:top}.show-instruction[data-v-a3af9796]{float:right;margin-left:.5em;margin-top:-.4em}.column[data-v-a3af9796]:not(.grid){padding:.5em!important}.column:not(.grid).right[data-v-a3af9796]{padding-left:0!important}@media (max-width:480px){.summary[data-v-a3af9796]{text-indent:-9999px}.AnnotaionInstruction[data-v-a3af9796]{padding-left:0;padding-right:.5em}}@media (max-width:360px){.AnnotaionInstruction[data-v-a3af9796]{display:none}}",""])},function(t,e,n){"use strict";var i=n(347),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(348);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".right[data-v-e6bd675a]{float:right;margin-top:-.6em;max-width:calc(100% - 16em)}.AnnotationEditorHeader[data-v-e6bd675a]{margin-bottom:1em}@media only screen and (max-width:991px){.AnnotationSingle.column .right[data-v-e6bd675a]{max-width:100%}.AnnotationSingle.column.two .right[data-v-e6bd675a]{max-width:calc(100% - 6em)}}",""])},function(t,e,n){"use strict";var i=n(349);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".annotation-panel-buttons[data-v-e454a39e]  .AnnotationInteractive{vertical-align:top;margin-right:.5em}",""])},function(t,e,n){"use strict";var i=n(350),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(351);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".annotation-panel-buttons[data-v-7a079aa8]{user-select:none;white-space:nowrap}.display-time[data-v-7a079aa8]{display:inline-block;vertical-align:top;line-height:2.3em;margin-right:.5em}",""])},function(t,e,n){"use strict";var i=n(352);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";var i=n(353),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(354);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".QuestionTemplate[data-v-bdafffe6]{line-height:2em}.label.field[data-v-bdafffe6]{line-height:40px;width:10em!important;white-space:nowrap;overflow:hidden}.label.field[data-v-bdafffe6],.label.field label[data-v-bdafffe6]{cursor:pointer}.select.field[data-v-bdafffe6]{width:calc(100% - 10em)!important}",""])},function(t,e,n){"use strict";var i=n(355),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(356);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"label[data-v-c94b37e6]{vertical-align:middle}.search-keyword[data-v-c94b37e6]{width:calc(100% - 15em)!important;height:40px}.search-button[data-v-c94b37e6],.select-question[data-v-c94b37e6]{height:43px!important}.label.field[data-v-c94b37e6]{line-height:40px;white-space:nowrap;overflow:hidden}",""])},function(t,e,n){"use strict";var i=n(357),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(358);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".annotation-panel-buttons[data-v-6fa9e8ca]  .AnnotationInteractive{margin-right:4px}.buttons-row>button[data-v-6fa9e8ca]{padding-left:.5em;padding-right:.5em}.buttons-row.second[data-v-6fa9e8ca]{margin-top:.5em}.buttons-row.second .delete-button[data-v-6fa9e8ca]{vertical-align:middle}",""])},function(t,e,n){"use strict";var i=n(359),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(360);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".annotation-panel-buttons[data-v-3882afce]{user-select:none;white-space:nowrap}.display-time[data-v-3882afce]{display:inline-block;vertical-align:top;line-height:2.3em;margin-right:.5em}",""])},function(t,e,n){"use strict";var i=n(361);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".display-time[data-v-3882afce]{vertical-align:baseline}",""])},function(t,e,n){"use strict";var i=n(362),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(363);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";var i=n(364),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(365);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".AnnotationSingle[data-v-16dcafa3]{overflow-y:auto}.AnnotationSingle[data-v-16dcafa3]  .annotation-panel-buttons{margin-top:-.5em!important;max-width:100%!important;overflow-x:auto!important;overflow-y:hidden!important;margin-left:0!important}.AnnotationSingle[data-v-16dcafa3]  .annotation-panel-buttons>.column{padding:.5em 0!important}.AnnotationSingle[data-v-16dcafa3]  .annotation-panel-buttons .ValidationButton{vertical-align:top}.AnnotationSingle[data-v-16dcafa3]  .annotation-panel-buttons .AdminBadge,.AnnotationSingle[data-v-16dcafa3]  .annotation-panel-buttons .UserSelfBadge{vertical-align:super}.AnnotationSingle[data-v-16dcafa3]  .annotation-panel-buttons .display-time{display:inline-block;vertical-align:baseline;line-height:2.3em;margin-right:.5em}.AnnotationSingle.display-mode[data-v-16dcafa3]  .annotation-panel-buttons{margin-top:.5rem!important}.AnnotationSingle.display-mode[data-v-16dcafa3]  .annotation-panel-buttons .display-time{vertical-align:middle}.AnnotationSingle .annotation-discussion>.divider[data-v-16dcafa3]{display:none}@media (max-width:767px){.ui.stackable.grid.AnnotationSingle .annotation-discussion[data-v-16dcafa3]{padding-top:0!important}.ui.stackable.grid.AnnotationSingle .annotation-discussion>.divider[data-v-16dcafa3]{display:block}.ui.stackable.grid.AnnotationSingle .annotation-editor[data-v-16dcafa3]{max-height:100%!important}}@media (min-width:767px){.AnnotationSingle .annotation-discussion[data-v-16dcafa3]{border-left:1px solid #d4d5d6!important}.AnnotationSingle .annotation-editor[data-v-16dcafa3]{overflow-y:auto}}@media only screen and (max-width:991px){.AnnotationSingle.two.column[data-v-16dcafa3]  .AnnotationEditorHeader.edit-mode .left.column .user-avatar,.AnnotationSingle.two.column[data-v-16dcafa3]  .AnnotationEditorHeader.edit-mode .left.column .username{display:none}.AnnotationSingle.two.column[data-v-16dcafa3]  .AnnotationEditorHeader.edit-mode .left.column{width:calc(100% - 6em)}.AnnotationSingle.two.column[data-v-16dcafa3]  .html-editor-container .note-toolbar.center{text-align:right}.AnnotationSingle.two.column[data-v-16dcafa3]  .html-editor-container.editor-left-handed .note-toolbar.center{text-align:left}.AnnotationSingle.two.column[data-v-16dcafa3]  .AnnotationComment .meta .display-time{display:none}}",""])},function(t,e,n){"use strict";var i=n(366);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".back-button[data-v-64ecd929]{vertical-align:top!important}.summary-information[data-v-64ecd929]{white-space:nowrap}.summary-information .label[data-v-64ecd929]{display:inline-block;line-height:2em;vertical-align:top;margin-left:.5em;margin-right:.5em;user-select:none}.summary-information[data-v-64ecd929]  .UserAvatarIcons{margin-right:.5em}.summary-information[data-v-64ecd929]  .AnnotationTypeButton{vertical-align:top;padding-left:.5em;padding-right:.5em}.list[data-v-64ecd929]{overflow-x:hidden;overflow-y:auto;padding-right:1em}.no-more[data-v-64ecd929]{text-align:center;color:grey;user-select:none}.pacor-search-result[data-v-64ecd929]{font-weight:700!important;background-color:#ff0!important;color:red!important}.search-input[data-v-64ecd929]{float:right;vertical-align:top;margin-top:-.3em}",""])},function(t,e,n){"use strict";var i=n(367);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"@media only screen and (max-width:767px){.summary-information .search-input[data-v-64ecd929]{width:calc(100% - 10em)}.summary-information .counting.label[data-v-64ecd929]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;max-width:10em}.summary-information[data-v-64ecd929]  .AnnotationTypeButton,.summary-information[data-v-64ecd929]  .UserAvatarIcons{display:none}.list[data-v-64ecd929]{padding-right:0}}@media only screen and (max-width:480px){.list[data-v-64ecd929]  .AnnotationItem .annotation-item-header .username{display:none!important}.list[data-v-64ecd929]  .AnnotationItem .AnnotationInteractive .button:not(.with-count){width:0!important;padding:0!important}}",""])},function(t,e,n){"use strict";var i=n(368),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(369);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".back-button[data-v-0dc943e9]{vertical-align:top!important}.summary-information[data-v-0dc943e9]{white-space:nowrap}.summary-information .label[data-v-0dc943e9]{display:inline-block;line-height:2em;vertical-align:top;margin-left:.5em;margin-right:.5em;user-select:none}.summary-information[data-v-0dc943e9]  .UserAvatarIcons{margin-right:.5em}.summary-information[data-v-0dc943e9]  .AnnotationTypeButton{vertical-align:top;padding-left:.5em;padding-right:.5em}.list[data-v-0dc943e9]{overflow-x:hidden;overflow-y:auto;padding-right:1em}.no-more[data-v-0dc943e9]{text-align:center;color:grey;user-select:none}.pacor-search-result[data-v-0dc943e9]{font-weight:700!important;background-color:#ff0!important;color:red!important}.search-input[data-v-0dc943e9]{float:right;vertical-align:top;margin-top:-.3em}",""])},function(t,e,n){"use strict";var i=n(370);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"@media only screen and (max-width:767px){.summary-information .search-input[data-v-0dc943e9]{width:calc(100% - 10em)}.summary-information .counting.label[data-v-0dc943e9]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;max-width:10em}.summary-information[data-v-0dc943e9]  .AnnotationTypeButton,.summary-information[data-v-0dc943e9]  .UserAvatarIcons{display:none}.list[data-v-0dc943e9]{padding-right:0}}@media only screen and (max-width:480px){.list[data-v-0dc943e9]  .AnnotationItem .annotation-item-header .username{display:none!important}.list[data-v-0dc943e9]  .AnnotationItem .AnnotationInteractive .button:not(.with-count){width:0!important;padding:0!important}}",""])},function(t,e,n){"use strict";var i=n(371),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(372);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".back-button[data-v-5688f63a]{vertical-align:top!important}.summary-information .label[data-v-5688f63a]{display:inline-block;line-height:2em;vertical-align:top;margin-left:.5em;margin-right:.5em;user-select:none}.list[data-v-5688f63a]{overflow-x:hidden;overflow-y:auto;padding-right:1em}.no-more[data-v-5688f63a]{text-align:center;color:grey}.pacor-search-result[data-v-5688f63a]{font-weight:700!important;background-color:#ff0!important;color:red!important}",""])},function(t,e,n){"use strict";var i=n(373),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(374);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".AnnotationPanel[data-v-62f82089]{filter:drop-shadow(0 0 .5em #000000)}.annotation-panel[data-v-62f82089]{position:fixed!important;margin-top:0!important;margin-bottom:0!important;left:1.5em!important;bottom:0!important;width:calc(100vw - 4em)!important;z-index:102!important}.annotation-panel>.ui.segment.form[data-v-62f82089]{border-bottom-left-radius:0;border-bottom-right-radius:0;padding:1em!important;border-top-width:5px!important;border-top-style:double!important}.annotation-panel.hidden[data-v-62f82089]{display:none}.annotation-panel .ui.segment.form[data-v-62f82089]{padding:0}.annotation-panel .close-container.floating.ui.label[data-v-62f82089]{float:right;cursor:pointer;user-select:none;z-index:2;left:100%!important;padding:.31em .5em .4em .2em!important;top:-1em!important;border:2px solid #fff!important;border-radius:2em!important;position:absolute!important}@media (max-width:480px){.annotation-panel .close-container.floating.ui.label[data-v-62f82089]{position:fixed!important;top:-1em!important}}.annotation-panel .close-container.floating.ui.label .close.icon[data-v-62f82089]{opacity:1!important;color:#fff;margin-left:.3em;margin-bottom:-.2em;margin-top:.1em}.resize-handler[data-v-62f82089]{width:calc(100% - 1.5em);height:2em;cursor:grab;margin-top:-2em;position:relative;z-index:1}.resize-handler.moving[data-v-62f82089]{cursor:grabbing}@media (max-width:767px){.annotation-panel .ui.segment.form.main-segment[data-v-62f82089]{padding-left:0!important;padding-right:0!important}.annotation-panel .close-container.floating.ui.label[data-v-62f82089]{top:-1.2em;left:calc(100% + .3em)!important}.annotation-panel .close-container.floating.ui.label .close.icon[data-v-62f82089]{margin-left:.4em!important;margin-bottom:-.1em!important}}",""])},function(t,e,n){"use strict";var i=n(375);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"body.pacor-disable-user-select{user-select:none;cursor:grabbing}",""])},function(t,e,n){"use strict";var i=n(376),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(377);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";var i=n(378),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(379);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".annotation-float-widget[data-v-72028fd0]{transition:opacity .3s,z-index .3s;opacity:0;filter:drop-shadow(0 0 .5em #000000);position:fixed!important;left:1em;z-index:-1;width:calc(100vw - 4em);top:calc(60px + 1em);overflow-x:hidden;overflow-y:auto}@media only screen and (max-height:700px){.annotation-float-widget[data-v-72028fd0]{top:1em;max-height:inherit}}.annotation-float-widget.show[data-v-72028fd0]{opacity:1;z-index:10}.annotation-float-widget.bottom[data-v-72028fd0]{top:auto;bottom:calc(60px + 1em)}@media only screen and (max-height:700px){.annotation-float-widget.bottom[data-v-72028fd0]{bottom:5em}.annotation-float-widget.bottom.show[data-v-72028fd0]{z-index:999}}.annotation-float-widget.bottom.selecting[data-v-72028fd0]{width:calc(100vw - 14em)}.annotation-float-widget .list-button[data-v-72028fd0]{margin-left:.5em;margin-right:.5em;vertical-align:top!important;direction:ltr}.annotation-float-widget .footer-row>.column[data-v-72028fd0]{white-space:nowrap;overflow-x:auto;overflow-y:hidden;max-width:100%;margin-left:1em;margin-right:1em;padding-left:0!important;padding-right:0!important}.close-container.floating.ui.label[data-v-72028fd0]{float:right;cursor:pointer;user-select:none;z-index:2;left:calc(100% - .3em)!important;padding:.3em .4em .3em .15em!important;top:.9em!important;border:2px solid #fff!important;border-radius:2em!important}.close-container.floating.ui.label .close.icon[data-v-72028fd0]{opacity:1!important;color:#fff;margin-left:.3em;margin-bottom:-.2em}.footer-row .UserAvatarIcons[data-v-72028fd0]{vertical-align:top}@media only screen and (max-width:767px){.footer-row>.column[data-v-72028fd0]  .AnnotationTypeButton,.footer-row>.column[data-v-72028fd0]  .UserAvatarIcons{display:none}}",""])},function(t,e,n){"use strict";var i=n(380),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(381);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";var i=n(382),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(383);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".header-container[data-v-f84ea218]{text-align:center;margin-bottom:.5em}.header[data-v-f84ea218]{user-select:none;display:inline-block}.item[data-v-f84ea218]{line-height:2em!important;cursor:pointer}.item label[data-v-f84ea218]{cursor:pointer!important;user-select:none}.item[data-v-f84ea218]:hover{font-weight:700}",""])},function(t,e,n){"use strict";var i=n(384),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(385);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";var i=n(386),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(387);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".SectionAnnotationList .annotation-list[data-v-0339763a]{max-height:20em;overflow-x:hidden;overflow-y:auto;margin-bottom:1em}.no-more[data-v-0339763a]{color:grey}.no-more[data-v-0339763a],.summary-information[data-v-0339763a]{text-align:center}.my-annotation[data-v-0339763a]{margin-top:.5rem!important}",""])},function(t,e,n){"use strict";var i=n(388),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(389);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";var i=n(390),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(391);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".mini input[type=text][data-v-5624c452]{width:7em}input[data-v-5624c452]{padding-top:0!important;padding-bottom:0!important;font-size:1.2em!important}button[data-v-5624c452]{background-color:#fff!important;padding:.65em .7em .7em!important;border:1px solid rgba(34,36,38,.15)!important;border-left-width:0!important}",""])},function(t,e,n){"use strict";var i=n(392),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(393);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";var i=n(394),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(395);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".username[data-v-6eab25ef]{margin-left:.5em;font-size:1.5em;font-weight:700}@media (max-width:480px){.username[data-v-6eab25ef]{display:none}}.username .step[data-v-6eab25ef]{font-size:1rem;font-weight:400;line-height:1.5em}.user-avatar[data-v-6eab25ef]{max-height:2.5em;width:auto!important}.avatar img[data-v-6eab25ef],.cog.icon[data-v-6eab25ef]{margin-left:.5em!important}.vertical-menu .avatar.item[data-v-6eab25ef]{display:inline-block}.vertical-menu .avatar.item[data-v-6eab25ef]:before{background-color:transparent!important}.vertical-menu .avatar.item img[data-v-6eab25ef]{display:inline-block!important;vertical-align:middle}.vertical-menu .avatar.item .username[data-v-6eab25ef]{margin-left:0!important;display:inline;vertical-align:middle}.vertical-menu .avatar.item .username .step[data-v-6eab25ef]{margin-top:.5em}.vertical-menu .NavigationHeaderItem[data-v-6eab25ef]  .UserAvatar img{vertical-align:top}.vertical-menu .NavigationHeaderItem[data-v-6eab25ef]  .UserAvatar .icon-container .icon{margin-top:-.2em}.NavigationHeaderItem[data-v-6eab25ef]  .UserAvatar{margin-left:.5rem}.NavigationHeaderItem[data-v-6eab25ef]  .UserAvatar .icon-container{top:1.4em;left:-.5em;text-align:right}.NavigationHeaderItem[data-v-6eab25ef]  .UserAvatar .icon-container .icon{margin-top:.05em;font-size:.8em;margin-left:0;margin-right:.15em}",""])},function(t,e,n){"use strict";var i=n(396),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(397);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";var i=n(398),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(399);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".TypeItem[data-v-28af1646]{white-space:nowrap;cursor:pointer;margin-top:.5em;margin-bottom:.5em;text-align:center}.TypeItem[data-v-28af1646]:hover{color:#1e70bf}.column[data-v-28af1646]{display:inline-block;vertical-align:middle}.column.button[data-v-28af1646]{margin-left:.5em!important;margin-right:.5em!important}img[data-v-28af1646]{max-height:1.5em;width:auto}.username[data-v-28af1646]{font-weight:700}",""])},function(t,e,n){"use strict";var i=n(400),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(401);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"",""])},function(t,e,n){"use strict";var i=n(402),o=n.n(i);e.default=o.a},function(t,e,n){"use strict";var i=n(403);n.n(i).a},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,".AnnotationTypeFilter[data-v-76134036]{padding-left:0!important;padding-right:0!important}.AnnotationTypeFilter[data-v-76134036]  .AnnotationTypeButton{padding:.5em .7em!important}.vertical.menu .item-icon[data-v-76134036]{float:right;margin-top:-.2em;margin-right:-.5em}.vertical.menu>.AnnotationTypeFilter[data-v-76134036]{padding-left:1.14286em!important;padding-right:1.14286em!important}",""])},function(t,e,n){"use strict";var i=n(404),o=n.n(i);e.default=o.a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e);function i(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"annotation-panel AnnotationPanel",class:{hidden:e.isHide}},[n("div",{ref:"panel",staticClass:"ui secondary segment form main-segment",class:e.computedSegmentClass,style:e.computedSegmentStyle},[n("div",{staticClass:"close-container floating ui black label",on:{click:function(t){return t.stopPropagation(),e.hide(t)}}},[n("i",{staticClass:"close icon"})]),e._v(" "),n("div",{staticClass:"resize-handler",class:{moving:e.resizeLocker},on:{mousedown:e.onResizeStart,touchstart:e.onResizeStart}}),e._v(" "),e.panelData.annotation?[n("annotation-single",{ref:"AnnotationSingle",attrs:{config:e.config,status:e.status,lib:e.lib,panelData:e.panelData,annotation:e.panelData.annotation,heightPX:e.panelData.heightPX},on:{update:e.hide,delete:e.hide}})]:e._e(),e._v(" "),e.panelData.anchorPositions?[n("annotation-list",{ref:"AnnotationList",attrs:{config:e.config,status:e.status,lib:e.lib,panelData:e.panelData}})]:e._e()],2)])}function o(){var t=this,e=t.$createElement,n=t._self._c||e;return n("fragment",[n("main-list",{directives:[{name:"show",rawName:"v-show",value:!t.isFiltering,expression:"!isFiltering"}],ref:"MainList",attrs:{config:t.config,status:t.status,lib:t.lib,panelData:t.panelData}}),t._v(" "),t.isFiltering?n("filtered-list",{ref:"FilteredList",attrs:{config:t.config,status:t.status,lib:t.lib,MainList:t.MainList,panelData:t.panelData},on:{exit:t.onFilteredListExit}}):t._e()],1)}o._withStripped=i._withStripped=!0;function a(){var n=this,t=n.$createElement,i=n._self._c||t;return i("div",{staticClass:"MainList"},[n.isHeaderVisible?[i("div",{staticClass:"summary-information"},[null===n.annotation?i("div",{staticClass:"ui icon input search-input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:n.panelData.keyword,expression:"panelData.keyword"}],attrs:{type:"text",placeholder:n.$t("Search..."),onfocus:"this.select()"},domProps:{value:n.panelData.keyword},on:{input:function(t){t.target.composing||n.$set(n.panelData,"keyword",t.target.value)}}}),n._v(" "),i("i",{staticClass:"search icon"})]):n._e(),n._v(" "),n.annotation?i("button",{staticClass:"ui mini labeled icon button back-button",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),n.backToList(t)}}},[i("i",{staticClass:"angle left icon"}),n._v("\r\n        "+n._s(n.$t("Back to list"))+"\r\n      ")]):n._e(),n._v(" "),null===n.annotation?[i("div",{staticClass:"counting label"},[n._v("\r\n          "+n._s(n.$t("Total {0} Annotations",[n.annotationCount]))+":\r\n        ")]),n._v(" "),i("user-avatar-icons",{attrs:{config:n.config,status:n.status,lib:n.lib,users:n.users,userCount:n.userCount},on:{find:n.findUser}}),n._v(" "),n._l(n.types,function(t){return i("annotation-type-button",{key:t.type,attrs:{lib:n.lib,config:n.config,status:n.status,type:t.type,count:t.count},on:{find:n.findType}})})]:n._e()],2),n._v(" "),i("div",{staticClass:"ui divider"})]:n._e(),n._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!n.annotation,expression:"!annotation"}],ref:"list",staticClass:"list",style:n.computedListStyle,on:{scroll:function(t){return t.stopPropagation(),n.scrollList(t)}}},[n._l(n.annotations,function(t,e){return i("annotation-item",{key:t.id,attrs:{annotation:t,config:n.config,status:n.status,lib:n.lib,isFull:!1,findAnnotation:n.viewAnnotation,findUser:n.findUser,findType:n.findType,searchKeyword:n.panelData.keyword},on:{comment:n.viewAnnotationComment}})}),n._v(" "),n.noMore?i("div",{staticClass:"ui secondary segment no-more"},[0<n.annotations.length?[n._v("\r\n        "+n._s(n.$t("No More"))+"\r\n      ")]:[n._v("\r\n        "+n._s(n.$t("No Search Result"))+"\r\n      ")]],2):n._e()],2),n._v(" "),n.annotation?i("annotation-single",{ref:"AnnotationSingle",attrs:{config:n.config,status:n.status,lib:n.lib,panelData:n.panelData,annotation:n.annotation,heightPX:n.editorHeightPX},on:{update:n.onUpdate,delete:n.onDelete}}):n._e()],2)}function s(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ui stackable AnnotationSingle",class:t.computedGridClass,style:t.computedContainerStyle},[n("div",{staticClass:"column annotation-editor",style:t.computedEditorStyle},[n("annotation-editor-header",{attrs:{config:t.config,status:t.status,lib:t.lib,editable:t.isEditable,annotation:t.annotation}}),t._v(" "),n(t.type,{tag:"component",attrs:{config:t.config,status:t.status,lib:t.lib,hook:t.hook,panelData:t.panelData,annotation:t.annotation,heightPX:t.componentHeightPX},on:{add:t.onAdd,delete:t.onDelete,update:t.onUpdate}}),t._v(" "),t.isEditable?t._e():n("div",{staticClass:"ui one column grid annotation-panel-buttons"},[n("div",{class:t.computedButtonsClass},[n("span",{staticClass:"display-time"},[t._v("\r\n          "+t._s(t.displayTime)+"\r\n        ")]),t._v(" "),n("annotation-item-interactive",{attrs:{config:t.config,status:t.status,lib:t.lib,annotation:t.annotation},on:{like:t.onAnnotationLike,unlike:t.onAnnotationLike}})],1)])],1),t._v(" "),t.enableDiscussion?n("div",{staticClass:"column annotation-discussion"},[n("div",{staticClass:"ui divider"}),t._v(" "),n("annotation-discussion",{ref:"AnnotationDisscussion",attrs:{config:t.config,status:t.status,lib:t.lib,panelData:t.panelData,annotation:t.annotation,heightPX:t.discussionHeightPX,hook:t.hook}})],1):t._e()])}var r=n(4),c=n.n(r);s._withStripped=a._withStripped=!0;function l(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"AnnotationDiscussion"},[n("annotation-discussion-list",{ref:"AnnotationDiscussionList",attrs:{config:t.config,status:t.status,lib:t.lib,annotation:t.annotation,heightPX:t.listHeightPX,panelData:t.panelData,hook:t.hook},on:{comment:t.focusCommentInput,like:t.like,unlike:t.unlike}}),t._v(" "),n("annotation-discussion-input",{ref:"AnnotationDiscussionInput",attrs:{config:t.config,status:t.status,lib:t.lib,annotation:t.annotation},on:{add:t.onInputAdd,edit:t.onInputEdit,cancel:t.onInputCancel}})],1)}function u(){var i=this,t=i.$createElement,o=i._self._c||t;return o("div",{ref:"list",staticClass:"AnnotationDiscussionList",class:i.computedContainerClass,style:i.computedContainerStyle,on:{scroll:function(t){return t.stopPropagation(),i.scrollList(t)}}},[i.noMoreOlder?o("div",{staticClass:"ui secondary segment no-more",on:{click:i.focusInput}},[0<i.comments.length?[i._v("\r\n      "+i._s(i.$t("No More"))+"\r\n    ")]:[i._v("\r\n      "+i._s(i.$t("Write the first comment now"))+"\r\n    ")]],2):i._e(),i._v(" "),!i.noMoreOlder&&0<i.olderCommentCount?o("div",{staticClass:"ui secondary segment no-more"},[i._v("\r\n    "+i._s(i.$t("Load previous {0} comments...",[i.olderCommentCount]))+"\r\n  ")]):i._e(),i._v(" "),i._l(i.comments,function(e,n){return o("annotation-comment",{key:e.id,attrs:{config:i.config,status:i.status,lib:i.lib,comment:e},on:{comment:function(t){return i.$emit("comment",e)},like:function(t){return i.onCommentLike(e)},unlike:function(t){return i.onCommentLike(e)},edit:function(t){return i.onEdit(e)},delete:function(t){return i.onCommentDelete(n)}}})}),i._v(" "),!i.noMoreNewer&&0<i.newerCommentCount?o("div",{staticClass:"ui secondary segment no-more"},[i._v("\r\n    "+i._s(i.$t("Load next {0} comments...",[i.newerCommentCount]))+"\r\n  ")]):i._e()],2)}function h(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ui segment AnnotationComment",attrs:{"data-comment-id":e.comment.id}},[n("div",{staticClass:"meta text-container"},[n("span",{staticClass:"display-time"},[e._v("\r\n      "+e._s(e.displayTime)+"\r\n    ")]),e._v(" "),n("annotation-item-interactive",{attrs:{config:e.config,status:e.status,lib:e.lib,enableComment:!1,annotation:e.comment,size:"mini",showLabel:!1},on:{like:function(t){return e.$emit("like")},unlike:function(t){return e.$emit("unlike")},comment:function(t){return e.$emit("comment")}}}),e._v(" "),e.comment.user_id===e.status.userID?n("div",{staticClass:"control-buttons"},[n("button",{staticClass:"ui mini icon button",attrs:{type:"button"},on:{click:function(t){return e.$emit("edit")}}},[n("i",{staticClass:"edit icon"})]),e._v(" "),n("button",{staticClass:"ui mini icon button",attrs:{type:"button"},on:{click:e.onDelete}},[n("i",{staticClass:"trash alternate icon"})])]):e._e()],1),e._v(" "),n("div",{staticClass:"left column"},[n("div",{staticClass:"user"},[n("img",{staticClass:"avatar",attrs:{src:e.comment.user.avatar_url}}),e._v(" "),n("div",{staticClass:"username text-container"},[e._v("\r\n        "+e._s(e.username)+"\r\n      ")]),e._v(" "),n("div",{staticClass:"colon text-container"},[e._v("\r\n        :\r\n      ")])]),e._v(" "),e.note?n("div",{staticClass:"note text-container",domProps:{innerHTML:e._s(e.note)}}):e._e()])])}var d=n(0),f=n.n(d),p=n(1),g=n.n(p);h._withStripped=u._withStripped=l._withStripped=!0;var m,v={props:["lib","status","config","comment"],data:function(){return this.$i18n.locale=this.config.locale,{}},computed:{username:function(){var t=this.comment.user;return"string"==typeof t.displayName?t.displayName:t.username},displayTime:function(){return"number"!=typeof this.comment.updated_at_unixms&&(this.comment.updated_at_unixms=(new Date).getTime()),this.lib.DayJSHelper.fromNow(this.comment.updated_at_unixms)},note:function(){return this.comment.note}},methods:{onDelete:(m=g()(f.a.mark(function t(){var e;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.lib.ConfirmModal.show(this.$t("Are you sure to delete this comment?"));case 2:if(!1===t.sent)return t.abrupt("return",null);t.next=5;break;case 5:return e={id:this.comment.id},t.next=8,this.lib.AxiosHelper.get("/client/AnnotationComment/destroy",e);case 8:this.$emit("delete");case 9:case"end":return t.stop()}},t,this)})),function(){return m.apply(this,arguments)})}},b=(n(514),n(2)),y=n(516),C=Object(b.a)(v,h,[],!1,null,"7749c093",null);"function"==typeof y.default&&Object(y.default)(C),C.options.__file="webpack-app/client/Reading/components/annotation/AnnotationPanel/AnnotationSingle/AnnotationDiscussion/AnnotationDiscussionList/AnnotationComment/AnnotationComment.vue";var w,A,S,_,x,R,E,T,k=C.exports,D=n(3),N=n.n(D),P={props:["lib","status","config","panelData","heightPX","annotation","hook"],data:function(){this.$i18n.locale=this.config.locale;var t=!0;return this.panelData.focusCommentID&&(t=!1),{comments:[],olderCommentCount:0,newerCommentCount:0,noMoreOlder:!1,noMoreNewer:t,oldestCommnetTime:null,newestCommnetTime:null,loadLock:!1,list:null}},components:{"annotation-comment":k},computed:{computedContainerStyle:function(){return{height:this.heightPX+"px","max-height":this.heightPX+"px"}},computedContainerClass:function(){if(this.comments.length<10)return"little-comments"},AnnotationDiscussionInput:function(){return this.$parent.$refs.AnnotationDiscussionInput}},watch:{annotation:function(){this.initComments()}},mounted:function(){this.initComments()},methods:{initComments:(T=g()(f.a.mark(function t(){var e,n,i;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!0===this.loadLock)return t.abrupt("return",null);t.next=2;break;case 2:return this.loadLock=!0,e={annotationID:this.annotation.id},this.panelData.focusCommentID&&(e.commentID=this.panelData.focusCommentID),t.next=7,this.lib.AxiosHelper.get("/client/AnnotationComment/getCommentSummary",e);case 7:n=t.sent,this.comments=n.comments,"number"==typeof n.olderCommentCount&&(this.olderCommentCount=n.olderCommentCount,0===this.olderCommentCount?this.noMoreOlder=!0:this.oldestCommentTime=this.comments[0].created_at_unixms),"number"==typeof n.newerCommentCount&&(this.newerCommentCount=n.newerCommentCount,0===this.newerCommentCount?this.noMoreNewer=!0:(i=this.comments.length-1,this.newestCommentTime=this.comments[i].created_at_unixms)),!0!==this.noMoreOlder&&this.scrollToBottom(),this.loadLock=!1;case 13:case"end":return t.stop()}},t,this)})),function(){return T.apply(this,arguments)}),scrollToBottom:(E=g()(f.a.mark(function t(){var i=this;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:setTimeout(g()(f.a.mark(function t(){var e,n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:i.list||(i.list=N()(i.$refs.list)),i.panelData.focusCommentID?((e=i.list.children('.AnnotationComment[data-comment-id="'.concat(i.panelData.focusCommentID,'"]'))).transition("glow"),i.panelData.focusCommentID=null):e=i.list.children(".AnnotationComment:last"),n=e[0];case 3:if(i.list.scrollTop()+i.list.height()<n.offsetTop)return n.scrollIntoView({behavior:"smooth"}),t.next=7,i.lib.VueHelper.sleep(500);t.next=9;break;case 7:t.next=3;break;case 9:i.loadLock=!1;case 10:case"end":return t.stop()}},t)})),100);case 1:case"end":return t.stop()}},t)})),function(){return E.apply(this,arguments)}),loadOlder:(R=g()(f.a.mark(function t(){var e,n,i,o=this;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!0===this.loadLock)return t.abrupt("return",null);t.next=2;break;case 2:return this.loadLock=!0,this.list||(this.list=N()(this.$refs.list)),e=this.list.children(".AnnotationComment:first"),n={annotationID:this.annotation.id,beforeTime:this.oldestCommentTime},t.next=8,this.lib.AxiosHelper.get("/client/AnnotationComment/next",n);case 8:if(i=t.sent,!1===Array.isArray(i)||0===i.length)return this.noMoreOlder=!0,this.loadLock=!1,t.abrupt("return",null);t.next=13;break;case 13:this.comments=i.concat(this.comments),this.olderCommentCount=this.olderCommentCount-i.length,this.oldestCommentTime=i[0].created_at_unixms,setTimeout(function(){e[0].scrollIntoView(),setTimeout(function(){o.loadLock=!1},100)},100);case 17:case"end":return t.stop()}},t,this)})),function(){return R.apply(this,arguments)}),loadNewer:(x=g()(f.a.mark(function t(){var e,n,i,o,a=this;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!0===this.loadLock)return t.abrupt("return",null);t.next=2;break;case 2:return this.loadLock=!0,this.list||(this.list=N()(this.$refs.list)),e=this.list.children(".AnnotationComment:last"),n={annotationID:this.annotation.id,afterTime:this.newestCommentTime},t.next=8,this.lib.AxiosHelper.get("/client/AnnotationComment/next",n);case 8:if(i=t.sent,!1===Array.isArray(i)||0===i.length)return this.noMoreNewer=!0,this.loadLock=!1,t.abrupt("return",null);t.next=13;break;case 13:i.reverse(),this.comments=this.comments.concat(i),this.newerCommentCount=this.newerCommentCount-i.length,o=i.length-1,this.newestCommentTime=i[o].created_at_unixms,setTimeout(function(){e[0].scrollIntoView(),setTimeout(function(){a.loadLock=!1},100)},100);case 19:case"end":return t.stop()}},t,this)})),function(){return x.apply(this,arguments)}),autoLoadNextPage:(_=g()(f.a.mark(function t(){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("autoLoadNextPage");case 1:case"end":return t.stop()}},t)})),function(){return _.apply(this,arguments)}),scrollList:function(t){if(!0===this.loadLock)return t.preventDefault(),t.stopPropagation(),null;if(!0===this.noMoreOlder&&!0===this.noMoreNewer)return!1;var e=t.target;if(0===e.scrollTop){if(!0===this.noMoreOlder)return!1;this.loadOlder()}else if(e.scrollHeight-e.scrollTop===e.clientHeight){if(!0===this.noMoreNewer)return!1;this.loadNewer()}},onCommentDelete:function(t){this.comments.splice(t,1),this.annotation.__meta__.comments_count--,this.annotation.__meta__.i_have_commented_count--},onInputAdd:(S=g()(f.a.mark(function t(e){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!1===this.noMoreNewer)return t.next=3,this.reload(e.id);t.next=5;break;case 3:return this.annotation.__meta__.comments_count++,t.abrupt("return",void 0);case 5:this.comments.push(e),this.noMoreOlder=!1,this.scrollToBottom(),this.annotation.__meta__.comments_count++;case 9:case"end":return t.stop()}},t,this)})),function(t){return S.apply(this,arguments)}),onInputEdit:function(e){var n=this;setTimeout(function(){n.list||(n.list=N()(n.$refs.list));var t=n.list.find('[data-comment-id="'.concat(e.id,'"]'));t[0].scrollIntoView({behavior:"smooth"}),t.transition("glow"),setTimeout(function(){n.loadLock=!1},500)},100)},onEdit:function(t){this.AnnotationDiscussionInput.comment=t},focusInput:function(){this.AnnotationDiscussionInput.focus()},onCommentLike:(A=g()(f.a.mark(function t(e){var n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={commentID:e.id},t.next=3,this.lib.AxiosHelper.get("/client/AnnotationRate/likeComment",n);case 3:"function"==typeof this.hook.commentLike&&this.hook.commentLike(e);case 4:case"end":return t.stop()}},t,this)})),function(t){return A.apply(this,arguments)}),reload:(w=g()(f.a.mark(function t(e){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.panelData.focusCommentID=e||null,this.loadLock=!1,this.comments=[],this.noMoreOlder=!1,this.noMoreNewer=!0,this.oldestCommnetTime=null,this.newestCommnetTime=null,t.next=9,this.initComments();case 9:case"end":return t.stop()}},t,this)})),function(t){return w.apply(this,arguments)})}},I=(n(517),n(519)),M=Object(b.a)(P,u,[],!1,null,"e134047a",null);"function"==typeof I.default&&Object(I.default)(M),M.options.__file="webpack-app/client/Reading/components/annotation/AnnotationPanel/AnnotationSingle/AnnotationDiscussion/AnnotationDiscussionList/AnnotationDiscussionList.vue";function O(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"AnnotationDiscussionInput ui form"},[n("div",{staticClass:"right-column"},[e.isEditMode?[n("span",[n("button",{staticClass:"ui mini icon button",class:{disabled:!e.isEnableSubmit},attrs:{type:"button"},on:{click:e.submit}},[n("i",{staticClass:"edit icon"})])]),e._v(" "),n("span",[n("button",{staticClass:"ui icon mini button",attrs:{type:"button"},on:{click:e.reset}},[n("i",{staticClass:"close icon"})])])]:[n("button",{staticClass:"ui mini icon button",class:{disabled:!e.isEnableSubmit},attrs:{type:"button"},on:{click:e.submit}},[n("i",{staticClass:"edit icon"})])]],2),e._v(" "),n("div",{staticClass:"center-column ui input field input-field"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.note,expression:"note"}],ref:"input",attrs:{type:"text"},domProps:{value:e.note},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)},input:function(t){t.target.composing||(e.note=t.target.value)}}})])])}var H=M.exports;O._withStripped=!0;var L,$,B={props:["lib","status","config","annotation"],data:function(){this.$i18n.locale=this.config.locale;var t="";return this.comment&&"string"==typeof this.comment.note&&(t=this.comment.note),{note:t,comment:null,submitLock:!1}},computed:{isEditMode:function(){return this.comment&&"number"==typeof this.comment.id},AnnotationDiscussionList:function(){return this.$parent.$refs.AnnotationDiscussionList},username:function(){return"string"==typeof this.status.displayName?this.status.displayName:this.status.username},isEnableSubmit:function(){return!1===this.submitLock&&""!==this.note.trim()}},watch:{comment:function(t){t&&"string"==typeof t.note?this.note=t.note:this.note=""}},methods:{focus:function(){var t=this.$refs.input;t.focus(),N()(t).transition("glow")},submit:function(){return!1===this.isEnableSubmit?null:!0===this.submitLock?null:(this.submitLock=!0,void(this.isEditMode?this.edit():this.create()))},create:($=g()(f.a.mark(function t(){var e,n,i;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={annotationID:this.annotation.id,note:this.note},t.next=4,this.lib.AxiosHelper.post("/client/AnnotationComment/create",e);case 4:if("number"!=typeof(n=t.sent).id)throw new Error("Add failed");t.next=8;break;case 8:t.next=11;break;case 10:n={id:(new Date).getTime()};case 11:i={id:n.id,note:this.note,user_id:this.status.userID,user:{username:this.status.username,display_name:this.status.displayName,avatar_url:this.status.avatar}},this.AnnotationDiscussionList.onInputAdd(i),this.reset();case 14:case"end":return t.stop()}},t,this)})),function(){return $.apply(this,arguments)}),edit:(L=g()(f.a.mark(function t(){var e;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={commentID:this.comment.id,note:this.note},t.next=3,this.lib.AxiosHelper.post("/client/AnnotationComment/update",e);case 3:if("number"!=typeof t.sent.id)throw new Error("Add failed");t.next=7;break;case 7:this.comment.note=this.note,this.AnnotationDiscussionList.onInputEdit(this.comment),this.reset();case 10:case"end":return t.stop()}},t,this)})),function(){return L.apply(this,arguments)}),reset:function(){this.note="",this.comment=null,this.submitLock=!1}}},W=(n(520),n(522)),F=Object(b.a)(B,O,[],!1,null,"55f1394b",null);"function"==typeof W.default&&Object(W.default)(F),F.options.__file="webpack-app/client/Reading/components/annotation/AnnotationPanel/AnnotationSingle/AnnotationDiscussion/AnnotationDiscussionInput/AnnotationDiscussionInput.vue";var q={props:["lib","status","config","panelData","annotation","heightPX","hook"],data:function(){return this.$i18n.locale=this.config.locale,{comment:null}},components:{"annotation-discussion-list":H,"annotation-discussion-input":F.exports},computed:{listHeightPX:function(){return this.heightPX-100}},methods:{focusCommentInput:function(){this.$refs.AnnotationDiscussionInput.focus()},onInputAdd:function(){throw new Error("@TODO AnnotationDiscussion.onInputAdd()")},onInputEdit:function(){throw new Error("@TODO AnnotationDiscussion.onInputEdit()")},onInputCancel:function(){throw new Error("@TODO AnnotationDiscussion.onInputCancel()")},like:function(){throw new Error("@TODO AnnotationDiscussion.like()")},unlike:function(){throw new Error("@TODO AnnotationDiscussion.unlike()")}}},j=(n(523),n(525)),U=Object(b.a)(q,l,[],!1,null,"bc70deda",null);"function"==typeof j.default&&Object(j.default)(U),U.options.__file="webpack-app/client/Reading/components/annotation/AnnotationPanel/AnnotationSingle/AnnotationDiscussion/AnnotationDiscussion.vue";function z(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"AnnotationEditorHeader",class:t.computedContainerClassList},[t.editable?n("div",{staticClass:"right column"},[n("annotaion-instruction",{ref:"AnnotationInstruction",attrs:{config:t.config,status:t.status,lib:t.lib,type:t.annotation.type,editable:t.editable}})],1):t._e(),t._v(" "),n("div",{staticClass:"left column"},[n("user-information",{attrs:{annotation:t.annotation,config:t.config,status:t.status},on:{showInstruction:function(){t.$refs.AnnotationInstruction.showInstruction()}}})],1)])}function X(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"UserInformation"},[n("img",{staticClass:"user-avatar",attrs:{src:t.avatar}}),t._v(" "),n("div",{staticClass:"username"},[t._v("\r\n    "+t._s(t.username)+"\r\n  ")]),t._v(" "),n("annotation-type-button",{attrs:{status:t.status,type:t.annotation.type},on:{find:function(){t.$emit("showInstruction")}}})],1)}var Q=U.exports;X._withStripped=z._withStripped=!0;var V={props:["config","status","annotation"],data:function(){return{}},computed:{username:function(){var t=this.status;return"object"===c()(this.annotation.user)&&(t=this.annotation.user),"string"==typeof t.displayName?t.displayName:t.username},type:function(){return this.annotation.type},avatar:function(){return"object"===c()(this.annotation.user)?this.annotation.user.avatar_url:this.status.avatar}}},G=(n(526),n(528)),Y=Object(b.a)(V,X,[],!1,null,"0a95f64e",null);"function"==typeof G.default&&Object(G.default)(Y),Y.options.__file="webpack-app/client/Reading/components/annotation/AnnotationPanel/AnnotationSingle/AnnotationEditorHeader/UserInformation/UserInformation.vue";function K(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ui segment AnnotaionInstruction"},[n("div",{staticClass:"show-instruction"},[n("button",{staticClass:"ui mini button",attrs:{type:"button"},on:{click:t.showInstruction}},[t._v("\r\n      "+t._s(t.$t("Hint"))+"\r\n    ")])]),t._v(" "),n("div",{staticClass:"summary"},[t._v("\r\n    "+t._s(t.instruction.summary)+"\r\n  ")]),t._v(" "),n("modal",{ref:"Modal",attrs:{config:t.config,status:t.status,lib:t.lib,contentURL:t.instruction.url,cancelButtonText:"CLOSE",cancelable:"true"},scopedSlots:t._u([{key:"header",fn:function(){return[n("annotation-type-button",{style:{float:"left","margin-right":"1em"},attrs:{status:t.status,type:t.type}}),t._v("\r\n        \r\n        "+t._s(t.instruction.summary)+"\r\n      ")]},proxy:!0}])})],1)}var J=Y.exports;K._withStripped=!0;var Z={props:["config","status","type","lib"],data:function(){return this.$i18n.locale=this.config.locale,{}},computed:{instruction:function(){return this.status.readingConfig.annotationTypeModules[this.type].instruction}},methods:{showInstruction:function(){this.$refs.Modal.show()}}},tt=(n(529),n(531)),et=Object(b.a)(Z,K,[],!1,null,"a3af9796",null);"function"==typeof tt.default&&Object(tt.default)(et),et.options.__file="webpack-app/client/Reading/components/annotation/AnnotationPanel/AnnotationSingle/AnnotationEditorHeader/AnnotaionInstruction/AnnotaionInstruction.vue";var nt={props:["status","config","lib","editable","annotation"],data:function(){return this.$i18n.locale=this.config.locale,{}},components:{"user-information":J,"annotaion-instruction":et.exports},computed:{computedContainerClassList:function(){return this.editable?"edit-mode":"display-mode"}}},it=(n(532),Object(b.a)(nt,z,[],!1,null,"e6bd675a",null));it.options.__file="webpack-app/client/Reading/components/annotation/AnnotationPanel/AnnotationSingle/AnnotationEditorHeader/AnnotationEditorHeader.vue";function ot(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ui form"},[n("HTMLEditor",{ref:"editor",attrs:{lib:t.lib,config:t.config,contents:t.note,editable:t.isEditable,height:t.editorHeight,placeholder:t.editorPlaceholder},on:{input:t.onNoteChange}}),t._v(" "),n("footer-buttons",{attrs:{lib:t.lib,config:t.config,status:t.status,annotation:t.annotation,panelData:t.panelData}})],1)}function at(){var e=this,t=e.$createElement,n=e._self._c||t;return e.$parent.isEditable?n("div",{staticClass:"ui one column grid annotation-panel-buttons"},[e.$parent.isNoteDifferent?n("block-exit"):e._e(),e._v(" "),n("div",{class:e.$parent.computedButtonsClass},[n("admin-badge",{attrs:{status:e.status,config:e.config}}),e._v(" "),n("span",{staticClass:"display-time"},[e._v("\r\n        "+e._s(e.$parent.displayTime)+"\r\n      ")]),e._v(" "),e.panelData.enableDiscussion?n("annotation-item-interactive",{attrs:{config:e.config,status:e.status,lib:e.lib,annotation:e.annotation},on:{comment:e.onComment}}):e._e(),e._v(" "),e.lib.auth.isEnableControlPermission?n("checkbox-toggle",{attrs:{label:e.$t("PUBLIC"),enable:!e.$parent.awaitSubmit},model:{value:e.public,callback:function(t){e.public=t},expression:"public"}}):e._e(),e._v(" "),e.annotation.id?[e.$parent.enableDelete?n("button",{staticClass:"ui compact button delete-button",class:e.$parent.computedSubmitButtonClassList,attrs:{type:"button"},on:{click:e.$parent.deleteAnnotation}},[e._v("\r\n          "+e._s(e.$t("DELETE"))+"  \r\n        ")]):e._e(),e._v(" "),n("validation-button",{class:e.$parent.computedSubmitButtonClassList,style:e.$parent.computedSubmitButtonStyle,attrs:{lib:e.lib,text:e.$parent.note,minWordCount:e.$parent.minWords,locale:e.status.preference.locale,enable:e.$parent.isEnableSubmitEdit},on:{click:e.$parent.editAnnotation}},[e._v("\r\n          "+e._s(e.$t("UPDATE"))+"  \r\n        ")])]:[n("validation-button",{staticClass:"add-button",class:e.$parent.computedSubmitButtonClassList,style:e.$parent.computedSubmitButtonStyle,attrs:{lib:e.lib,minWordCount:e.$parent.minWords,text:e.$parent.note,locale:e.status.preference.locale,enable:e.$parent.isEnableSubmitAdd},on:{click:e.$parent.addAnnotation}},[e._v("\r\n          "+e._s(e.$t("ADD"))+"  \r\n        ")])]],2)],1):e._e()}var st=it.exports;at._withStripped=ot._withStripped=!0;var rt={props:["lib","status","config","annotation","panelData"],data:function(){return this.$i18n.locale=this.config.locale,{public:"public"===this.lib.auth.defaultPermission}},methods:{onComment:function(){this.lib.AnnotationPanel.focusCommentInput()}}},ct=(n(534),n(536)),lt=Object(b.a)(rt,at,[],!1,null,"e454a39e",null);"function"==typeof ct.default&&Object(ct.default)(lt),lt.options.__file="webpack-app/client/Reading/components/annotation/AnnotationTypeModules/MainIdea/FooterButtons/FooterButtons.vue";function ut(t){t.computed.annotationConfig=function(){return this.lib.auth.stepHighlightAnnotationConfig},t.computed.annotationModuleConfig=function(){if(this.annotation){var t=this.annotation.type;return this.status.readingConfig.annotationTypeModules[t]}},t.computed.minWords=function(){return this.annotationModuleConfig.minWords},t.computed.isEditable=function(){return this.lib.AnnotationHelper.isEditable(this.annotation)},t.computed.type=function(){return this.annotation.type},t.computed.displayTime=function(){return this.lib.DayJSHelper.fromNow(this.annotation.updated_at_unixms)}}function ht(t){t.computed.computedButtonsClass=function(){return!1===this.lib.style.isLeftHanded?"right aligned column":"column"},t.computed.computedSubmitButtonClassList=function(){if(!0===this.awaitSubmit)return"disabled"},t.computed.computedSubmitButtonStyle=function(){var t=this.annotation.type,e=this.status.readingConfig.annotationTypeModules[t].style.button;return{color:e.color,"background-color":e.backgroundColor}}}function dt(t){t.methods.deleteAnnotation=function(){this.panelData.isAnnotationEditing=!1,this.setWaitSubmit(),this.$emit("delete")},t.methods.setWaitSubmit=function(){var t=this;this.awaitSubmit=!0,setTimeout(function(){t.awaitSubmit=!1},3e3)}}var ft=lt.exports,pt=["lib","status","config","panelData","annotation","heightPX","hook"];var gt,mt,vt,bt={props:pt,data:function(){if(!this.annotation)throw"No annotation";this.$i18n.locale=this.config.locale;var t="";this.annotation&&Array.isArray(this.annotation.notes)&&0<this.annotation.notes.length&&(t=this.annotation.notes[0].note);var e=t;return{note:t,noteReset:e=e&&this.lib.StringHelper.htmlToTextTrim(e,!0)}},components:{"footer-buttons":ft},computed:{isNoteDifferent:function(){var t=this.lib.StringHelper.htmlToTextTrim(this.note,!0).trim()!==this.noteReset;return this.panelData.isAnnotationEditing=t},isEnableSubmitAdd:function(){return!0===this.isNoteDifferent&&"string"==typeof this.note&&""!==this.note},isEnableSubmitEdit:function(){return this.isEnableSubmitAdd},editorHeight:function(){if(this.heightPX<200)return"10em";return!0===this.lib.auth.isEnableCollaboration?(this.lib.style.clientHeight/2,this.lib.style.isStackWidth?"calc(".concat(this.heightPX,"px - ").concat("5em"," - 5em)"):"calc(".concat(this.heightPX,"px - ").concat("5em",")")):"calc(".concat(this.heightPX,"px - ").concat("5em",")")},editorPlaceholder:function(){return this.$t(this.annotationModuleConfig.placeholder)},enableDelete:function(){return!0}},watch:{annotation:function(t){t&&Array.isArray(t.notes)&&0<t.notes.length&&(this.note=t.notes[0].note,this.noteReset=this.lib.StringHelper.htmlToTextTrim(this.note,!0),this.$refs.editor.html(this.note))}},mounted:function(){this.loadDraft()},methods:{loadDraft:(vt=g()(f.a.mark(function t(){var e;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==this.note)return t.abrupt("return",!1);t.next=2;break;case 2:t.prev=2,e=this.lib.RangyManager.getPinSelectionAnchorText(),t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(2),console.error(t.t0),this.lib.AnnotationPanel.hide(),t.abrupt("return",!1);case 11:e=this.lib.StringHelper.removePunctuations(e).trim(),e="<p>".concat(e,"</p>"),this.note=e,this.noteReset=this.lib.StringHelper.htmlToTextTrim(e,!0),this.$refs.editor&&this.$refs.editor.html(this.note);case 16:case"end":return t.stop()}},t,this,[[2,6]])})),function(){return vt.apply(this,arguments)}),addAnnotation:(mt=g()(f.a.mark(function t(){var e,n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.setWaitSubmit(),this.lib.AnnotationHelper.validate(this.annotation),e={anchorPositions:this.annotation.anchorPositions,type:this.annotation.type,notes:{default:this.note}},!0===this.lib.auth.isEnableControlPermission&&(e.public=this.public),n=1,t.next=8,this.lib.AxiosHelper.post("/client/AnnotationSave/create",e);case 8:n=t.sent,t.next=12;break;case 11:console.log(e);case 12:if(this.panelData.isAnnotationEditing=!1,"number"!=typeof n)throw"Create failed";t.next=16;break;case 16:if(this.annotation.id=n,this.lib.AnnotationHelper.note(this.annotation,"default",this.note),this.lib.RangyManager){t.next=20;break}return t.abrupt("return");case 20:this.lib.RangyManager.highlightPinnedSelectionFromAnnotation(this.annotation),this.$refs.editor&&this.$refs.editor.reset(),this.$emit("add");case 23:case"end":return t.stop()}},t,this)})),function(){return mt.apply(this,arguments)}),editAnnotation:(gt=g()(f.a.mark(function t(){var e,n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.setWaitSubmit(),e={id:this.annotation.id,notes:{default:this.note}},n=0,t.next=6,this.lib.AxiosHelper.post("/client/AnnotationSave/update",e);case 6:n=t.sent;case 7:if(this.panelData.isAnnotationEditing=!1,1!==n)throw this.$t("Update failed.");t.next=10;break;case 10:this.annotation.notes[0].note=this.note,this.$emit("update");case 12:case"end":return t.stop()}},t,this)})),function(){return gt.apply(this,arguments)}),onNoteChange:function(t){this.note=t}}};ut(bt),ht(bt),dt(bt);var yt=bt,Ct=(n(537),n(539),n(541)),wt=Object(b.a)(yt,ot,[],!1,null,"7a079aa8",null);"function"==typeof Ct.default&&Object(Ct.default)(wt),wt.options.__file="webpack-app/client/Reading/components/annotation/AnnotationTypeModules/MainIdea/MainIdea.vue";function At(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ui form"},[e.isQuestionSubmitted?e._e():n("question-template",{ref:"QuestionTemplate",attrs:{config:e.config,status:e.status,lib:e.lib},on:{selectQuestion:e.selectQuestion}}),e._v(" "),n("HTMLEditor",{ref:"QuestionEditor",staticClass:"QuestionEditor",attrs:{lib:e.lib,config:e.config,contents:e.question,label:e.$t("Question"),editable:e.isEditable,height:e.computedQuestionEditorHeight,placeholder:e.questionPlaceholder},on:{input:e.onQuestionChange}}),e._v(" "),n("resource-search",{directives:[{name:"show",rawName:"v-show",value:e.isQuestionSubmitted,expression:"isQuestionSubmitted"}],ref:"ResourceSearch",attrs:{config:e.config,status:e.status,lib:e.lib,propSelectIndex:e.recommandResourceSearchIndex,propAnchorText:e.anchorText,propQuestion:e.question}}),e._v(" "),n("HTMLEditor",{directives:[{name:"show",rawName:"v-show",value:e.isQuestionSubmitted,expression:"isQuestionSubmitted"}],ref:"AnswerEditor",staticClass:"AnswerEditor",attrs:{lib:e.lib,config:e.config,contents:e.answer,label:e.$t("Answer"),editable:e.isEditable,height:e.computedAnswerEditorHeight,placeholder:e.answerPlaceholder},on:{input:e.onAnswerChange}}),e._v(" "),n("footer-buttons",{attrs:{config:e.config,status:e.status,lib:e.lib,annotation:e.annotation,panelData:e.panelData},on:{update:function(t){return e.$emit("update")}}})],1)}function St(){var n=this,t=n.$createElement,i=n._self._c||t;return i("div",{staticClass:"QuestionTemplate ui form"},[i("div",{staticClass:"unstackable fields"},[i("div",{staticClass:"three wide field label",on:{click:function(){n.$refs.select.focus()}}},[i("label",[n._v("\r\n        "+n._s(n.$t("Write your question"))+":\r\n      ")])]),n._v(" "),i("div",{staticClass:"thirteen wide select field"},[i("select",{directives:[{name:"model",rawName:"v-model",value:n.selectIndex,expression:"selectIndex"}],ref:"select",staticClass:"ui small fluid input select-question",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});n.selectIndex=t.target.multiple?e:e[0]}}},n._l(n.questions,function(t,e){return i("option",{domProps:{value:e}},[n._v("\r\n          "+n._s(n.$t(t.hint))+"\r\n        ")])}),0)])])])}var _t=wt.exports;St._withStripped=At._withStripped=!0;var xt={props:["lib","status","config"],data:function(){return this.$i18n.locale=this.config.locale,{selectIndex:0}},computed:{questions:function(){return this.status.readingConfig.annotationTypeModules.ConfusedClarified.questionTemplates}},watch:{selectIndex:function(){this.onSelect()}},mounted:function(){this.onSelect()},methods:{onSelect:function(){var t=this.questions[this.selectIndex];this.$emit("selectQuestion",t)},getDefaultQuestion:function(){return"AAA"}}},Rt=(n(542),n(544)),Et=Object(b.a)(xt,St,[],!1,null,"bdafffe6",null);"function"==typeof Rt.default&&Object(Rt.default)(Et),Et.options.__file="webpack-app/client/Reading/components/annotation/AnnotationTypeModules/ConfusedClarified/QuestionTemplate/QuestionTemplate.vue";function Tt(){var n=this,t=n.$createElement,i=n._self._c||t;return i("div",{staticClass:"ResourceSearch unstackable fields"},[i("div",{staticClass:"four wide inline label field"},[i("label",{on:{click:n.focus}},[n._v("\r\n      "+n._s(n.$t("Find your answer"))+":\r\n    ")])]),n._v(" "),i("div",{staticClass:"eight wide field"},[i("select",{directives:[{name:"model",rawName:"v-model",value:n.selectIndex,expression:"selectIndex"}],ref:"input",staticClass:"ui small fluid input select-question",on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});n.selectIndex=t.target.multiple?e:e[0]}}},n._l(n.resources,function(t,e){return i("option",{domProps:{value:e}},[n._v("\r\n        "+n._s(n.$t(t.name))+"\r\n      ")])}),0)]),n._v(" "),i("div",{staticClass:"four wide column field"},[i("button",{staticClass:"ui small fluid button search-button",class:n.computedButtonClass,attrs:{type:"button"},on:{click:n.doSearch}},[n._v("\r\n      "+n._s(n.$t("SEARCH"))+"\r\n    ")])])])}var kt=Et.exports;Tt._withStripped=!0;var Dt={props:["lib","status","config","propSelectIndex","propAnchorText","propQuestion"],data:function(){return this.$i18n.locale=this.config.locale,{selectIndex:this.propSelectIndex,anchorText:this.propAnchorText,question:""}},computed:{resources:function(){return this.status.readingConfig.annotationTypeModules.ConfusedClarified.externalResourceSearches},computedButtonClass:function(){if(""===this.anchorText)return"disabled";var t=this.selectIndex;return null==t?"disabled":(!1===isNaN(t)&&"string"==typeof t&&(t=parseInt(t,10)),-1<t&&t<this.resources.length?void 0:"disabled")},selectIndexInteger:function(){var t=this.selectIndex;return null==t?null:(!1===isNaN(t)&&"string"==typeof t&&(t=parseInt(t,10)),-1<t&&t<this.resources.length?t:null)},urlPattern:function(){return null===this.selectIndexInteger?null:this.resources[this.selectIndexInteger].urlPattern}},watch:{propSelectIndex:function(t){this.selectIndex=t},propAnchorText:function(t){this.anchorText=t}},methods:{doSearch:function(){if(null===this.urlPattern)return!1;this.question=this.lib.StringHelper.htmlToText(this.propQuestion);var t=this.urlPattern.replace("{anchorText}",this.anchorText);t=t.replace("{question}",this.question);this._popupCenter(t,"_blank",.8*screen.availWidth,.8*screen.availHeight)},_popupCenter:function(t,e,n,i){function o(){return/\b(iPhone|iP[ao]d)/.test(a)||/\b(iP[ao]d)/.test(a)||/Android/i.test(a)||/Mobile/i.test(a)}var a=navigator.userAgent,s=void 0!==window.screenX?window.screenX:window.screenLeft,r=void 0!==window.screenY?window.screenY:window.screenTop,c=void 0!==window.outerWidth?window.outerWidth:document.documentElement.clientWidth,l=void 0!==window.outerHeight?window.outerHeight:document.documentElement.clientHeight-22,u=o()?null:n,h=o()?null:i,d=s<0?window.screen.width+s:s,f=parseInt(d+(c-u)/2,10),p=parseInt(r+(l-h)/2.5,10),g=[];null!==u&&g.push("width="+u),null!==h&&g.push("height="+h),g.push("left="+f),g.push("top="+p),g.push("scrollbars=1");var m=window.open(t,e,g.join(","));window.focus&&m.focus()},focus:function(){this.$refs.input.focus()}}},Nt=(n(545),n(547)),Pt=Object(b.a)(Dt,Tt,[],!1,null,"c94b37e6",null);"function"==typeof Nt.default&&Object(Nt.default)(Pt),Pt.options.__file="webpack-app/client/Reading/components/annotation/AnnotationTypeModules/ConfusedClarified/ResourceSearch/ResourceSearch.vue";function It(){var e=this,t=e.$createElement,n=e._self._c||t;return e.$parent.isEditable?n("div",{staticClass:"ui one column grid annotation-panel-buttons"},[e.$parent.isNoteEdited?n("block-exit"):e._e(),e._v(" "),e.panelData.enableDiscussion?n("div",{class:e.$parent.computedButtonsClass},[n("div",{staticClass:"buttons-row"},[n("admin-badge",{attrs:{status:e.status,config:e.config}}),e._v(" "),e.lib.auth.isEnableControlPermission?n("checkbox-toggle",{attrs:{label:e.$t("PUBLIC"),enable:!e.$parent.awaitSubmit},model:{value:e.public,callback:function(t){e.public=t},expression:"public"}}):e._e(),e._v(" "),e.$parent.annotation.id?[e.$parent.isQuestionSubmitted&&!e.$parent.isAnswerSubmitted?n("button",{staticClass:"ui compact button",class:e.$parent.computedSubmitButtonClassList,attrs:{type:"button"},on:{click:e.writeLater}},[e._v("\r\n          "+e._s(e.$t("WRITE LATER"))+"  \r\n        ")]):e._e(),e._v(" "),n("validation-button",{class:e.$parent.computedSubmitButtonClassList,style:e.computedSubmitAnswerStyle,attrs:{lib:e.lib,text:e.$parent.answer,minWordCount:e.$parent.answerMinWords,locale:e.status.preference.locale,enable:e.$parent.isEnableSubmitAnswer},on:{click:e.submitAnswer}},[e._v("\r\n          "+e._s(e.$t("SAVE ANSWER"))+"  \r\n        ")])]:[n("validation-button",{class:e.$parent.computedSubmitButtonClassList,style:e.computedSubmitQuestionStyle,attrs:{lib:e.lib,text:e.$parent.question,minWordCount:e.$parent.questionMinWords,locale:e.status.preference.locale,enable:e.$parent.isEnableSubmitQuestion},on:{click:e.submitQuestion}},[e._v("\r\n          "+e._s(e.$t("SAVE QUESTION"))+"  \r\n        ")])]],2),e._v(" "),e.$parent.annotation.id?n("div",{staticClass:"buttons-row second"},[e.$parent.annotation.id?n("span",{staticClass:"display-time"},[e._v("\r\n        "+e._s(e.$parent.displayTime)+"\r\n      ")]):e._e(),e._v(" "),e.annotation.id?n("button",{staticClass:"ui compact button delete-button",class:e.$parent.computedSubmitButtonClassList,attrs:{type:"button"},on:{click:e.$parent.deleteAnnotation}},[e._v("\r\n        "+e._s(e.$t("DELETE"))+"  \r\n      ")]):e._e(),e._v(" "),n("annotation-item-interactive",{attrs:{config:e.config,status:e.status,lib:e.lib,annotation:e.annotation},on:{comment:e.onComment}})],1):e._e()]):e._e(),e._v(" "),e.panelData.enableDiscussion?e._e():n("div",{class:e.$parent.computedButtonsClass},[n("div",{staticClass:"buttons-row"},[n("admin-badge",{attrs:{status:e.status,config:e.config}}),e._v(" "),e.lib.auth.isEnableControlPermission?n("checkbox-toggle",{attrs:{label:e.$t("PUBLIC"),enable:!e.$parent.awaitSubmit},model:{value:e.public,callback:function(t){e.public=t},expression:"public"}}):e._e(),e._v(" "),e.$parent.annotation.id?[e.$parent.annotation.id?n("button",{staticClass:"ui compact button delete-button",class:e.$parent.computedSubmitButtonClassList,attrs:{type:"button"},on:{click:e.$parent.deleteAnnotation}},[e._v("\r\n          "+e._s(e.$t("DELETE"))+"  \r\n        ")]):e._e(),e._v(" "),e.$parent.isQuestionSubmitted&&!e.$parent.isAnswerSubmitted?n("button",{staticClass:"ui compact button",class:e.$parent.computedSubmitButtonClassList,attrs:{type:"button"},on:{click:e.writeLater}},[e._v("\r\n          "+e._s(e.$t("WRITE LATER"))+"  \r\n        ")]):e._e(),e._v(" "),n("validation-button",{class:e.$parent.computedSubmitButtonClassList,style:e.computedSubmitAnswerStyle,attrs:{lib:e.lib,text:e.$parent.answer,minWordCount:e.$parent.answerMinWords,locale:e.status.preference.locale,enable:e.$parent.isEnableSubmitAnswer},on:{click:e.submitAnswer}},[e._v("\r\n          "+e._s(e.$t("SAVE ANSWER"))+"  \r\n        ")])]:[n("validation-button",{class:e.$parent.computedSubmitButtonClassList,style:e.computedSubmitQuestionStyle,attrs:{lib:e.lib,text:e.$parent.question,minWordCount:e.$parent.questionMinWords,locale:e.status.preference.locale,enable:e.$parent.isEnableSubmitQuestion},on:{click:e.submitQuestion}},[e._v("\r\n          "+e._s(e.$t("SAVE QUESTION"))+"  \r\n        ")])]],2)])],1):e._e()}var Mt=Pt.exports;It._withStripped=!0;var Ot,Ht,Lt,$t={props:["config","status","lib","annotation","panelData"],data:function(){return this.$i18n.locale=this.config.locale,{public:"public"===this.lib.auth.defaultPermission,questionMinWords:this.status.readingConfig.annotationTypeModules.ConfusedClarified.questionMinWords,answerMinWords:this.status.readingConfig.annotationTypeModules.ConfusedClarified.answerMinWords}},computed:{computedSubmitQuestionStyle:function(){var t=this.status.readingConfig.annotationTypeModules.Confused.style.button;return{color:t.color,"background-color":t.backgroundColor}},computedSubmitAnswerStyle:function(){var t=this.status.readingConfig.annotationTypeModules.Clarified.style.button;return{color:t.color,"background-color":t.backgroundColor}}},methods:{submitQuestion:(Lt=g()(f.a.mark(function t(){var e,n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$parent.setWaitSubmit(),this.annotation.properties={question_submitted_at:(new Date).getTime()},this.lib.AnnotationHelper.note(this.annotation,"question",this.$parent.question),this.lib.AnnotationHelper.validate(this.annotation),e={anchorPositions:this.annotation.anchorPositions,type:this.annotation.type,notes:{question:this.$parent.question},properties:this.annotation.properties},!0===this.lib.auth.isEnableControlPermission&&(e.public=this.public),t.next=8,this.lib.AxiosHelper.post("/client/AnnotationSave/create",e);case 8:if(n=t.sent,this.panelData.isAnnotationEditing=!1,"number"!=typeof n)throw"Create failed";t.next=13;break;case 13:this.annotation.id=n,this.lib.AnnotationHelper.note(this.annotation,"question",this.$parent.question),this.lib.RangyManager.unpinSelection(),this.lib.RangyManager.highlightPinnedSelectionFromAnnotation(this.annotation),this.$parent.isQuestionSubmitted=!0,this.lib.RangyManager.hoverIn(this.annotation),this.$parent.awaitSubmit=!1;case 20:case"end":return t.stop()}},t,this)})),function(){return Lt.apply(this,arguments)}),submitAnswer:(Ht=g()(f.a.mark(function t(){var e,n,i,o;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$parent.setWaitSubmit(),e="Clarified",this.annotation.properties.answer_submitted_at=(new Date).getTime(),this.lib.AnnotationHelper.note(this.annotation,"question",this.$parent.question),this.lib.AnnotationHelper.note(this.annotation,"answer",this.$parent.answer),n={question:this.$parent.question,answer:this.$parent.answer},i={id:this.annotation.id,type:e,notes:n,properties:this.annotation.properties},!0===this.lib.auth.isEnableControlPermission&&(i.public=this.public),t.next=10,this.lib.AxiosHelper.post("/client/AnnotationSave/update",i);case 10:if(o=t.sent,this.panelData.isAnnotationEditing=!1,1!==o)throw"Update failed";t.next=15;break;case 15:return this.lib.AnnotationHelper.note(this.annotation,n),t.next=18,this.lib.RangyManager.reloadMyHighlights();case 18:this.$emit("update"),this.annotation.type=e;case 20:case"end":return t.stop()}},t,this)})),function(){return Ht.apply(this,arguments)}),writeLater:(Ot=g()(f.a.mark(function t(){var e,n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$parent.setWaitSubmit(),this.lib.AnnotationHelper.note(this.annotation,"question",this.$parent.question),this.lib.AnnotationHelper.note(this.annotation,"answer",this.$parent.answer),e={id:this.annotation.id,notes:{question:this.$parent.question,answer:this.$parent.answer}},!0===this.lib.auth.isEnableControlPermission&&(e.public=this.public),t.next=7,this.lib.AxiosHelper.post("/client/AnnotationSave/update",e);case 7:if(n=t.sent,this.panelData.isAnnotationEditing=!1,1!==n)throw"Update failed";t.next=12;break;case 12:this.$emit("update");case 13:case"end":return t.stop()}},t,this)})),function(){return Ot.apply(this,arguments)}),onComment:function(){this.lib.AnnotationPanel.focusCommentInput()}}},Bt=(n(548),n(550)),Wt=Object(b.a)($t,It,[],!1,null,"6fa9e8ca",null);"function"==typeof Bt.default&&Object(Bt.default)(Wt),Wt.options.__file="webpack-app/client/Reading/components/annotation/AnnotationTypeModules/ConfusedClarified/FooterButtons/FooterButtons.vue";var Ft,qt,jt=Wt.exports,Ut={props:pt,components:{"question-template":kt,"resource-search":Mt,"footer-buttons":jt}};Ut.data=function(){var e=this;if(!this.annotation)throw"No annotation";this.$i18n.locale=this.config.locale;var n="",t="",i="",o="";if(Array.isArray(this.annotation.notes)&&this.annotation.notes.forEach(function(t){"question"===t.type?n=t.note:"answer"===t.type&&(i=t.note)}),""===n){var a=this.status.readingConfig.annotationTypeModules.ConfusedClarified.questionTemplates[0].template;n=this._convertQuestionTemplate(a)}if(""!==i){var s=this.lib.StringHelper.htmlTrim(i);o=s=this.lib.StringHelper.htmlToText(s)}if(""!==n){var r=this.lib.StringHelper.htmlTrim(n);t=r=this.lib.StringHelper.htmlToText(r)}var c=!1;return"number"==typeof this.annotation.id&&(c=!0),this.hook.commentLike=function(t){e.onCommentLike(t)},{question:n,questionReset:t,answer:i,answerReset:o,recommandResourceSearchIndex:0,isQuestionSubmitted:c,questionMinWords:this.status.readingConfig.annotationTypeModules.ConfusedClarified.questionMinWords,answerMinWords:this.status.readingConfig.annotationTypeModules.ConfusedClarified.answerMinWords,awaitSubmit:!1}},Ut.computed={isQuestionEdited:function(){var t=this.lib.StringHelper.htmlTrim(this.question);return(t=this.lib.StringHelper.htmlToText(t))!==this.questionReset},isEnableSubmitQuestion:function(){return"string"==typeof this.question&&""!==this.question},isAnswerEdited:function(){var t=this.lib.StringHelper.htmlTrim(this.answer);return(t=this.lib.StringHelper.htmlToText(t))!==this.answerReset},isAnswerSubmitted:function(){return this.annotation&&this.annotation.properties&&"number"==typeof this.annotation.properties.answer_submitted_at},isEnableSubmitAnswer:function(){return("string"!=typeof this.answer||""!==this.answer)&&("string"!=typeof this.question||""!==this.question)&&(this.isAnswerEdited||this.isQuestionEdited)},isNoteEdited:function(){var t=this.isQuestionEdited||this.isAnswerEdited;return this.panelData.isAnnotationEditing=t},computedQuestionEditorHeight:function(){return!1!==this.isQuestionSubmitted?"8em":this.heightPX<250?"7em":t=!0===this.enableCollaboration&&this.lib.style.isStackWidth?(t=this.lib.style.clientHeight/2,"calc(".concat(t,"px - ").concat("9em",")")):"calc(".concat(this.heightPX,"px - ").concat("9em",")");var t},computedAnswerEditorHeight:function(){var t,e="12em";return this.panelData.enableDiscussion||(e="10em"),t=!0===this.enableCollaboration&&this.lib.style.isStackWidth?(t=this.lib.style.clientHeight/2,"calc(".concat(t,"px - ").concat("8em",")")):400<this.heightPX?"calc(".concat(this.heightPX,"px - ").concat("8em"," - ").concat(e,")"):e},questionPlaceholder:function(){var t=this.status.readingConfig.annotationTypeModules.ConfusedClarified;return this.$t(t.questionPlaceholder)},answerPlaceholder:function(){var t=this.status.readingConfig.annotationTypeModules.ConfusedClarified;return this.$t(t.answerPlaceholder)},anchorText:function(){var t=this.lib.RangyManager.getAnchorTextArrayFromAnnotation(this.annotation).join(" ");return void 0===t?"":(t=this.lib.StringHelper.removePunctuations(t),t)}},Ut.watch={annotation:function(t){if(t&&Array.isArray(t.notes)&&0<t.notes.length){var e="",n="";t.notes.forEach(function(t){"question"===t.type?e=t.note:"answer"===t.type&&(n=t.note)}),this.question=e;var i=this.lib.StringHelper.htmlTrim(e);i=this.lib.StringHelper.htmlToText(i),this.questionReset=i,console.log({questionReset:i}),this.answer=n;var o=this.lib.StringHelper.htmlTrim(n);o=this.lib.StringHelper.htmlToText(o),this.answerReset=o}}},Ut.methods={onQuestionChange:function(t){this.question=t},onAnswerChange:function(t){this.answer=t},selectQuestion:(qt=g()(f.a.mark(function t(e){var n,i,o;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.$refs.QuestionEditor){t.next=2;break}return t.abrupt("return",!1);case 2:if(!0===this.isQuestionEdited&&""!==this.question)return n=this.$t("New question will overwrite your question. Are you sure?"),t.next=6,this.lib.ConfirmModal.show(n);t.next=9;break;case 6:if(!1===t.sent)return t.abrupt("return",!1);t.next=9;break;case 9:i=this._convertQuestionTemplate(e.template),this.$refs.QuestionEditor.html(i),this.question=i,o=this.lib.StringHelper.htmlTrim(i),this.questionReset=this.lib.StringHelper.htmlToText(o),this.recommandResourceSearchIndex=e.searchIndex;case 15:case"end":return t.stop()}},t,this)})),function(t){return qt.apply(this,arguments)}),_convertQuestionTemplate:function(t){if(!this.lib.RangyManager)return null;var e=t.replace("{anchorText}","{0}"),n=this.anchorText;return void 0===n&&(n=this.lib.RangyManager.getPinSelectionAnchorText(),n=this.lib.StringHelper.removePunctuations(n)),e="<p>"+this.$t(e,[n])+"</p>"},onCommentLike:(Ft=g()(f.a.mark(function t(e){var n,i,o;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!1===this.isEditable)return t.abrupt("return",null);t.next=2;break;case 2:if(n=e.note,""!==this.answer)return i=this.$t("Do you want to use his comment as your answer?"),t.next=7,this.lib.ConfirmModal.show(i);t.next=10;break;case 7:if(!1===t.sent)return t.abrupt("return",null);t.next=10;break;case 10:this.answer=n,o=this.lib.StringHelper.htmlTrim(n),o=this.lib.StringHelper.htmlToText(o),this.answerReset=o,this.panelData.isAnnotationEditing=!0,this.$refs.AnswerEditor.html(this.answer),this.$refs.AnswerEditor.focus(!0);case 17:case"end":return t.stop()}},t,this)})),function(t){return Ft.apply(this,arguments)})},ut(Ut),ht(Ut),dt(Ut);var zt=Ut,Xt=(n(551),n(553),n(555)),Qt=Object(b.a)(zt,At,[],!1,null,"3882afce",null);"function"==typeof Xt.default&&Object(Xt.default)(Qt),Qt.options.__file="webpack-app/client/Reading/components/annotation/AnnotationTypeModules/ConfusedClarified/ConfusedClarified.vue";function Vt(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ui form"},[n("HTMLEditor",{ref:"editor",attrs:{lib:t.lib,config:t.config,contents:t.note,editable:t.isEditable,height:t.editorHeight,placeholder:t.editorPlaceholder},on:{input:t.onNoteChange}}),t._v(" "),n("footer-buttons",{attrs:{lib:t.lib,config:t.config,status:t.status,annotation:t.annotation,panelData:t.panelData}})],1)}var Gt=Qt.exports;Vt._withStripped=!0;var Yt,Kt,Jt,Zt={props:pt,data:function(){if(!this.annotation)throw"No annotation";this.$i18n.locale=this.config.locale;var t="";this.annotation&&Array.isArray(this.annotation.notes)&&0<this.annotation.notes.length&&(t=this.annotation.notes[0].note);var e=t;return{note:t,noteReset:e=e&&this.lib.StringHelper.htmlToTextTrim(e,!0)}},components:{"footer-buttons":ft},computed:{isNoteDifferent:function(){var t=this.lib.StringHelper.htmlToTextTrim(this.note,!0).trim()!==this.noteReset;return this.panelData.isAnnotationEditing=t},isEnableSubmitAdd:function(){return!0===this.isNoteDifferent&&"string"==typeof this.note&&""!==this.note},isEnableSubmitEdit:function(){return this.isEnableSubmitAdd},editorHeight:function(){if(this.heightPX<200)return"10em";return!0===this.lib.auth.isEnableCollaboration?(this.lib.style.clientHeight/2,this.lib.style.isStackWidth?"calc(".concat(this.heightPX,"px - ").concat("5em"," - 5em)"):"calc(".concat(this.heightPX,"px - ").concat("5em",")")):"calc(".concat(this.heightPX,"px - ").concat("5em",")")},editorPlaceholder:function(){return this.$t(this.annotationModuleConfig.placeholder)},enableDelete:function(){return!0}},watch:{annotation:function(t){t&&Array.isArray(t.notes)&&0<t.notes.length&&(this.note=t.notes[0].note,this.noteReset=this.lib.StringHelper.htmlToTextTrim(this.note,!0),this.$refs.editor.html(this.note))}},mounted:function(){this.loadDraft()},methods:{loadDraft:(Jt=g()(f.a.mark(function t(){var e;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==this.note)return t.abrupt("return",!1);t.next=2;break;case 2:t.prev=2,e=this.lib.RangyManager.getPinSelectionAnchorText(),t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(2),console.error(t.t0),this.lib.AnnotationPanel.hide(),t.abrupt("return",!1);case 11:e=this.lib.StringHelper.removePunctuations(e).trim(),e="<p>".concat(e,"</p>"),this.note=e,this.noteReset=this.lib.StringHelper.htmlToTextTrim(e,!0),this.$refs.editor&&this.$refs.editor.html(this.note);case 16:case"end":return t.stop()}},t,this,[[2,6]])})),function(){return Jt.apply(this,arguments)}),addAnnotation:(Kt=g()(f.a.mark(function t(){var e,n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.setWaitSubmit(),this.lib.AnnotationHelper.validate(this.annotation),e={anchorPositions:this.annotation.anchorPositions,type:this.annotation.type,notes:{default:this.note}},!0===this.lib.auth.isEnableControlPermission&&(e.public=this.public),n=1,t.next=8,this.lib.AxiosHelper.post("/client/AnnotationSave/create",e);case 8:n=t.sent,t.next=12;break;case 11:console.log(e);case 12:if(this.panelData.isAnnotationEditing=!1,"number"!=typeof n)throw"Create failed";t.next=16;break;case 16:if(this.annotation.id=n,this.lib.AnnotationHelper.note(this.annotation,"default",this.note),this.lib.RangyManager){t.next=20;break}return t.abrupt("return");case 20:this.lib.RangyManager.highlightPinnedSelectionFromAnnotation(this.annotation),this.$refs.editor&&this.$refs.editor.reset(),this.$emit("add");case 23:case"end":return t.stop()}},t,this)})),function(){return Kt.apply(this,arguments)}),editAnnotation:(Yt=g()(f.a.mark(function t(){var e,n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.setWaitSubmit(),e={id:this.annotation.id,notes:{default:this.note}},n=0,t.next=6,this.lib.AxiosHelper.post("/client/AnnotationSave/update",e);case 6:n=t.sent;case 7:if(this.panelData.isAnnotationEditing=!1,1!==n)throw this.$t("Update failed.");t.next=10;break;case 10:this.annotation.notes[0].note=this.note,this.$emit("update");case 12:case"end":return t.stop()}},t,this)})),function(){return Yt.apply(this,arguments)}),onNoteChange:function(t){this.note=t}}};ut(Zt),ht(Zt),dt(Zt);var te=Zt;te.mounted=function(){this.validateAnnotation(),this.loadDraft()},te.computed.enableDelete=function(){return!1},te.methods.loadDraft=g()(f.a.mark(function t(){var e;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.note&&""!==this.note)return t.abrupt("return",!1);t.next=2;break;case 2:return t.next=4,this.lib.AxiosHelper.get("/client/Section/getMainIdeasInSection",{section_id:this.annotation.anchorPositions[0].section_id});case 4:e=t.sent,this.note=e,this.$refs.editor&&this.$refs.editor.html(this.note);case 7:case"end":return t.stop()}},t,this)})),te.methods.validateAnnotation=function(){if(!this.annotation)throw new Error("No annotation!");if(1!==this.annotation.anchorPositions.length)throw console.log(this.annotation.anchorPositions),new Error("Annotation anchorPositions are too much.");if("section"!==this.annotation.anchorPositions[0].type)throw console.log(this.annotation.anchorPositions),new Error("First anchorPosition is not section")};var ee=te,ne=(n(556),n(558)),ie=Object(b.a)(ee,Vt,[],!1,null,"1e98a1d0",null);"function"==typeof ne.default&&Object(ne.default)(ie),ie.options.__file="webpack-app/client/Reading/components/annotation/AnnotationTypeModules/SectionMainIdea/SectionMainIdea.vue";var oe,ae,se,re={props:["lib","status","config","panelData","annotation","heightPX"],data:function(){return{hook:{commentLike:null}}},components:{"annotation-editor-header":st,"annotation-discussion":Q,MainIdea:_t,Confused:Gt,Clarified:Gt,SectionMainIdea:ie.exports},computed:{annotationConfig:function(){return this.lib.auth.stepHighlightAnnotationConfig},enableDiscussion:function(){var t;return t="number"==typeof this.annotation.id&&this.lib.auth.isEnableCollaboration,this.panelData.enableDiscussion=t},computedGridClass:function(){var t=[];return this.isEditable?t.push("edit-mode"):t.push("display-mode"),!0===this.enableDiscussion?t.push("two"):t.push("one"),t.join(" ")+" column grid"},type:function(){if(null!==this.annotation)return this.annotation.type},componentHeightPX:function(){return this.heightPX-70},discussionHeightPX:function(){return this.heightPX},isEditable:function(){return this.lib.AnnotationHelper.isEditable(this.annotation)},computedButtonsClass:function(){return!1===this.lib.style.isLeftHanded?"right aligned column":"column"},computedContainerStyle:function(){return{"max-height":this.heightPX-10+"px"}},computedEditorStyle:function(){return{"max-height":this.heightPX-10+"px"}},displayTime:function(){return this.lib.DayJSHelper.fromNow(this.annotation.updated_at_unixms)}},watch:{annotation:function(){this.hook={},this.initHover(),this.scrollToAnnotation()}},destroyed:function(){this.lib.RangyManager.hoverOut(!0)},mounted:function(){this.initHover(),this.scrollToAnnotation()},methods:{initHover:function(){var t=this;"number"==typeof this.annotation.id&&"object"===c()(this.lib.RangyManager)&&(null!==this.annotation&&"object"===c()(this.annotation)?setTimeout(function(){t.lib.AnnotationHelper.isPublicSectionAnnotation(t.annotation)?t.lib.RangyManager.glowSectionAnnotation(t.annotation):t.lib.RangyManager.hoverIn(t.annotation,!0)},100):this.lib.RangyManager.hoverOut(!0))},scrollToAnnotation:function(){if(!this.lib.RangyManager)return null;var t;t=this.lib.AnnotationHelper.isPublicSectionAnnotation(this.annotation)?this.lib.RangyManager.getRectFromSectionAnnotation(this.annotation):this.lib.RangyManager.getRectFromAnchorPositions(this.annotation.anchorPositions),this.lib.AnnotationPanel.scrollToRect(t)},reloadMyHighlights:(se=g()(f.a.mark(function t(){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.lib.RangyManager){t.next=2;break}return t.abrupt("return",null);case 2:if("textContent"!==this.annotation.anchorPositions[0].type)return t.abrupt("return",!1);t.next=4;break;case 4:return t.next=6,this.lib.RangyManager.reloadMyHighlights();case 6:case"end":return t.stop()}},t,this)})),function(){return se.apply(this,arguments)}),onAdd:function(){this.scrollToAnnotation(),this.lib.AnnotationPanel.triggerEvent("add")},onUpdate:function(){this.scrollToAnnotation(),this.lib.AnnotationPanel.triggerEvent("update"),this.$emit("update")},onDelete:(ae=g()(f.a.mark(function t(){var e,n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.annotation&&"number"!=typeof this.annotation.id)throw new Error("Annotation ID is not existed.");t.next=2;break;case 2:return e=this.$t("Are you sure to delete this annotation?"),t.next=5,this.lib.ConfirmModal.show(e);case 5:if(!1===t.sent)return t.abrupt("return",null);t.next=8;break;case 8:return n={id:this.annotation.id},t.next=11,this.lib.AxiosHelper.get("/client/AnnotationSave/destroy",n);case 11:return t.next=13,this.reloadMyHighlights();case 13:this.scrollToAnnotation(),this.lib.AnnotationPanel.triggerEvent("delete"),this.$emit("delete");case 16:case"end":return t.stop()}},t,this)})),function(){return ae.apply(this,arguments)}),onAnnotationLike:(oe=g()(f.a.mark(function t(){var e;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={annotationID:this.annotation.id},t.next=3,this.lib.AxiosHelper.get("/client/AnnotationRate/like",e);case 3:t.sent;case 4:case"end":return t.stop()}},t,this)})),function(){return oe.apply(this,arguments)}),focusCommentInput:function(){this.$refs.AnnotationDisscussion.focusCommentInput()}}},ce=(n(559),Object(b.a)(re,s,[],!1,null,"16dcafa3",null));ce.options.__file="webpack-app/client/Reading/components/annotation/AnnotationPanel/AnnotationSingle/AnnotationSingle.vue";function le(t){t.computed.computedListStyle=function(){if(this.panelData){var t=40;return this.annotations.length<2&&(t=0),{"max-height":"".concat(this.editorHeightPX-t,"px")}}}}function ue(t){t.computed.annotationsIDList=function(){return Array.isArray(this.annotations)?this.annotations.map(function(t){return t.id}):[]}}var he=ce.exports,de=n(10),fe=n.n(de);function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function ge(t){t.computed.hasKeywordFilter=function(){return this.panelData.keyword&&""!==this.panelData.keyword},t.computed.querySummary=function(){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(n,!0).forEach(function(t){fe()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},this.query);return delete t.excludeIDList,t}}function me(t){t.methods.viewAnnotation=function(t){this.annotation=t},t.methods.viewAnnotationComment=function(t){var e=this;this.viewAnnotation(t),setTimeout(function(){e.$refs.AnnotationSingle.focusCommentInput()},0)},t.methods.findUser=function(t){this.panelData.filter||(this.panelData.filter={}),this.panelData.filter||this.$set(this.panelData,"filter",{}),this.$set(this.panelData.filter,"user",t),this.annotation=null},t.methods.clearFindUser=function(){this.panelData.filter.user=null,this.annotation=null,this.$forceUpdate()},t.methods.findType=function(t){this.panelData.filter||this.$set(this.panelData,"filter",{}),this.$set(this.panelData.filter,"type",t),this.annotation=null},t.methods.clearFindType=function(){this.panelData.filter.type=null,this.annotation=null,this.$forceUpdate()},t.methods.findKeyword=function(t){this.panelData.keyword=t,this.annotation=null},t.methods.clearFindKeyword=function(){this.panelData.keyword=null,this.annotation=null},t.methods.clearFilter=function(){this.panelData.filter&&(this.panelData.filter.user=null,this.panelData.filter.type=null),this.annotation&&console.log(this.annotation.id),this.annotation=null,this.$forceUpdate()},t.methods.backToList=g()(f.a.mark(function t(){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.checkBeforeHide();case 2:if(!1===t.sent)return t.abrupt("return",null);t.next=5;break;case 5:this.glowAnnotation(),this.annotation=null;case 7:case"end":return t.stop()}},t,this)})),t.methods.glowAnnotation=function(){if(!this.annotation)return null;var t=N()(this.$refs.list).children('[data-annotation-id="'.concat(this.annotation.id,'"]'));0<t.length&&t.transition("glow")}}function ve(t){t.methods.scrollList=function(t){if(!0===this.noMore)return!1;var e=t.target;e.scrollHeight-e.scrollTop===e.clientHeight&&this.loadNextPage()}}function be(t){t.methods.loadSummary=g()(f.a.mark(function t(){var e,n,i;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!1===this.isActive)return t.abrupt("return",!1);t.next=2;break;case 2:return e=this.querySummary,this.lib.AnnotationHelper.filter(e),"/client/Annotation/listSummary",t.next=7,this.lib.AxiosHelper.post("/client/Annotation/listSummary",e);case 7:if(0===(n=t.sent))return this.annotations=this.annotations.slice(0,0),this.noMore=!0,this.annotationCount=0,t.abrupt("return",null);t.next=15;break;case 15:this.noMore=!1;case 16:for(i in n)this[i]=n[i];case 17:case"end":return t.stop()}},t,this)})),t.methods.loadNextPage=g()(f.a.mark(function t(){var e,n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!1===this.isActive)return t.abrupt("return",!1);t.next=2;break;case 2:return this.page++,e=this.query,"/client/Annotation/listNext",this.lib.AnnotationHelper.filter(e),t.next=8,this.lib.AxiosHelper.post("/client/Annotation/listNext",e);case 8:n=t.sent,Array.isArray(n)&&0<n.length?this.annotations=this.annotations.concat(n):this.noMore=!0;case 10:case"end":return t.stop()}},t,this)})),t.methods.reload=g()(f.a.mark(function t(){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!1===this.isActive)return t.abrupt("return",!1);t.next=2;break;case 2:return this.annotations=[],this.page=0,this.noMore=!1,t.next=7,this.loadSummary();case 7:case"end":return t.stop()}},t,this)}))}function ye(t){t.methods.findKeyword=function(t){this.panelData.keyword=t,this.annotation=null},t.methods.clearFindKeyword=function(){this.panelData.keyword=null,this.annotation=null}}function Ce(t){t.methods.checkBeforeHide=g()(f.a.mark(function t(){var e;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!1===this.panelData.isAnnotationEditing)return t.abrupt("return",!0);t.next=2;break;case 2:return t.next=4,this.lib.ConfirmModal.show(this.$t("You are still editing. Are you sure to discard changes?"));case 4:return!0===(e=t.sent)&&(this.panelData.isAnnotationEditing=!1),t.abrupt("return",e);case 7:case"end":return t.stop()}},t,this)})),t.methods.focusCommentInput=function(){this.$refs.AnnotationSingle&&this.$refs.AnnotationSingle.focusCommentInput()}}var we={props:["lib","status","config","panelData"],data:function(){return this.$i18n.locale=this.config.locale,{annotations:[],annotationCount:0,users:[],userCount:0,types:[],page:0,noMore:!1,annotation:null}},components:{"annotation-single":he},computed:{isHeaderVisible:function(){return this.hasKeywordFilter||1<this.annotations.length},query:function(){var t={withCount:!0,page:0,excludeIDList:this.annotationsIDList};if(Array.isArray(this.panelData.anchorPositions)&&0<this.panelData.anchorPositions.length&&(t.anchorPositions=this.panelData.anchorPositions),this.panelData.keyword&&""!==this.panelData.keyword&&(t.keyword=this.panelData.keyword),null===t.page)throw new Error("query.page is null");return t},isActive:function(){return!0},editorHeightPX:function(){if(!this.panelData)return null;var t=0;return this.isHeaderVisible&&(t=80),this.panelData.heightPX-t}},watch:{annotations:function(t){if(this.panelData.keyword&&""!==this.panelData.keyword)return null;1===t.length&&(this.annotation=t[0])},"lib.AnnotationPanel":function(t){t&&this.initEventListener()},"panelData.keyword":function(){this.loadSummary()}},mounted:function(){this.initEventListener(),this.loadSummary()},methods:{onUpdate:function(){this.annotation=null,this.annotations.length<2&&this.lib.AnnotationPanel.hide()},onDelete:function(){this.annotation=null,this.annotations.length<2&&this.lib.AnnotationPanel.hide()},initEventListener:function(){var t=this;if(!this.lib.AnnotationPanel)return null;this.lib.AnnotationPanel.addEventListener(["delete","update"],function(){t.reload()})}}};le(we),ue(we),ge(we),me(we),ve(we),be(we),ye(we),Ce(we);var Ae=we,Se=(n(561),n(563),n(565)),_e=Object(b.a)(Ae,a,[],!1,null,"64ecd929",null);"function"==typeof Se.default&&Object(Se.default)(_e),_e.options.__file="webpack-app/client/Reading/components/annotation/AnnotationPanel/AnnotationList/MainList/MainList.vue";function xe(){var n=this,t=n.$createElement,i=n._self._c||t;return i("div",{staticClass:"FilteredList"},[i("div",{staticClass:"summary-information"},[null===n.annotation?i("div",{staticClass:"ui icon input search-input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:n.panelData.keyword,expression:"panelData.keyword"}],attrs:{type:"text",placeholder:n.$t("Search..."),onfocus:"this.select()"},domProps:{value:n.panelData.keyword},on:{input:function(t){t.target.composing||n.$set(n.panelData,"keyword",t.target.value)}}}),n._v(" "),i("i",{staticClass:"search icon"})]):n._e(),n._v(" "),n.annotation?i("button",{staticClass:"ui mini labeled icon button back-button",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),n.backToList(t)}}},[i("i",{staticClass:"angle left icon"}),n._v("\r\n      "+n._s(n.$t("Back to list"))+"\r\n    ")]):i("button",{staticClass:"ui mini labeled icon button back-button",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),n.exit(t)}}},[i("i",{staticClass:"angle left icon"}),n._v("\r\n      "+n._s(n.$t("Back to full list"))+"\r\n    ")]),n._v(" "),null===n.annotation?[i("div",{staticClass:"label"},[n._v("\r\n        "+n._s(n.$t("Find {0} Annotations",[n.annotationCount]))+":\r\n      ")]),n._v(" "),n.hasUserFilter?i("user-avatar-icons",{attrs:{config:n.config,status:n.status,lib:n.lib,users:n.filteringUser},on:{find:n.clearFindUser}}):n._e(),n._v(" "),n.hasTypeFilter?i("annotation-type-button",{attrs:{lib:n.lib,config:n.config,status:n.status,type:n.filteringType},on:{find:n.clearFindType}}):n._e()]:n._e()],2),n._v(" "),i("div",{staticClass:"ui divider"}),n._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!n.annotation,expression:"!annotation"}],ref:"list",staticClass:"list",style:n.computedListStyle,on:{scroll:function(t){return t.stopPropagation(),n.scrollList(t)}}},[n._l(n.annotations,function(t,e){return i("annotation-item",{key:t.id,attrs:{annotation:t,config:n.config,status:n.status,lib:n.lib,isFull:!1,findAnnotation:n.viewAnnotation,findUser:n.findUser,findType:n.findType,searchKeyword:n.panelData.keyword},on:{comment:n.viewAnnotationComment}})}),n._v(" "),n.noMore?i("div",{staticClass:"ui secondary segment no-more"},[0<n.annotations.length?[n._v("\r\n        "+n._s(n.$t("No More"))+"\r\n      ")]:[n._v("\r\n        "+n._s(n.$t("No Search Result"))+"\r\n      ")]],2):n._e()],2),n._v(" "),null!==n.annotation?i("annotation-single",{ref:"AnnotationSingle",attrs:{config:n.config,status:n.status,lib:n.lib,panelData:n.panelData,annotation:n.annotation,heightPX:n.editorHeightPX},on:{update:n.onUpdate,delete:n.onDelete}}):n._e()],1)}var Re=_e.exports;xe._withStripped=!0;var Ee={props:["lib","status","config","panelData","MainList"],data:function(){return this.$i18n.locale=this.config.locale,{annotations:[],annotationCount:0,users:[],userCount:0,types:[],page:0,noMore:!1,annotation:null}},components:{"annotation-single":he},computed:{hasUserFilter:function(){return this.panelData.filter&&this.panelData.filter.user},filteringUser:function(){if(this.hasUserFilter)return[this.panelData.filter.user]},filteringUserID:function(){if(this.hasUserFilter)return this.panelData.filter.user.id},hasTypeFilter:function(){return this.panelData.filter&&"string"==typeof this.panelData.filter.type},hasFilter:function(){return this.hasTypeFilter||this.hasUserFilter},filteringType:function(){if(this.hasTypeFilter)return this.panelData.filter.type},query:function(){var t={withCount:!0,page:0,excludeIDList:this.annotationsIDList};if(Array.isArray(this.panelData.anchorPositions)&&0<this.panelData.anchorPositions.length&&(t.anchorPositions=this.panelData.anchorPositions),this.panelData.keyword&&""!==this.panelData.keyword&&(t.keyword=this.panelData.keyword),this.panelData.filter&&(this.panelData.filter.user&&(t.findUserID=this.panelData.filter.user.id),this.panelData.filter.type&&(t.findType=this.panelData.filter.type)),null===t.page)throw new Error("query.page is null");return t},isActive:function(){return null!==this.hasFilter},editorHeightPX:function(){if(!this.panelData)return null;return this.panelData.heightPX-80},searchingKeyword:function(){if(this.panelData.keyword&&""!==this.panelData.keyword)return this.panelData.keyword},mainListAnnotationCount:function(){return this.MainList&&Array.isArray(this.MainList.annotations)?this.MainList.annotations.length:0}},watch:{"panelData.keyword":function(){this.loadSummary()}},mounted:function(){this.initEventListener(),this.loadSummary()},methods:{initEventListener:function(){var t=this;this.lib.AnnotationPanel.addEventListener(["delete","update"],function(){t.hasFilter&&t.reload()})},onUpdate:function(){var e=this;this.annotaitons=this.annotations.filter(function(t){return t.id!==e.annotation.id?t:e.annotation}),this.annotation=null},onDelete:function(){var e=this;this.annotaitons=this.annotations.filter(function(t){return t.id!==e.annotation.id}),this.annotation=null,0===this.annotations.length&&this.exit()},exit:function(){this.$emit("exit"),this.clearFilter()},glowAnnotation:function(){}}};le(Ee),ue(Ee),ge(Ee),me(Ee),ve(Ee),be(Ee),ye(Ee),Ce(Ee);var Te=Ee,ke=(n(566),n(568),n(570)),De=Object(b.a)(Te,xe,[],!1,null,"0dc943e9",null);"function"==typeof ke.default&&Object(ke.default)(De),De.options.__file="webpack-app/client/Reading/components/annotation/AnnotationPanel/AnnotationList/FilteredList/FilteredList.vue";var Ne={props:["lib","status","config","panelData"],data:function(){return this.$i18n.locale=this.config.locale,{MainList:null}},components:{"main-list":Re,"filtered-list":De.exports},computed:{isFiltering:function(){if(this.panelData.filter){var t=this.panelData.filter;return null!==t.user&&"object"===c()(t.user)||"string"==typeof t.type}return!1}},mounted:function(){var t=this;this.scrollTo(),setTimeout(function(){t.MainList=t.$refs.MainList},0)},methods:{scrollTo:function(){if(!this.panelData.anchorPositions||0===this.panelData.anchorPositions.length)return!1;var t=this.lib.RangyManager.getRectFromAnchorPositions(this.panelData.anchorPositions);this.lib.AnnotationPanel.scrollToRect(t)},onFilteredListExit:function(){this.$refs.FilteredList.clearFilter(),this.$refs.MainList.annotations.length<2&&this.lib.AnnotationPanel.hide()},focusCommentInput:function(){this.isFiltering?this.$refs.FilteredList.focusCommentInput():this.$refs.MainList.focusCommentInput()}}},Pe=(n(571),n(573)),Ie=Object(b.a)(Ne,o,[],!1,null,"5688f63a",null);"function"==typeof Pe.default&&Object(Pe.default)(Ie),Ie.options.__file="webpack-app/client/Reading/components/annotation/AnnotationPanel/AnnotationList/AnnotationList.vue";function Me(t){t.preventDefault(),t.stopPropagation()}var Oe,He,Le,$e,Be,We,Fe=Ie.exports,qe={panelData:{anchorPositions:null,annotation:null,isAnnotationEditing:!1,enableDiscussion:!1,filter:{user:null,type:null},hooks:{cancel:null,add:null,update:null,delete:null},focusCommentID:null,keyword:"",heightPX:500},isHide:!0,placeholder:null,resizeLocker:!1,events:{}},je="slide up",Ue="pacor-disable-user-select",ze=!1,Xe=null,Qe={props:["lib","status","config"],data:function(){return qe},components:{"annotation-list":Fe,"annotation-single":he},computed:{},watch:{},mounted:function(){this._initHeightPX(),this._initPlaceholder(),this.setupTutorial()},destroyed:function(){this.placeholder.remove(),this.removeWindowResizeEvents()},methods:{}};(Oe=Qe).computed.annotationConfig=function(){return this.lib.auth.currentStepConfig.annotation},Oe.computed.computedPlaceholderHeight=function(){return"calc(".concat(this.panelData.heightPX,"px - ").concat(this.navigationPlaceholderHeight,"px)")},Oe.computed.computedSegmentStyle=function(){return!0===this.lib.auth.isEnableCollaboration&&!0===this.lib.style.isStackWidth?{"max-height":"".concat(this.panelData.heightPX,"px"),"overflow-y":"auto","overflow-x":"hidden"}:{height:"".concat(this.panelData.heightPX,"px")}},Oe.computed.computedSegmentClass=function(){if("string"==typeof this.annotationModule)return this.status.readingConfig.annotationTypeModules[this.annotationModule].style.segmentColor},Qe.watch.currentStep=function(){this.hide()},(He=Qe).methods.show=function(){function t(){}this.isHide=!1,this.panelData.heightPX<this.lib.style.params.AnnotationPanelDisplayMinPanelHeight&&(this.panelData.heightPX=this.lib.style.params.AnnotationPanelDisplayMinPanelHeight),this.lib.style.isEnableAnimte?(this.placeholder.transition(je),N()(this.$refs.panel).transition(je,t)):(this.placeholder.show(),N()(this.$refs.panel).show())},He.methods.hide=function(){var e=g()(f.a.mark(function t(e){var n,i=this;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.checkBeforeHide();case 2:if(!1===t.sent)return t.abrupt("return",!1);t.next=5;break;case 5:n=function(){if(!0===i.isHide)return!1;i.isHide=!0},this.lib.style.isEnableAnimte?(this.placeholder.transition(je),N()(this.$refs.panel).transition(je,n)):(this.placeholder.show(),N()(this.$refs.panel).show(),n()),(e="boolean"!=typeof e||e)&&this.triggerEvent("cancel"),this.lib.RangyManager.hoverOut(!0),this.reset();case 11:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),He.methods.checkBeforeHide=g()(f.a.mark(function t(){var e;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!1===this.panelData.isAnnotationEditing)return t.abrupt("return",!0);t.next=2;break;case 2:return t.next=4,this.lib.ConfirmModal.show(this.$t("You are still editing. Are you sure to discard changes?"));case 4:return!0===(e=t.sent)&&(this.panelData.isAnnotationEditing=!1),t.abrupt("return",e);case 7:case"end":return t.stop()}},t,this)})),(Le=Qe).methods.scrollToRect=function(t){if(!t)return!1;var e,n=window.innerHeight-this.panelData.heightPX,i=this.getScrollTop(),o=i+n;if(t.height<n){if(t.top>i&&t.bottom<o)return!1}else if(!(t.bottom<i||t.top>o))return!1;e=t.height<n?t.top-(n-t.height)/2:t.top+n/10,this.lib.style.scrollTo({top:e,behavior:"smooth"})},Le.methods.getScrollTop=function(){var t=0;return void 0!==window.pageYOffset?t=window.pageYOffset:void 0===document.compatMode&&"BackCompat"!==document.compatMode?t=document.documentElement.scrollTop:void 0!==document.body&&(t=document.body.scrollTop),t},($e=Qe).methods._initHeightPX=function(){var t=localStorage.getItem("client.components.ReadingProgressesModuels.Reading.components.AnnotationManager.AnnotationPanel.sizeRatio");(t=null===t?.5:parseFloat(t))<this.lib.style.params.AnnotationPanelDisplayMinPanelRatio&&(t=this.lib.style.params.AnnotationPanelDisplayMinPanelRatio);var e=window.innerHeight*t;e<this.lib.style.params.AnnotationPanelDisplayMinPanelHeight&&(e=this.lib.style.params.AnnotationPanelDisplayMinPanelHeight),this.panelData.heightPX=e,this.addWindowResizeEvents()},$e.methods.addWindowResizeEvents=function(){window.addEventListener("resize",this.onWindowResize)},$e.methods.removeWindowResizeEvents=function(){window.removeEventListener("resize",this.onWindowResize)},$e.methods.onWindowResize=function(){var t=window.innerHeight;t<this.lib.style.params.AnnotationPanelDisplayMinPanelHeight&&(t=this.lib.style.params.AnnotationPanelDisplayMinPanelHeight),t<this.panelData.heightPX&&(this.panelData.heightPX=t)},$e.methods._initPlaceholder=function(){var t=N()(".Navigation.placeholder:first");1===t.length&&(this.navigationPlaceholderHeight=t.height());var e=N()('<div class="non-invasive-web-style-framework"></div>').appendTo("body");this.placeholder=N()('<div class="AnnotationPanel placeholder"></div>').css("height",this.computedPlaceholderHeight).hide().appendTo(e)},(Be=Qe).methods.setAnchorPositions=function(t,e){void 0===e&&!1===Array.isArray(t)&&(e=t,t=[]),this.panelData.anchorPositions=t,e&&(this.panelData.hooks=e),this.show()},Be.methods.setAnnotation=function(t,e){this.panelData.annotation=t,e&&(this.panelData.hooks=e),this.show()},Be.methods.focusCommentInput=function(t){var e=this;t&&this.setAnnotation(t),setTimeout(function(){e.$refs.AnnotationSingle?e.$refs.AnnotationSingle.focusCommentInput():e.$refs.AnnotationList.focusCommentInput()},0)},Be.methods.focusAnnotation=function(){var e=g()(f.a.mark(function t(e){var n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("number"!=typeof e)throw new Error("annotationID is not a number. "+e);t.next=2;break;case 2:return t.next=4,this.lib.AxiosHelper.get("/client/Annotation/getAnnotation",{annotationID:e});case 4:n=t.sent,this.setAnnotation(n);case 6:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),Be.methods.focusComment=function(){var e=g()(f.a.mark(function t(e){var n;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("number"!=typeof e)throw new Error("commentID is not a number. "+e);t.next=2;break;case 2:return t.next=4,this.lib.AxiosHelper.get("/client/AnnotationComment/getAnnotation",{commentID:e});case 4:n=t.sent,this.panelData.focusCommentID=e,this.setAnnotation(n);case 7:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),Be.methods.setFilter=function(t){this.panelData.filter=t},Be.methods.findType=function(t){this.panelData.filter||(this.panelData.filter={}),this.panelData.filter.type=t},Be.methods.findUser=function(t){this.panelData.filter||(this.panelData.filter={}),this.panelData.filter.user=t},Be.methods.findKeyword=function(t){this.panelData.keyword=t},Be.methods.setHooks=function(t){this.panelData.hooks=t},Be.methods.reset=function(){this.panelData.anchorPositions=null,this.panelData.hooks=null,this.panelData.filter=null,this.panelData.annotation=null,this.panelData.keyword="",this.lib.RangyManager.hoverOut(!0)},Be.methods.triggerHook=function(){var e=g()(f.a.mark(function t(e){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.panelData.hooks&&"function"==typeof this.panelData.hooks[e])return t.next=3,this.panelData.hooks[e](this.panelData.annotation);t.next=4;break;case 3:this.panelData.hooks&&"object"===c()(this.panelData.hooks)&&(this.panelData.hooks[e]=null);case 4:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),(We=Qe).methods.addEventListener=function(t,e){var n=this;return"function"==typeof e&&(Array.isArray(t)?t.forEach(function(t){n.addEventListener(t,e)}):(!1===Array.isArray(this.events[t])&&(this.events[t]=[]),this.events[t].push(e)),this)},We.methods.triggerEvent=function(){var e=g()(f.a.mark(function t(e){var n,i;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!Array.isArray(this.events[e])){t.next=13;break}n=this.events[e],i=0;case 4:if(i<n.length)return t.next=7,n[i](this.panelData.annotation);t.next=13;break;case 7:if(!1===t.sent)return t.abrupt("return",!1);t.next=10;break;case 10:i++,t.next=4;break;case 13:this.triggerHook(e),"add"===e&&this.hide(!1);case 15:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),Qe.methods.onResizeStart=function(t){var i=this;if(!0===ze)return!1;ze=!0,(Xe=Xe||N()("body")).bind("scroll",Me),Xe.addClass(Ue);var o=t.clientY;function e(t){var e=t.clientY;if(e=e||t.touches[0].clientY,!1===i.lib.style.isSmallHeight){if(e<a||window.innerHeight-e<s)return!1}else if(e<a/2||window.innerHeight-e<s/2)return!1;var n=o-e;i.panelData.heightPX=i.panelData.heightPX+n,o=e}function n(){document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",n),document.removeEventListener("touchmove",e),document.removeEventListener("touchend",n),Xe.removeClass(Ue),ze=!1;var t=(window.innerHeight-o)/window.innerHeight;localStorage.setItem("client.components.ReadingProgressesModuels.Reading.components.AnnotationManager.AnnotationPanel.sizeRatio",t),Xe.unbind("scroll",Me)}o=o||t.touches[0].clientY;var a=this.lib.style.params.AnnotationPanelMaxTopGap,s=this.lib.style.params.AnnotationPanelMinPanelHeight;document.addEventListener("mousemove",e),document.addEventListener("mouseup",n),document.addEventListener("touchmove",e),document.addEventListener("touchend",n),t.preventDefault(),t.stopPropagation()},Qe.methods.setupTutorial=function(){var t=this;if("IndividualReading"!==this.lib.auth.currentStep)return!1;this.lib.TutorialManager.addAction({element:function(){return t.$refs.panel},content:this.$t("You can add note for the annotation."),order:31}),this.lib.TutorialManager.addAction({element:function(){return N()(t.$refs.panel).find(".AnnotationSingle .add-button.ValidationButton:visible:first")},content:this.$t('Click "ADD" to save it.'),order:32})};var Ve=Qe,Ge=(n(574),n(576),n(578)),Ye=Object(b.a)(Ve,i,[],!1,null,"62f82089",null);"function"==typeof Ge.default&&Object(Ge.default)(Ye),Ye.options.__file="webpack-app/client/Reading/components/annotation/AnnotationPanel/AnnotationPanel.vue";e.default=Ye.exports},function(t,e,n){"use strict";n.r(e);function i(){var n=this,t=n.$createElement,i=n._self._c||t;return i("div",{staticClass:"SectionManager"},[n._l(n.sectionNodes,function(t,e){return[i("section-panel",{attrs:{config:n.config,status:n.status,lib:n.lib,node:t,sectionSeqID:e,sectionsData:n.sectionsData},on:{complete:function(t){return n.$emit("complete")}}})]})],2)}i._withStripped=!0;function o(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"panel",staticClass:"non-invasive-web-style-framework SectionPanel",attrs:{"data-section-id":e.sectionSeqID}},[e.isChecklistSubmitted?e._e():n("section-checklist",{attrs:{config:e.config,status:e.status,lib:e.lib,node:e.node,sectionSeqID:e.sectionSeqID,sectionsData:e.sectionsData},on:{checklistComplete:e.checkIsChecklistSubmitted,allComplete:function(t){return e.$emit("complete")}}}),e._v(" "),e.isShowAnnotationList?n("section-annotation-list",{attrs:{config:e.config,status:e.status,lib:e.lib,node:e.node,sectionSeqID:e.sectionSeqID,sectionsData:e.sectionsData}}):e._e()],1)}function a(){var n=this,t=n.$createElement,i=n._self._c||t;return i("div",{staticClass:"ui segment SectionChecklist"},[i("div",{staticClass:"header-container"},[i("div",{staticClass:"ui tiny header"},[i("div",{staticClass:"content"},[n._v("\r\n        #"+n._s(n.sectionSeqID+1)+"\r\n        "+n._s(n.$t("Check list"))+"\r\n        "+n._s(n.sectionHeader)+"\r\n      ")])])]),n._v(" "),i("button",{staticClass:"ui fluid button",style:n.computedSectionMainIdeaButtonStyle,attrs:{type:"button"},on:{click:n.openSectionAnnotationEditor}},[n.isChecklistAnnotationSubmitted?[n._v("\r\n      "+n._s(n.$t("Edit section main ideas"))+"\r\n    ")]:[n._v("\r\n      "+n._s(n.$t("Write section main ideas"))+"\r\n    ")]],2),n._v(" "),i("div",{staticClass:"ui list"},[n._l(n.checklist,function(t,e){return[e!==n.checklistAnnotationIndex?i("a",{staticClass:"item",on:{click:function(t){return n.onChecklistItemChange(e)}}},[i("div",{staticClass:"ui checkbox"},[i("input",{attrs:{type:"checkbox"},domProps:{checked:n.checked[e]},on:{click:function(t){if(t.target!==t.currentTarget)return null;t.stopPropagation(),n.onChecklistItemChange(e)}}}),n._v(" "),i("label",[n._v("\r\n            "+n._s(n.$t(t))+"\r\n          ")])])]):i("a",{staticClass:"item",on:{click:function(t){return n.openSectionAnnotationEditor()}}},[i("div",{staticClass:"ui checkbox"},[i("input",{attrs:{type:"checkbox"},domProps:{checked:n.isChecklistAnnotationSubmitted},on:{click:function(t){t.preventDefault(),t.stopPropagation(),n.openSectionAnnotationEditor()}}}),n._v(" "),i("label",[n._v("\r\n            "+n._s(n.$t("I have already written the main ideas of this section."))+"\r\n          ")])])])]})],2),n._v(" "),i("button",{staticClass:"ui fluid button submit-button",class:n.computedSubmitButtonClass,attrs:{type:"button"},on:{click:n.submitChecklist}},[n._v("\r\n    "+n._s(n.computedSubmitButtonText)+"\r\n  ")])])}var s=n(0),r=n.n(s),c=n(1),l=n.n(c),u=n(3),h=n.n(u);a._withStripped=o._withStripped=!0;var d,f,p={props:["lib","status","config","sectionSeqID","sectionsData"],computed:{},mounted:function(){this.checkIsChecklistCompleted()},methods:{},destroyed:function(){this.removeLocalStorage()}};p.data=function(){if(this.$i18n.locale=this.config.locale,!this.sectionsData.checklist[this.sectionSeqID]&&(this.sectionsData.checklist[this.sectionSeqID]=[],this.lib.auth.stepSectionAnnotationConfig&&this.lib.auth.stepSectionAnnotationConfig.checklist))for(var t=this.lib.auth.stepSectionAnnotationConfig.checklist.length,e=0;e<t;e++)this.sectionsData.checklist[this.sectionSeqID].push(!1);var n=!1;return this.sectionsData.checklistAnnotation[this.sectionSeqID]&&(n=!0),{isChecklistAnnotationSubmitted:n,isChecklistCompleted:!1}},(d=p).computed.checked=function(){var n=this;!1!==Array.isArray(this.sectionsData.checklist[this.sectionSeqID])&&0!==this.sectionsData.checklist[this.sectionSeqID].length||(this.sectionsData.checklist[this.sectionSeqID]=new Array(this.checklist.length));var t,e=localStorage.getItem(this.localStorageKeyPrefix+"checklist");return null!==e&&JSON.parse(e).forEach(function(t,e){"boolean"==typeof t&&(n.sectionsData.checklist[n.sectionSeqID][e]=t)}),-1!==this.checklistAnnotationIndex&&(t=!0===this.isChecklistAnnotationSubmitted||!(!this.annotation||"number"!=typeof this.annotation.id),this.sectionsData.checklist[this.sectionSeqID][this.checklistAnnotationIndex]=t),this.sectionsData.checklist[this.sectionSeqID]},d.computed.annotation=function(){return this.sectionsData.checklistAnnotation[this.sectionSeqID]?this.sectionsData.checklistAnnotation[this.sectionSeqID]:this.lib.SectionManager?this.lib.SectionManager.buildDefaultSectionAnnotation(this.sectionSeqID):void 0},d.computed.computedSubmitButtonText=function(){return this.isChecklistCompleted?this.$t("I have read this section!"):this.$t("Please finish checklist.")},d.computed.localStorageKeyPrefix=function(){return"Pacor.SectionChecklist.".concat(this.sectionSeqID,".")},d.computed.checklistAnnotationIndex=function(){return this.checklist.indexOf("SectionMainIdea")},d.computed.checklist=function(){if(!this.lib.auth.stepSectionAnnotationConfig&&!1===Array.isArray(this.lib.auth.stepSectionAnnotationConfig.checklist))throw new Error(this.$t("Lost checklist config"));return this.lib.auth.stepSectionAnnotationConfig.checklist},d.computed.computedSubmitButtonClass=function(){var t=[];return!1===this.isChecklistCompleted?t.push("disabled"):t.push("positive"),t.join(" ")},d.computed.sectionHeader=function(){for(var t=[],e=1;e<=6;e++)t.push("[data-pacor-section-seq-id=".concat(this.sectionSeqID,"] h").concat(e,":first"));t=t.join(",");var n=h()(t);if(0<n.length)return n=n.eq(0),this.$t(":")+" "+n.text().trim()},d.computed.computedSectionMainIdeaButtonStyle=function(){var t=this.status.readingConfig.annotationTypeModules.SectionMainIdea.style.button;return{color:t.color,"background-color":t.backgroundColor}},(f=p).methods.onChecklistItemChange=function(t){this.checked[t]=!this.checked[t],this.$forceUpdate(),this.checkIsChecklistCompleted(),this._saveToLocalStorage()},f.methods._saveToLocalStorage=function(){var t=JSON.stringify(this.checked);localStorage.setItem(this.localStorageKeyPrefix+"checklist",t)},f.methods.removeLocalStorage=function(){localStorage.removeItem(this.localStorageKeyPrefix+"checklist")},f.methods.openSectionAnnotationEditor=function(){var e=this;this.lib.AnnotationPanel.setAnnotation(this.annotation,{add:function(t){t.user_id=e.status.userID,t.user=e.lib.auth.annotationUserData,e.sectionsData.checklistAnnotation.splice(e.sectionSeqID,1,t),e.sectionsData.checklist[e.sectionSeqID][e.checklistAnnotationIndex]=!0,e.isChecklistAnnotationSubmitted=!0,e.sectionsData.annotation[e.sectionSeqID]||(e.sectionsData.annotation[e.sectionSeqID]={}),e.sectionsData.annotation[e.sectionSeqID].annotations||(e.sectionsData.annotation[e.sectionSeqID].annotations=[]),e.sectionsData.annotation[e.sectionSeqID].myAnnotation=t,e.checkIsChecklistCompleted(),e._saveToLocalStorage()},update:function(t){e.sectionsData.checklistAnnotation.splice(e.sectionSeqID,1,t)}})},f.methods.submitChecklist=l()(r.a.mark(function t(){var e;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.sectionsData.checklist[this.sectionSeqID]=this.checked,e={checklist:this.sectionsData.checklist},t.next=5,this.lib.AxiosHelper.post("/client/Section/setChecklist",e);case 5:this.sectionsData.checklistSubmitted[this.sectionSeqID]=!0,this.checkAllChecklistsIsComplete(),this.$emit("checklistComplete");case 8:case"end":return t.stop()}},t,this)})),f.methods.checkAllChecklistsIsComplete=function(){for(var t=!0,e=0;e<this.sectionsData.checklistSubmitted.length;e++)if(!0!==this.sectionsData.checklistSubmitted[e]){t=!1;break}!0===t&&this.$emit("allComplete")},f.methods.checkIsChecklistCompleted=function(){var t=this.sectionsData.checklist[this.sectionSeqID];if(!t)return!1;var e=t.filter(function(t){return!0!==t});this.isChecklistCompleted=0===e.length};var g=p,m=(n(588),n(2)),v=n(590),b=Object(m.a)(g,a,[],!1,null,"f84ea218",null);"function"==typeof v.default&&Object(v.default)(b),b.options.__file="webpack-app/client/Reading/components/annotation/SectionManager/SectionPanel/SectionChecklist/SectionChecklist.vue";function y(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ui segment SectionAnnotationList",on:{mouseover:function(t){e.sectionsData.enableRefresh=!1},mouseout:function(t){e.sectionsData.enableRefresh=!0},touchstart:function(t){e.sectionsData.enableRefresh=!1},touchend:function(t){e.sectionsData.enableRefresh=!0}}},[1<e.userCount?[n("div",{staticClass:"summary-information"},[n("user-avatar-icons",{staticStyle:{"margin-right":"0.5em"},attrs:{config:e.config,status:e.status,lib:e.lib,users:e.users,userCount:e.userCount},on:{find:function(t){e.findUser=t}}})],1)]:e._e(),e._v(" "),e.myAnnotation?n("annotation-item",{key:e.myAnnotation.id,staticClass:"my-annotation",attrs:{config:e.config,status:e.status,lib:e.lib,annotation:e.myAnnotation,findAnnotation:e.findAnnotation}}):e._e(),e._v(" "),e.myAnnotation&&0<e.sectionsData.annotation[e.sectionSeqID].annotations.length?n("div",{staticClass:"ui divider"}):e._e(),e._v(" "),e.hasAnnotation?n("div",{staticClass:"annotation-list",on:{scroll:function(t){return t.stopPropagation(),e.scrollList(t)}}},[e._l(e.sectionsData.annotation[e.sectionSeqID].annotations,function(t){return n("annotation-item",{key:t.id,attrs:{config:e.config,status:e.status,lib:e.lib,annotation:t,findAnnotation:e.findAnnotation}})}),e._v(" "),e.noMore?n("div",{staticClass:"ui secondary segment no-more"},[0<e.sectionsData.annotation[e.sectionSeqID].annotations.length?[e._v("\r\n        "+e._s(e.$t("No More"))+"\r\n      ")]:[e._v("\r\n        "+e._s(e.$t("No Search Result"))+"\r\n      ")]],2):e._e()],2):e._e(),e._v(" "),n("editor-button",{style:e.computedSectionMainIdeaButtonStyle,attrs:{config:e.config,status:e.status,lib:e.lib,sectionSeqID:e.sectionSeqID,sectionsData:e.sectionsData,myAnnotation:e.myAnnotation}})],2)}var C=b.exports;y._withStripped=!0;function w(){var t=this,e=t.$createElement;return(t._self._c||e)("button",{staticClass:"ui fluid button",attrs:{type:"button"},on:{click:t.openSectionAnnotationEditor}},[t.myAnnotation?[t._v("\r\n    "+t._s(t.$t("Edit section main ideas"))+"\r\n  ")]:[t._v("\r\n    "+t._s(t.$t("Write section main ideas"))+"\r\n  ")]],2)}var A=n(4),S=n.n(A);w._withStripped=!0;var _={props:["lib","status","config","sectionSeqID","sectionsData","myAnnotation"],data:function(){return this.$i18n.locale=this.config.locale,{}},computed:{annotation:function(){return this.myAnnotation?this.myAnnotation:this.lib.SectionManager.buildDefaultSectionAnnotation(this.sectionSeqID)}},methods:{openSectionAnnotationEditor:function(){var e=this;this.lib.AnnotationPanel.setAnnotation(this.annotation,{add:function(t){e.onAnnotationAdd(t)},update:function(t){e.onAnnotationUpdate(t)}})},onAnnotationAdd:function(t){for(!1===Array.isArray(this.sectionsData.annotation)&&(this.sectionsData.annotation=[]);"object"!==S()(this.sectionsData.annotation[this.sectionSeqID]);)this.sectionsData.annotation.push({annotations:[]});this.sectionsData.annotation[this.sectionSeqID].annotations.unshift(t)},onAnnotationUpdate:function(t){for(var e=0;e<this.annotations.length;e++)this.annotations[e].user_id===this.status.userID&&(this.sectionsData.annotation[this.sectionSeqID].annotations[e]=t)}}},x=(n(591),n(593)),R=Object(m.a)(_,w,[],!1,null,"db014592",null);"function"==typeof x.default&&Object(x.default)(R),R.options.__file="webpack-app/client/Reading/components/annotation/SectionManager/SectionPanel/SectionAnnotationList/EditorButton/EditorButton.vue";var E,T,k={props:["lib","status","config","sectionSeqID","sectionsData"],data:function(){return this.$i18n.locale=this.config.locale,{page:0,noMore:!1}},components:{"editor-button":R.exports},computed:{instance:function(){if(!this.sectionsData)throw new Error("no section data");return"object"!==S()(this.sectionsData.annotation[this.sectionSeqID])&&(this.sectionsData.annotation[this.sectionSeqID]={}),this.sectionsData.annotation[this.sectionSeqID]},users:function(){return!1===Array.isArray(this.sectionsData.annotation[this.sectionSeqID].users)&&(this.sectionsData.annotation[this.sectionSeqID].users=[]),this.sectionsData.annotation[this.sectionSeqID].users},userCount:function(){return this.sectionsData.annotation[this.sectionSeqID]?this.sectionsData.annotation[this.sectionSeqID].userCount:0},annotations:function(){return this.sectionsData.annotation[this.sectionSeqID]?(!1===Array.isArray(this.sectionsData.annotation[this.sectionSeqID].annotations)&&(this.sectionsData.annotation[this.sectionSeqID].annotations=[]),this.sectionsData.annotation[this.sectionSeqID].annotations):[]},myAnnotation:function(){if(this.sectionsData.annotation[this.sectionSeqID])return this.sectionsData.annotation[this.sectionSeqID].myAnnotation},hasAnnotation:function(){return this.sectionsData&&this.sectionsData.annotation&&this.sectionsData.annotation[this.sectionSeqID]&&this.sectionsData.annotation[this.sectionSeqID].annotations&&0<this.sectionsData.annotation[this.sectionSeqID].annotations.length},computedSectionMainIdeaButtonStyle:function(){var t=this.status.readingConfig.annotationTypeModules.SectionMainIdea.style.button;return{color:t.color,"background-color":t.backgroundColor}}},watch:{page:function(t){-1<t&&this.loadNext()}},methods:{findAnnotation:function(t){var e=this;this.lib.AnnotationPanel.setAnnotation(t,{update:function(){e.reloadList()}})},loadNext:(T=l()(r.a.mark(function t(){var e,n,i=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={page:this.page,seq_id:this.sectionSeqID},t.next=3,this.lib.AxiosHelper.get("/client/Section/annotationsNext",e);case 3:n=t.sent,Array.isArray(n)&&0<n.length?(n.forEach(function(t){i.sectionsData.annotation[i.sectionSeqID].annotations.push(t)}),this.$forceUpdate()):this.noMore=!0;case 5:case"end":return t.stop()}},t,this)})),function(){return T.apply(this,arguments)}),reloadList:(E=l()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.sectionsData.annotation[this.sectionSeqID].annotations=this.sectionsData.annotation[this.sectionSeqID].annotations.slice(0,0),0===this.page)return t.next=4,this.loadNext();t.next=6;break;case 4:t.next=7;break;case 6:this.page=0;case 7:case"end":return t.stop()}},t,this)})),function(){return E.apply(this,arguments)}),scrollList:function(t){if(!0===this.noMore)return!1;var e=t.target;e.scrollHeight-e.scrollTop===e.clientHeight&&this.page++}}},D=(n(594),n(596)),N=Object(m.a)(k,y,[],!1,null,"0339763a",null);"function"==typeof D.default&&Object(D.default)(N),N.options.__file="webpack-app/client/Reading/components/annotation/SectionManager/SectionPanel/SectionAnnotationList/SectionAnnotationList.vue";var P={props:["lib","status","config","node","sectionSeqID","sectionsData"],data:function(){return this.$i18n.locale=this.config.locale,{checklistData:[],isChecklistSubmitted:this.lib.auth.isEnableCollaboration}},components:{"section-checklist":C,"section-annotation-list":N.exports},computed:{isShowAnnotationList:function(){return!1!==this.lib.auth.isEnableCollaboration||this.isChecklistSubmitted}},watch:{"lib.auth.isEnableCollaboration":function(t){!0===t&&(this.isChecklistSubmitted=!0)}},mounted:function(){this.initPanel(),this.checkIsChecklistSubmitted()},destroyed:function(){h()('.non-invasive-web-style-framework.SectionPanel[data-section-id="'.concat(this.sectionSeqID,'"]')).remove()},methods:{initPanel:function(){this.node.parentNode.insertBefore(this.$refs.panel,this.node.nextSibling)},checkIsChecklistSubmitted:function(){if(!0===this.lib.auth.isEnableCollaboration)return this.isChecklistSubmitted=!0,null;this.isChecklistSubmitted=this.sectionsData&&Array.isArray(this.sectionsData.checklistSubmitted)&&!0===this.sectionsData.checklistSubmitted[this.sectionSeqID]}}},I=Object(m.a)(P,o,[],!1,null,null,null);I.options.__file="webpack-app/client/Reading/components/annotation/SectionManager/SectionPanel/SectionPanel.vue";var M,O,H,L,$={props:["lib","status","config"],data:function(){return this.$i18n.locale=this.config.locale,{sectionNodes:[],sectionsData:{checklist:[],checklistAnnotation:[],checklistSubmitted:[],annotation:[]},enableLoad:!0,pause:!1}},components:{"section-panel":I.exports},computed:{query:function(){return null!==this.status.filter.focusUser&&"number"==typeof this.status.filter.focusUser.id?{focusUserID:this.status.filter.focusUser.id}:{}}},watch:{"status.filter.focusUser":function(){this.loadAnnotation()},"lib.auth.currentStep":function(){this.loadAnnotation()}},mounted:function(){this.addFocusBlurEvent(),this.initSectionNodes()},destroyed:function(){this.enableLoad=!1,this.removeFocusBlurEvent()},methods:{initSectionNodes:(H=l()(r.a.mark(function t(){var e,n,i,o=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.lib.auth.stepSectionAnnotationConfig){t.next=2;break}return t.abrupt("return",!1);case 2:if(this.query.selector)throw console.error(this.query),new Error("this.query is incorrect.");t.next=5;break;case 5:return t.next=7,this.lib.AxiosHelper.get("/client/Section/init",this.query);case 7:e=t.sent,this.sectionsData=e,n=h()("[data-pacor-section-seq-id]").toArray(),i=n.length,this.sectionNodes=n,Object.keys(this.sectionsData).forEach(function(t){!1===Array.isArray(o.sectionsData[t])&&(o.sectionsData[t]=new Array(i))}),this.setRefreshInterval(),this.setupTutorial();case 15:case"end":return t.stop()}},t,this)})),function(){return H.apply(this,arguments)}),addFocusBlurEvent:function(){window.addEventListener("focus",this.focusEvent),window.addEventListener("blur",this.blurEvent)},removeFocusBlurEvent:function(){window.removeEventListener("focus",this.focusEvent),window.removeEventListener("blur",this.blurEvent),this.pause=!0},focusEvent:function(){!0===this.pause&&(this.pause=!1,this.loadAnnotation())},blurEvent:function(){if("reader"!==this.status.role)return!1;this.pause=!0},loadAnnotation:(O=l()(r.a.mark(function t(){var e;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!1===this.enableLoad||!1===this.lib.auth.isEnableCollaboration||!0===this.pause)return t.abrupt("return",!1);t.next=2;break;case 2:return t.next=4,this.lib.AxiosHelper.get("/client/Section/getSectionAnnotations",this.query);case 4:e=t.sent,Array.isArray(e)&&(this.sectionsData.annotation=e);case 6:case"end":return t.stop()}},t,this)})),function(){return O.apply(this,arguments)}),setRefreshInterval:(M=l()(r.a.mark(function t(){var e;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!1===this.lib.auth.isEnableCollaboration)return t.abrupt("return",!1);t.next=2;break;case 2:if("number"!=typeof(e=this.lib.auth.stepSectionAnnotationConfig.updateInterval))return t.abrupt("return",!1);t.next=5;break;case 5:return t.next=7,this.lib.VueHelper.sleep(e);case 7:if(!1===this.enableLoad||!1===this.lib.auth.isEnableCollaboration||!0===this.pause)return t.abrupt("return",!1);t.next=9;break;case 9:!0===this.sectionsData.enableRefresh&&this.loadAnnotation(),this.setRefreshInterval();case 11:case"end":return t.stop()}},t,this)})),function(){return M.apply(this,arguments)}),buildDefaultSectionAnnotation:function(t){var e={type:"SectionMainIdea",anchorPositions:[{type:"section",section_id:t}],notes:[{type:"default",note:""}]};return this.lib.AnnotationHelper.autoComplete(e),e}}};(L=$).methods.setupTutorial=function(){this.lib.auth.isEnableCollaboration?this.setupTutorialCollaborativeReading():this.setupTutorialIndividualReading()},L.methods.setupTutorialCollaborativeReading=function(){var e=this;this.lib.TutorialManager.addAction(function(){var t=h()('[data-section-id].SectionPanel .AnnotationItem[data-user-id!="'.concat(e.status.userID,'"]:visible:first'));return{backgroundFadeOut:!0,element:0<t.length?t.parents(".SectionPanel:first"):h()("[data-section-id].SectionPanel:visible:first"),content:e.$t("You can see others' section main ideas."),scroll:"start",order:21}})},L.methods.setupTutorialIndividualReading=function(){var t=this;this.lib.TutorialManager.addAction({backgroundFadeOut:!0,element:function(){return t.lib.AnnotationPanel.hide(),h()("[data-section-id].SectionPanel:visible:first")},content:this.$t("After reading a section of the article, you have to finish the section checklist."),scroll:"start",order:51}),this.lib.TutorialManager.addAction({element:function(){return h()("[data-section-id].SectionPanel:visible:last")},content:this.$t("When you finish all section checklists, you will go to next step."),scroll:"start",order:52})};var B=$,W=(n(597),n(599)),F=Object(m.a)(B,i,[],!1,null,"dbc0b1c6",null);"function"==typeof W.default&&Object(W.default)(F),F.options.__file="webpack-app/client/Reading/components/annotation/SectionManager/SectionManager.vue";e.default=F.exports},,function(t,e,n){"use strict";n.r(e);function i(){var t=this.$createElement;return(this._self._c||t)("fragment")}i._withStripped=!0;var o=n(4),yt=n.n(o),a="object",s="function",r="undefined",c=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],l=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],u=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],h=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function d(t,e){var n=yt()(t[e]);return n==s||!(n!=a||!t[e])||"unknown"==n}function f(t,e){return!(yt()(t[e])!=a||!t[e])}function p(t,e){return yt()(t[e])!=r}function g(i){return function(t,e){for(var n=e.length;n--;)if(!i(t,e[n]))return!1;return!0}}var m=g(d),v=g(f),b=g(p);function y(t){return t&&m(t,h)&&b(t,u)}function C(t){return f(t,"body")?t.body:t.getElementsByTagName("body")[0]}var w,A,S=[].forEach?function(t,e){t.forEach(e)}:function(t,e){for(var n=0,i=t.length;n<i;++n)e(t[n],n)},_={},x=("undefined"==typeof window?"undefined":yt()(window))!=r&&("undefined"==typeof document?"undefined":yt()(document))!=r,R={isHostMethod:d,isHostObject:f,isHostProperty:p,areHostMethods:m,areHostObjects:v,areHostProperties:b,isTextRange:y,getBody:C,forEach:S},E={version:"1.3.1-dev",initialized:!1,isBrowser:x,supported:!0,util:R,features:{},modules:_,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:("undefined"==typeof rangyAutoInitialize?"undefined":yt()(rangyAutoInitialize))==r||rangyAutoInitialize}};function T(t){("undefined"==typeof console?"undefined":yt()(console))!=r&&d(console,"log")&&console.log(t)}function k(t,e){x&&e?alert(t):T(t)}function D(t){E.initialized=!0,E.supported=!1,k("Rangy is not supported in this environment. Reason: "+t,E.config.alertOnFail)}E.fail=D,E.warn=function(t){k("Rangy warning: "+t,E.config.alertOnWarn)},!{}.hasOwnProperty?D("hasOwnProperty not supported"):(R.extend=w=function(t,e,n){var i,o;for(var a in e)e.hasOwnProperty(a)&&(i=t[a],o=e[a],n&&null!==i&&"object"==yt()(i)&&null!==o&&"object"==yt()(o)&&w(i,o,!0),t[a]=o);return e.hasOwnProperty("toString")&&(t.toString=e.toString),t},R.createOptions=function(t,e){var n={};return w(n,e),t&&w(n,t),n}),x||D("Rangy can only run in a browser"),function(){var t;if(x){var e=document.createElement("div");e.appendChild(document.createElement("span"));var n=[].slice;try{1==n.call(e.childNodes,0)[0].nodeType&&(t=function(t){return n.call(t,0)})}catch(t){}}t=t||function(t){for(var e=[],n=0,i=t.length;n<i;++n)e[n]=t[n];return e},R.toArray=t}(),x&&(d(document,"addEventListener")?A=function(t,e,n){t.addEventListener(e,n,!1)}:d(document,"attachEvent")?A=function(t,e,n){t.attachEvent("on"+e,n)}:D("Document does not have required addEventListener or attachEvent method"),R.addListener=A);var N=[];function P(t){return t.message||t.description||String(t)}function I(){if(x&&!E.initialized){var t,e=!1,n=!1;d(document,"createRange")&&(t=document.createRange(),m(t,l)&&b(t,c)&&(e=!0));var i=C(document);if(i&&"body"==i.nodeName.toLowerCase())if(i&&d(i,"createTextRange")&&y(t=i.createTextRange())&&(n=!0),e||n){var o;for(var a in E.initialized=!0,E.features={implementsDomRange:e,implementsTextRange:n},_)(o=_[a])instanceof L&&o.init(o,E);for(var s=0,r=N.length;s<r;++s)try{N[s](E)}catch(t){T("Rangy init listener threw an exception. Continuing. Detail: "+P(t))}}else D("Neither Range nor TextRange are available");else D("No body element found")}}function M(t,e,n){n&&(t+=" in module "+n.name),E.warn("DEPRECATED: "+t+" is deprecated. Please use "+e+" instead.")}function O(t,e,n,i){t[e]=function(){return M(e,n,i),t[n].apply(t,R.toArray(arguments))}}R.deprecationNotice=M,R.createAliasForDeprecatedMethod=O,E.init=I,E.addInitListener=function(t){E.initialized?t(E):N.push(t)};var H=[];function L(t,e,n){this.name=t,this.dependencies=e,this.initialized=!1,this.supported=!1,this.initializer=n}function $(e,t,n){var i=new L(e,t,function(t){if(!t.initialized){t.initialized=!0;try{n(E,t),t.supported=!0}catch(t){T("Module '"+e+"' failed to load: "+P(t)),t.stack&&T(t.stack)}}});return _[e]=i}function B(){}E.addShimListener=function(t){H.push(t)},x&&(E.shim=E.createMissingNativeApi=function(t){t=t||window,I();for(var e=0,n=H.length;e<n;++e)H[e](t)},O(E,"createMissingNativeApi","shim")),L.prototype={init:function(){for(var t,e,n=this.dependencies||[],i=0,o=n.length;i<o;++i){if(e=n[i],!((t=_[e])&&t instanceof L))throw new Error("required module '"+e+"' not found");if(t.init(),!t.supported)throw new Error("required module '"+e+"' not supported")}this.initializer(this)},fail:function(t){throw this.initialized=!0,this.supported=!1,new Error(t)},warn:function(t){E.warn("Module "+this.name+": "+t)},deprecationNotice:function(t,e){E.warn("DEPRECATED: "+t+" in module "+this.name+" is deprecated. Please use "+e+" instead")},createError:function(t){return new Error("Error in Rangy "+this.name+" module: "+t)}},E.createModule=function(t){var e,n=$(t,2==arguments.length?(e=arguments[1],[]):(e=arguments[2],arguments[1]),e);E.initialized&&E.supported&&n.init()},E.createCoreModule=function(t,e,n){$(t,e,n)},E.RangePrototype=B,E.rangePrototype=new B,E.selectionPrototype=new function(){},E.createCoreModule("DomUtil",[],function(n,l){var i="undefined",o=n.util,s=o.getBody;o.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||l.fail("document missing a Node creation method"),o.isHostMethod(document,"getElementsByTagName")||l.fail("document missing getElementsByTagName method");var t=document.createElement("div");o.areHostMethods(t,["insertBefore","appendChild","cloneNode"])||l.fail("Incomplete Element implementation"),o.isHostProperty(t,"innerHTML")||l.fail("Element is missing innerHTML property");var e=document.createTextNode("test");o.areHostMethods(e,["splitText","deleteData","insertData","appendData","cloneNode"])||l.fail("Incomplete Text Node implementation");var a=function(t,e){for(var n=t.length;n--;)if(t[n]===e)return!0;return!1};function u(t){for(var e=0;t=t.previousSibling;)++e;return e}function h(t,e){var n,i=[];for(n=t;n;n=n.parentNode)i.push(n);for(n=e;n;n=n.parentNode)if(a(i,n))return n;return null}function r(t,e,n){for(var i=n?e:e.parentNode;i;){if(i===t)return!0;i=i.parentNode}return!1}function d(t,e,n){for(var i,o=n?t:t.parentNode;o;){if((i=o.parentNode)===e)return o;o=i}return null}function c(t){var e=t.nodeType;return 3==e||4==e||8==e}function f(t,e){var n=e.nextSibling,i=e.parentNode;return n?i.insertBefore(t,n):i.appendChild(t),t}function p(t){if(9==t.nodeType)return t;if(yt()(t.ownerDocument)!=i)return t.ownerDocument;if(yt()(t.document)!=i)return t.document;if(t.parentNode)return p(t.parentNode);throw l.createError("getDocument: no document found for node")}function g(t){var e=p(t);if(yt()(e.defaultView)!=i)return e.defaultView;if(yt()(e.parentWindow)!=i)return e.parentWindow;throw l.createError("Cannot get a window object for node")}function m(t){if(yt()(t.contentDocument)!=i)return t.contentDocument;if(yt()(t.contentWindow)!=i)return t.contentWindow.document;throw l.createError("getIframeDocument: No Document object found for iframe element")}function v(t){return t&&o.isHostMethod(t,"setTimeout")&&o.isHostObject(t,"document")}var b,y=!1;function C(t){try{return t.parentNode,!1}catch(t){return!0}}function w(t){if(!t)return"[No node]";if(y&&C(t))return"[Broken node]";if(c(t))return'"'+t.data+'"';if(1!=t.nodeType)return t.nodeName;var e=t.id?' id="'+t.id+'"':"";return"<"+t.nodeName+e+">[index:"+u(t)+",length:"+t.childNodes.length+"]["+(t.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}function A(t){this.root=t,this._next=t}function S(t,e){this.node=t,this.offset=e}function _(t){this.code=this[t],this.codeName=t,this.message="DOMException: "+this.codeName}!function(){var t=document.createElement("b");t.innerHTML="1";var e=t.firstChild;t.innerHTML="<br />",y=C(e),n.features.crashyTextNodes=y}(),yt()(window.getComputedStyle)!=i?b=function(t,e){return g(t).getComputedStyle(t,null)[e]}:yt()(document.documentElement.currentStyle)!=i?b=function(t,e){return t.currentStyle?t.currentStyle[e]:""}:l.fail("No means of obtaining computed style properties found"),A.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var t,e,n=this._current=this._next;if(this._current)if(t=n.firstChild)this._next=t;else{for(e=null;n!==this.root&&!(e=n.nextSibling);)n=n.parentNode;this._next=e}return this._current},detach:function(){this._current=this._next=this.root=null}},S.prototype={equals:function(t){return!!t&&this.node===t.node&&this.offset==t.offset},inspect:function(){return"[DomPosition("+w(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},(_.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24}).toString=function(){return this.message},n.dom={arrayContains:a,isHtmlNamespace:function(t){var e;return yt()(t.namespaceURI)==i||null===(e=t.namespaceURI)||"http://www.w3.org/1999/xhtml"==e},parentElement:function(t){var e=t.parentNode;return 1==e.nodeType?e:null},getNodeIndex:u,getNodeLength:function(t){switch(t.nodeType){case 7:case 10:return 0;case 3:case 8:return t.length;default:return t.childNodes.length}},getCommonAncestor:h,isAncestorOf:r,isOrIsAncestorOf:function(t,e){return r(t,e,!0)},getClosestAncestorIn:d,isCharacterDataNode:c,isTextOrCommentNode:function(t){if(!t)return!1;var e=t.nodeType;return 3==e||8==e},insertAfter:f,splitDataNode:function(t,e,n){var i=t.cloneNode(!1);if(i.deleteData(0,e),t.deleteData(e,t.length-e),f(i,t),n)for(var o,a=0;o=n[a++];)o.node==t&&o.offset>e?(o.node=i,o.offset-=e):o.node==t.parentNode&&o.offset>u(t)&&++o.offset;return i},getDocument:p,getWindow:g,getIframeWindow:function(t){if(yt()(t.contentWindow)!=i)return t.contentWindow;if(yt()(t.contentDocument)!=i)return t.contentDocument.defaultView;throw l.createError("getIframeWindow: No Window object found for iframe element")},getIframeDocument:m,getBody:s,isWindow:v,getContentDocument:function(t,e,n){var i;if(t?o.isHostProperty(t,"nodeType")?i=1==t.nodeType&&"iframe"==t.tagName.toLowerCase()?m(t):p(t):v(t)&&(i=t.document):i=document,!i)throw e.createError(n+"(): Parameter must be a Window object or DOM node");return i},getRootContainer:function(t){for(var e;e=t.parentNode;)t=e;return t},comparePoints:function(t,e,n,i){var o,a,s,r,c;if(t==n)return e===i?0:e<i?-1:1;if(o=d(n,t,!0))return e<=u(o)?-1:1;if(o=d(t,n,!0))return u(o)<i?-1:1;if(!(a=h(t,n)))throw new Error("comparePoints error: nodes have no common ancestor");if((s=t===a?a:d(t,a,!0))===(r=n===a?a:d(n,a,!0)))throw l.createError("comparePoints got to case 4 and childA and childB are the same!");for(c=a.firstChild;c;){if(c===s)return-1;if(c===r)return 1;c=c.nextSibling}},isBrokenNode:C,inspectNode:w,getComputedStyleProperty:b,createTestElement:function(t,e,n){var i=s(t),o=t.createElement("div");o.contentEditable=""+!!n,e&&(o.innerHTML=e);var a=i.firstChild;return a?i.insertBefore(o,a):i.appendChild(o),o},removeNode:function(t){return t.parentNode.removeChild(t)},fragmentFromNodeChildren:function(t){for(var e,n=p(t).createDocumentFragment();e=t.firstChild;)n.appendChild(e);return n},createIterator:function(t){return new A(t)},DomPosition:S},n.DOMException=_}),E.createCoreModule("DomRange",["DomUtil"],function(s,t){var r=s.dom,i=s.util,e=r.DomPosition,c=s.DOMException,h=r.isCharacterDataNode,d=r.getNodeIndex,l=r.isOrIsAncestorOf,o=r.getDocument,f=r.comparePoints,u=r.splitDataNode,p=r.getClosestAncestorIn,g=r.getNodeLength,a=r.arrayContains,m=r.getRootContainer,n=s.features.crashyTextNodes,v=r.removeNode;function b(t,e){return 3!=t.nodeType&&(l(t,e.startContainer)||l(t,e.endContainer))}function y(t){return t.document||o(t.startContainer)}function C(t){return new e(t.parentNode,d(t))}function w(t){return new e(t.parentNode,d(t)+1)}function A(t,e,n){var i=11==t.nodeType?t.firstChild:t;return h(e)?n==e.length?r.insertAfter(t,e):e.parentNode.insertBefore(t,0==n?e:u(e,n)):n>=e.childNodes.length?e.appendChild(t):e.insertBefore(t,e.childNodes[n]),i}function S(t,e,n){if(z(t),z(e),y(e)!=y(t))throw new c("WRONG_DOCUMENT_ERR");var i=f(t.startContainer,t.startOffset,e.endContainer,e.endOffset),o=f(t.endContainer,t.endOffset,e.startContainer,e.startOffset);return n?i<=0&&0<=o:i<0&&0<o}function _(t,e,n){var i,o,a,s;for(n=n||{stop:!1};a=t.next();)if(t.isPartiallySelectedSubtree()){if(!1===e(a))return void(n.stop=!0);if(_(s=t.getSubtreeIterator(),e,n),s.detach(),n.stop)return}else for(i=r.createIterator(a);o=i.next();)if(!1===e(o))return void(n.stop=!0)}function x(t){for(var e;t.next();)t.isPartiallySelectedSubtree()?(x(e=t.getSubtreeIterator()),e.detach()):t.remove()}function R(t){for(var e,n,i=y(t.range).createDocumentFragment();e=t.next();){if(t.isPartiallySelectedSubtree()?(e=e.cloneNode(!1),n=t.getSubtreeIterator(),e.appendChild(R(n)),n.detach()):t.remove(),10==e.nodeType)throw new c("HIERARCHY_REQUEST_ERR");i.appendChild(e)}return i}function E(t){return"["+(void 0===t.getName?"Range":t.getName())+"("+r.inspectNode(t.startContainer)+":"+t.startOffset+", "+r.inspectNode(t.endContainer)+":"+t.endOffset+")]"}function T(t,e){if(this.range=t,this.clonePartiallySelectedTextNodes=e,!t.collapsed){this.sc=t.startContainer,this.so=t.startOffset,this.ec=t.endContainer,this.eo=t.endOffset;var n=t.commonAncestorContainer;this.sc===this.ec&&h(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||h(this.sc)?p(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||h(this.ec)?p(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}T.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var t=this._current=this._next;return t&&(this._next=t!==this._last?t.nextSibling:null,h(t)&&this.clonePartiallySelectedTextNodes&&(t===this.ec&&(t=t.cloneNode(!0)).deleteData(this.eo,t.length-this.eo),this._current===this.sc&&(t=t.cloneNode(!0)).deleteData(0,this.so))),t},remove:function(){var t,e,n=this._current;!h(n)||n!==this.sc&&n!==this.ec?n.parentNode&&v(n):(t=n===this.sc?this.so:0)!=(e=n===this.ec?this.eo:n.length)&&n.deleteData(t,e-t)},isPartiallySelectedSubtree:function(){return b(this._current,this.range)},getSubtreeIterator:function(){var t;if(this.isSingleCharacterDataNode)(t=this.range.cloneRange()).collapse(!1);else{t=new dt(y(this.range));var e=this._current,n=e,i=0,o=e,a=g(e);l(e,this.sc)&&(n=this.sc,i=this.so),l(e,this.ec)&&(o=this.ec,a=this.eo),ht(t,n,i,o,a)}return new T(t,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var k=[1,3,4,5,7,8,10],D=[2,9,11],N=[1,3,4,5,7,8,10,11],P=[1,3,4,5,7,8];function I(o){return function(t,e){for(var n,i=e?t:t.parentNode;i;){if(n=i.nodeType,a(o,n))return i;i=i.parentNode}return null}}var M=I([9,11]),O=I([5,6,10,12]),H=I([6,10,12]);function L(t,e){if(H(t,e))throw new c("INVALID_NODE_TYPE_ERR")}function $(t,e){if(!a(e,t.nodeType))throw new c("INVALID_NODE_TYPE_ERR")}function B(t,e){if(e<0||e>(h(t)?t.length:t.childNodes.length))throw new c("INDEX_SIZE_ERR")}function W(t,e){if(M(t,!0)!==M(e,!0))throw new c("WRONG_DOCUMENT_ERR")}function F(t){if(O(t,!0))throw new c("NO_MODIFICATION_ALLOWED_ERR")}function q(t,e){if(!t)throw new c(e)}function j(t,e){return e<=(h(t)?t.length:t.childNodes.length)}function U(t){return!!t.startContainer&&!!t.endContainer&&!(n&&(r.isBrokenNode(t.startContainer)||r.isBrokenNode(t.endContainer)))&&m(t.startContainer)==m(t.endContainer)&&j(t.startContainer,t.startOffset)&&j(t.endContainer,t.endOffset)}function z(t){if(!U(t))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+t.inspect()+")")}var X=document.createElement("style"),Q=!1;try{X.innerHTML="<b>x</b>",Q=3==X.firstChild.nodeType}catch(t){}var V=(s.features.htmlParsingConforms=Q)?function(t){var e=this.startContainer,n=o(e);if(!e)throw new c("INVALID_STATE_ERR");var i=null;return 1==e.nodeType?i=e:h(e)&&(i=r.parentElement(e)),(i=null===i||"HTML"==i.nodeName&&r.isHtmlNamespace(o(i).documentElement)&&r.isHtmlNamespace(i)?n.createElement("body"):i.cloneNode(!1)).innerHTML=t,r.fragmentFromNodeChildren(i)}:function(t){var e=y(this).createElement("body");return e.innerHTML=t,r.fragmentFromNodeChildren(e)};function G(t,e){z(t);var n=t.startContainer,i=t.startOffset,o=t.endContainer,a=t.endOffset,s=n===o;h(o)&&0<a&&a<o.length&&u(o,a,e),h(n)&&0<i&&i<n.length&&(n=u(n,i,e),s?(a-=i,o=n):o==n.parentNode&&a>=d(n)&&a++,i=0),t.setStartAndEnd(n,i,o,a)}function Y(t){z(t);var e=t.commonAncestorContainer.parentNode.cloneNode(!1);return e.appendChild(t.cloneContents()),e.innerHTML}var K=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],J=0,Z=1,tt=2,et=3,nt=0,it=1,ot=2,at=3;function st(t){t.START_TO_START=J,t.START_TO_END=Z,t.END_TO_END=tt,t.END_TO_START=et,t.NODE_BEFORE=nt,t.NODE_AFTER=it,t.NODE_BEFORE_AND_AFTER=ot,t.NODE_INSIDE=at}function rt(t){st(t),st(t.prototype)}function ct(s,r){return function(){z(this);var t,e=this.startContainer,n=this.startOffset,i=this.commonAncestorContainer,o=new T(this,!0);e!==i&&(e=(t=w(p(e,i,!0))).node,n=t.offset),_(o,F),o.reset();var a=s(o);return o.detach(),r(this,e,n,e,n),a}}function lt(t,u){function e(n,i){return function(t){$(t,k),$(m(t),D);var e=(n?C:w)(t);(i?o:a)(this,e.node,e.offset)}}function o(t,e,n){var i=t.endContainer,o=t.endOffset;e===t.startContainer&&n===t.startOffset||(m(e)==m(i)&&1!=f(e,n,i,o)||(i=e,o=n),u(t,e,n,i,o))}function a(t,e,n){var i=t.startContainer,o=t.startOffset;e===t.endContainer&&n===t.endOffset||(m(e)==m(i)&&-1!=f(e,n,i,o)||(i=e,o=n),u(t,i,o,e,n))}function n(){}n.prototype=s.rangePrototype,t.prototype=new n,i.extend(t.prototype,{setStart:function(t,e){L(t,!0),B(t,e),o(this,t,e)},setEnd:function(t,e){L(t,!0),B(t,e),a(this,t,e)},setStartAndEnd:function(){var t=arguments,e=t[0],n=t[1],i=e,o=n;switch(t.length){case 3:o=t[2];break;case 4:i=t[2],o=t[3]}u(this,e,n,i,o)},setBoundary:function(t,e,n){this["set"+(n?"Start":"End")](t,e)},setStartBefore:e(!0,!0),setStartAfter:e(!1,!0),setEndBefore:e(!0,!1),setEndAfter:e(!1,!1),collapse:function(t){z(this),t?u(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):u(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(t){L(t,!0),u(this,t,0,t,g(t))},selectNode:function(t){L(t,!1),$(t,k);var e=C(t),n=w(t);u(this,e.node,e.offset,n.node,n.offset)},extractContents:ct(R,u),deleteContents:ct(x,u),canSurroundContents:function(){z(this),F(this.startContainer),F(this.endContainer);var t=new T(this,!0),e=t._first&&b(t._first,this)||t._last&&b(t._last,this);return t.detach(),!e},splitBoundaries:function(){G(this)},splitBoundariesPreservingPositions:function(t){G(this,t)},normalizeBoundaries:function(){z(this);function t(t){var e=t.nextSibling;e&&e.nodeType==t.nodeType&&(r=(s=t).length,t.appendData(e.data),v(e))}function e(t){var e=t.previousSibling;if(e&&e.nodeType==t.nodeType){var n=(o=t).length;if(a=e.length,t.insertData(0,e.data),v(e),o==s)r+=a,s=o;else if(s==t.parentNode){var i=d(t);r==i?(s=t,r=n):i<r&&r--}}}var n,o=this.startContainer,a=this.startOffset,s=this.endContainer,r=this.endOffset,i=!0;if(h(s))r==s.length?t(s):0==r&&(n=s.previousSibling)&&n.nodeType==s.nodeType&&(r=n.length,o==s&&(i=!1),n.appendData(s.data),v(s),s=n);else{if(0<r){var c=s.childNodes[r-1];c&&h(c)&&t(c)}i=!this.collapsed}if(i){if(h(o))0==a?e(o):a==o.length&&(n=o.nextSibling)&&n.nodeType==o.nodeType&&(s==n&&(r+=(s=o).length),o.appendData(n.data),v(n));else if(a<o.childNodes.length){var l=o.childNodes[a];l&&h(l)&&e(l)}}else o=s,a=r;u(this,o,a,s,r)},collapseToPoint:function(t,e){L(t,!0),B(t,e),this.setStartAndEnd(t,e)}}),rt(t)}function ut(t){t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset,t.commonAncestorContainer=t.collapsed?t.startContainer:r.getCommonAncestor(t.startContainer,t.endContainer)}function ht(t,e,n,i,o){t.startContainer=e,t.startOffset=n,t.endContainer=i,t.endOffset=o,t.document=r.getDocument(e),ut(t)}function dt(t){this.startContainer=t,this.startOffset=0,this.endContainer=t,this.endOffset=0,this.document=t,ut(this)}i.extend(s.rangePrototype,{compareBoundaryPoints:function(t,e){var n,i,o,a;z(this),W(this.startContainer,e.startContainer);var s=t==et||t==J?"start":"end",r=t==Z||t==J?"start":"end";return n=this[s+"Container"],i=this[s+"Offset"],o=e[r+"Container"],a=e[r+"Offset"],f(n,i,o,a)},insertNode:function(t){if(z(this),$(t,N),F(this.startContainer),l(t,this.startContainer))throw new c("HIERARCHY_REQUEST_ERR");var e=A(t,this.startContainer,this.startOffset);this.setStartBefore(e)},cloneContents:function(){var t,e;if(z(this),this.collapsed)return y(this).createDocumentFragment();if(this.startContainer===this.endContainer&&h(this.startContainer))return(t=this.startContainer.cloneNode(!0)).data=t.data.slice(this.startOffset,this.endOffset),(e=y(this).createDocumentFragment()).appendChild(t),e;var n=new T(this,!0);return t=function t(e){for(var n,i,o,a=y(e.range).createDocumentFragment();i=e.next();){if(n=e.isPartiallySelectedSubtree(),i=i.cloneNode(!n),n&&(o=e.getSubtreeIterator(),i.appendChild(t(o)),o.detach()),10==i.nodeType)throw new c("HIERARCHY_REQUEST_ERR");a.appendChild(i)}return a}(n),n.detach(),t},canSurroundContents:function(){z(this),F(this.startContainer),F(this.endContainer);var t=new T(this,!0),e=t._first&&b(t._first,this)||t._last&&b(t._last,this);return t.detach(),!e},surroundContents:function(t){if($(t,P),!this.canSurroundContents())throw new c("INVALID_STATE_ERR");var e=this.extractContents();if(t.hasChildNodes())for(;t.lastChild;)t.removeChild(t.lastChild);A(t,this.startContainer,this.startOffset),t.appendChild(e),this.selectNode(t)},cloneRange:function(){z(this);for(var t,e=new dt(y(this)),n=K.length;n--;)e[t=K[n]]=this[t];return e},toString:function(){z(this);var t=this.startContainer;if(t===this.endContainer&&h(t))return 3==t.nodeType||4==t.nodeType?t.data.slice(this.startOffset,this.endOffset):"";var e=[],n=new T(this,!0);return _(n,function(t){3!=t.nodeType&&4!=t.nodeType||e.push(t.data)}),n.detach(),e.join("")},compareNode:function(t){z(this);var e=t.parentNode,n=d(t);if(!e)throw new c("NOT_FOUND_ERR");var i=this.comparePoint(e,n),o=this.comparePoint(e,n+1);return i<0?0<o?ot:nt:0<o?it:at},comparePoint:function(t,e){return z(this),q(t,"HIERARCHY_REQUEST_ERR"),W(t,this.startContainer),f(t,e,this.startContainer,this.startOffset)<0?-1:0<f(t,e,this.endContainer,this.endOffset)?1:0},createContextualFragment:V,toHtml:function(){return Y(this)},intersectsNode:function(t,e){if(z(this),m(t)!=function(t){return m(t.startContainer)}(this))return!1;var n=t.parentNode,i=d(t);if(!n)return!0;var o=f(n,i,this.endContainer,this.endOffset),a=f(n,i+1,this.startContainer,this.startOffset);return e?o<=0&&0<=a:o<0&&0<a},isPointInRange:function(t,e){return z(this),q(t,"HIERARCHY_REQUEST_ERR"),W(t,this.startContainer),0<=f(t,e,this.startContainer,this.startOffset)&&f(t,e,this.endContainer,this.endOffset)<=0},intersectsRange:function(t){return S(this,t,!1)},intersectsOrTouchesRange:function(t){return S(this,t,!0)},intersection:function(t){if(this.intersectsRange(t)){var e=f(this.startContainer,this.startOffset,t.startContainer,t.startOffset),n=f(this.endContainer,this.endOffset,t.endContainer,t.endOffset),i=this.cloneRange();return-1==e&&i.setStart(t.startContainer,t.startOffset),1==n&&i.setEnd(t.endContainer,t.endOffset),i}return null},union:function(t){if(this.intersectsOrTouchesRange(t)){var e=this.cloneRange();return-1==f(t.startContainer,t.startOffset,this.startContainer,this.startOffset)&&e.setStart(t.startContainer,t.startOffset),1==f(t.endContainer,t.endOffset,this.endContainer,this.endOffset)&&e.setEnd(t.endContainer,t.endOffset),e}throw new c("Ranges do not intersect")},containsNode:function(t,e){return e?this.intersectsNode(t,!1):this.compareNode(t)==at},containsNodeContents:function(t){return 0<=this.comparePoint(t,0)&&this.comparePoint(t,g(t))<=0},containsRange:function(t){var e=this.intersection(t);return null!==e&&t.equals(e)},containsNodeText:function(t){var e=this.cloneRange();e.selectNode(t);var n=e.getNodes([3]);if(0<n.length){e.setStart(n[0],0);var i=n.pop();return e.setEnd(i,i.length),this.containsRange(e)}return this.containsNodeContents(t)},getNodes:function(t,e){return z(this),function(i,t,o){var a,s=!(!t||!t.length),r=!!o;s&&(a=new RegExp("^("+t.join("|")+")$"));var c=[];return _(new T(i,!1),function(t){if((!s||a.test(t.nodeType))&&(!r||o(t))){var e=i.startContainer;if(t!=e||!h(e)||i.startOffset!=e.length){var n=i.endContainer;t==n&&h(n)&&0==i.endOffset||c.push(t)}}}),c}(this,t,e)},getDocument:function(){return y(this)},collapseBefore:function(t){this.setEndBefore(t),this.collapse(!1)},collapseAfter:function(t){this.setStartAfter(t),this.collapse(!0)},getBookmark:function(t){var e=y(this),n=s.createRange(e);t=t||r.getBody(e),n.selectNodeContents(t);var i=this.intersection(n),o=0,a=0;return i&&(n.setEnd(i.startContainer,i.startOffset),a=(o=n.toString().length)+i.toString().length),{start:o,end:a,containerNode:t}},moveToBookmark:function(t){var e=t.containerNode,n=0;this.setStart(e,0),this.collapse(!0);for(var i,o,a,s,r=[e],c=!1,l=!1;!l&&(i=r.pop());)if(3===i.nodeType)o=n+i.length,!c&&t.start>=n&&t.start<=o&&(this.setStart(i,t.start-n),c=!0),c&&t.end>=n&&t.end<=o&&(this.setEnd(i,t.end-n),l=!0),n=o;else for(a=(s=i.childNodes).length;a--;)r.push(s[a])},getName:function(){return"DomRange"},equals:function(t){return dt.rangesEqual(this,t)},isValid:function(){return U(this)},inspect:function(){return E(this)},detach:function(){}}),lt(dt,ht),i.extend(dt,{rangeProperties:K,RangeIterator:T,copyComparisonConstants:rt,createPrototypeRange:lt,inspect:E,toHtml:Y,getRangeDocument:y,rangesEqual:function(t,e){return t.startContainer===e.startContainer&&t.startOffset===e.startOffset&&t.endContainer===e.endContainer&&t.endOffset===e.endOffset}}),s.DomRange=dt}),E.createCoreModule("WrappedRange",["DomRange"],function(u,h){var d,t,A=u.dom,f=u.util,S=A.DomPosition,p=u.DomRange,g=A.getBody,m=A.getContentDocument,_=A.isCharacterDataNode;if(u.features.implementsDomRange&&function(){var e,n,i=p.rangeProperties;function o(t){for(var e,n=i.length;n--;)t[e=i[n]]=t.nativeRange[e];t.collapsed=t.startContainer===t.endContainer&&t.startOffset===t.endOffset}d=function(t){if(!t)throw h.createError("WrappedRange: Range must be specified");this.nativeRange=t,o(this)},p.createPrototypeRange(d,function(t,e,n,i,o){var a=t.startContainer!==e||t.startOffset!=n,s=t.endContainer!==i||t.endOffset!=o,r=!t.equals(t.nativeRange);(a||s||r)&&(t.setEnd(i,o),t.setStart(e,n))}),(e=d.prototype).selectNode=function(t){this.nativeRange.selectNode(t),o(this)},e.cloneContents=function(){return this.nativeRange.cloneContents()},e.surroundContents=function(t){this.nativeRange.surroundContents(t),o(this)},e.collapse=function(t){this.nativeRange.collapse(t),o(this)},e.cloneRange=function(){return new d(this.nativeRange.cloneRange())},e.refresh=function(){o(this)},e.toString=function(){return this.nativeRange.toString()};var t=document.createTextNode("test");g(document).appendChild(t);var a=document.createRange();a.setStart(t,0),a.setEnd(t,0);try{a.setStart(t,1),e.setStart=function(t,e){this.nativeRange.setStart(t,e),o(this)},e.setEnd=function(t,e){this.nativeRange.setEnd(t,e),o(this)},n=function(e){return function(t){this.nativeRange[e](t),o(this)}}}catch(t){e.setStart=function(e,n){try{this.nativeRange.setStart(e,n)}catch(t){this.nativeRange.setEnd(e,n),this.nativeRange.setStart(e,n)}o(this)},e.setEnd=function(e,n){try{this.nativeRange.setEnd(e,n)}catch(t){this.nativeRange.setStart(e,n),this.nativeRange.setEnd(e,n)}o(this)},n=function(n,i){return function(e){try{this.nativeRange[n](e)}catch(t){this.nativeRange[i](e),this.nativeRange[n](e)}o(this)}}}e.setStartBefore=n("setStartBefore","setEndBefore"),e.setStartAfter=n("setStartAfter","setEndAfter"),e.setEndBefore=n("setEndBefore","setStartBefore"),e.setEndAfter=n("setEndAfter","setStartAfter"),e.selectNodeContents=function(t){this.setStartAndEnd(t,0,A.getNodeLength(t))},a.selectNodeContents(t),a.setEnd(t,3);var s=document.createRange();s.selectNodeContents(t),s.setEnd(t,4),s.setStart(t,2),-1==a.compareBoundaryPoints(a.START_TO_END,s)&&1==a.compareBoundaryPoints(a.END_TO_START,s)?e.compareBoundaryPoints=function(t,e){return t==(e=e.nativeRange||e).START_TO_END?t=e.END_TO_START:t==e.END_TO_START&&(t=e.START_TO_END),this.nativeRange.compareBoundaryPoints(t,e)}:e.compareBoundaryPoints=function(t,e){return this.nativeRange.compareBoundaryPoints(t,e.nativeRange||e)};var r=document.createElement("div");r.innerHTML="123";var c=r.firstChild,l=g(document);l.appendChild(r),a.setStart(c,1),a.setEnd(c,2),a.deleteContents(),"13"==c.data&&(e.deleteContents=function(){this.nativeRange.deleteContents(),o(this)},e.extractContents=function(){var t=this.nativeRange.extractContents();return o(this),t}),l.removeChild(r),l=null,f.isHostMethod(a,"createContextualFragment")&&(e.createContextualFragment=function(t){return this.nativeRange.createContextualFragment(t)}),g(document).removeChild(t),e.getName=function(){return"WrappedRange"},u.WrappedRange=d,u.createNativeRange=function(t){return(t=m(t,h,"createNativeRange")).createRange()}}(),u.features.implementsTextRange){var o=function(t,e,n,i,o){var a=t.duplicate();a.collapse(n);var s=a.parentElement();if(A.isOrIsAncestorOf(e,s)||(s=e),!s.canHaveHTML){var r=new S(s.parentNode,A.getNodeIndex(s));return{boundaryPosition:r,nodeInfo:{nodeIndex:r.offset,containerElement:r.node}}}var c=A.getDocument(s).createElement("span");c.parentNode&&A.removeNode(c);for(var l,u,h,d,f,p=n?"StartToStart":"StartToEnd",g=o&&o.containerElement==s?o.nodeIndex:0,m=s.childNodes.length,v=m,b=v;b==m?s.appendChild(c):s.insertBefore(c,s.childNodes[b]),a.moveToElementText(c),0!=(l=a.compareEndPoints(p,t))&&g!=v;){if(-1==l){if(v==g+1)break;g=b}else v=v==g+1?g:b;b=Math.floor((g+v)/2),s.removeChild(c)}if(f=c.nextSibling,-1==l&&f&&_(f)){var y;if(a.setEndPoint(n?"EndToStart":"EndToEnd",t),/[\r\n]/.test(f.data)){var C=a.duplicate(),w=C.text.replace(/\r\n/g,"\r").length;for(y=C.moveStart("character",w);-1==(l=C.compareEndPoints("StartToEnd",C));)y++,C.moveStart("character",1)}else y=a.text.length;d=new S(f,y)}else u=(i||!n)&&c.previousSibling,d=(h=(i||n)&&c.nextSibling)&&_(h)?new S(h,0):u&&_(u)?new S(u,u.data.length):new S(s,A.getNodeIndex(c));return A.removeNode(c),{boundaryPosition:d,nodeInfo:{nodeIndex:b,containerElement:s}}},a=function(t,e){var n,i,o,a,s=t.offset,r=A.getDocument(t.node),c=g(r).createTextRange(),l=_(t.node);return i=l?(n=t.node).parentNode:(n=s<(a=t.node.childNodes).length?a[s]:null,t.node),(o=r.createElement("span")).innerHTML="&#feff;",n?i.insertBefore(o,n):i.appendChild(o),c.moveToElementText(o),c.collapse(!e),i.removeChild(o),l&&c[e?"moveStart":"moveEnd"]("character",s),c};((t=function(t){this.textRange=t,this.refresh()}).prototype=new p(document)).refresh=function(){var t,e,n,i=function(t){var e=t.parentElement(),n=t.duplicate();n.collapse(!0);var i=n.parentElement();(n=t.duplicate()).collapse(!1);var o=n.parentElement(),a=i==o?i:A.getCommonAncestor(i,o);return a==e?a:A.getCommonAncestor(e,a)}(this.textRange);e=function(t){return 0==t.compareEndPoints("StartToEnd",t)}(this.textRange)?t=o(this.textRange,i,!0,!0).boundaryPosition:(t=(n=o(this.textRange,i,!0,!1)).boundaryPosition,o(this.textRange,i,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(t.node,t.offset),this.setEnd(e.node,e.offset)},t.prototype.getName=function(){return"WrappedTextRange"},p.copyComparisonConstants(t);var e=function(t){if(t.collapsed)return a(new S(t.startContainer,t.startOffset),!0);var e=a(new S(t.startContainer,t.startOffset),!0),n=a(new S(t.endContainer,t.endOffset),!1),i=g(p.getRangeDocument(t)).createTextRange();return i.setEndPoint("StartToStart",e),i.setEndPoint("EndToEnd",n),i};if(t.rangeToTextRange=e,t.prototype.toTextRange=function(){return e(this)},u.WrappedTextRange=t,!u.features.implementsDomRange||u.config.preferTextRange){var n=Function("return this;")();void 0===n.Range&&(n.Range=t),u.createNativeRange=function(t){return t=m(t,h,"createNativeRange"),g(t).createTextRange()},u.WrappedRange=t}}u.createRange=function(t){return t=m(t,h,"createRange"),new u.WrappedRange(u.createNativeRange(t))},u.createRangyRange=function(t){return t=m(t,h,"createRangyRange"),new p(t)},f.createAliasForDeprecatedMethod(u,"createIframeRange","createRange"),f.createAliasForDeprecatedMethod(u,"createIframeRangyRange","createRangyRange"),u.addShimListener(function(t){var e=t.document;void 0===e.createRange&&(e.createRange=function(){return u.createRange(e)}),e=t=null})}),E.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(h,c){h.config.checkSelectionRanges=!0;var o,a,t="boolean",e="number",d=h.dom,n=h.util,i=n.isHostMethod,r=h.DomRange,s=h.WrappedRange,l=h.DOMException,u=d.DomPosition,f=h.features,p="Control",g=d.getDocument,m=d.getBody,v=r.rangesEqual;function b(t){return"string"==typeof t?/^backward(s)?$/i.test(t):!!t}function y(t,e){if(t){if(d.isWindow(t))return t;if(t instanceof z)return t.win;var n=d.getContentDocument(t,c,e);return d.getWindow(n)}return window}function C(t){return y(t,"getDocSelection").document.selection}function w(t){var e=!1;return t.anchorNode&&(e=1==d.comparePoints(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)),e}var A=i(window,"getSelection"),S=n.isHostObject(document,"selection");f.implementsWinGetSelection=A;var _=(f.implementsDocSelection=S)&&(!A||h.config.preferTextRange);if(_)o=C,h.isSelectionValid=function(t){var e=y(t,"isSelectionValid").document,n=e.selection;return"None"!=n.type||g(n.createRange().parentElement())==e};else{if(!A)return c.fail("Neither document.selection or window.getSelection() detected."),!1;o=function(t){return y(t,"getWinSelection").getSelection()},h.isSelectionValid=function(){return!0}}var x=(h.getNativeSelection=o)();if(!x)return c.fail("Native selection was null (possibly issue 138?)"),!1;var R=h.createNativeRange(document),E=m(document),T=n.areHostProperties(x,["anchorNode","focusNode","anchorOffset","focusOffset"]);f.selectionHasAnchorAndFocus=T;var k=i(x,"extend");f.selectionHasExtend=k;var D=yt()(x.rangeCount)==e;f.selectionHasRangeCount=D;var N=!1,P=!0,I=k?function(t,e){var n=r.getRangeDocument(e),i=h.createRange(n);i.collapseToPoint(e.endContainer,e.endOffset),t.addRange(B(i)),t.extend(e.startContainer,e.startOffset)}:null;n.areHostMethods(x,["addRange","getRangeAt","removeAllRanges"])&&yt()(x.rangeCount)==e&&f.implementsDomRange&&function(){var t=window.getSelection();if(t){for(var e=t.rangeCount,n=1<e,i=[],o=w(t),a=0;a<e;++a)i[a]=t.getRangeAt(a);var s=d.createTestElement(document,"",!1),r=s.appendChild(document.createTextNode("   ")),c=document.createRange();if(c.setStart(r,1),c.collapse(!0),t.removeAllRanges(),t.addRange(c),P=1==t.rangeCount,t.removeAllRanges(),!n){var l=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(l&&36<=parseInt(l[1]))N=!1;else{var u=c.cloneRange();c.setStart(r,0),u.setEnd(r,3),u.setStart(r,2),t.addRange(c),t.addRange(u),N=2==t.rangeCount}}for(d.removeNode(s),t.removeAllRanges(),a=0;a<e;++a)0==a&&o?I?I(t,i[a]):(h.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),t.addRange(i[a])):t.addRange(i[a])}}(),f.selectionSupportsMultipleRanges=N,f.collapsedNonEditableSelectionsSupported=P;var M,O,H=!1;function L(t,e,n){var i=n?"end":"start",o=n?"start":"end";t.anchorNode=e[i+"Container"],t.anchorOffset=e[i+"Offset"],t.focusNode=e[o+"Container"],t.focusOffset=e[o+"Offset"]}function $(t){t.anchorNode=t.focusNode=null,t.anchorOffset=t.focusOffset=0,t.rangeCount=0,t.isCollapsed=!0,t._ranges.length=0}function B(t){var e;return t instanceof r?((e=h.createNativeRange(t.getDocument())).setEnd(t.endContainer,t.endOffset),e.setStart(t.startContainer,t.startOffset)):t instanceof s?e=t.nativeRange:f.implementsDomRange&&t instanceof d.getWindow(t.startContainer).Range&&(e=t),e}function W(t){var e=t.getNodes();if(!function(t){if(!t.length||1!=t[0].nodeType)return!1;for(var e=1,n=t.length;e<n;++e)if(!d.isAncestorOf(t[0],t[e]))return!1;return!0}(e))throw c.createError("getSingleElementFromRange: range "+t.inspect()+" did not consist of a single element");return e[0]}function F(t){return!!t&&void 0!==t.text}function q(t,e){var n=new s(e);t._ranges=[n],L(t,n,!1),t.rangeCount=1,t.isCollapsed=n.collapsed}function j(t){if(t._ranges.length=0,"None"==t.docSelection.type)$(t);else{var e=t.docSelection.createRange();if(F(e))q(t,e);else{t.rangeCount=e.length;for(var n,i=g(e.item(0)),o=0;o<t.rangeCount;++o)(n=h.createRange(i)).selectNode(e.item(o)),t._ranges.push(n);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,L(t,t._ranges[t.rangeCount-1],!1)}}}function U(t,e){for(var n=t.docSelection.createRange(),i=W(e),o=g(n.item(0)),a=m(o).createControlRange(),s=0,r=n.length;s<r;++s)a.add(n.item(s));try{a.add(i)}catch(t){throw c.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}a.select(),j(t)}function z(t,e,n){this.nativeSelection=t,this.docSelection=e,this._ranges=[],this.win=n,this.refresh()}function X(t){t.win=t.anchorNode=t.focusNode=t._ranges=null,t.rangeCount=t.anchorOffset=t.focusOffset=0,t.detached=!0}E&&i(E,"createControlRange")&&(M=E.createControlRange(),n.areHostProperties(M,["item","add"])&&(H=!0)),f.implementsControlRange=H,a=T?function(t){return t.anchorNode===t.focusNode&&t.anchorOffset===t.focusOffset}:function(t){return!!t.rangeCount&&t.getRangeAt(t.rangeCount-1).collapsed},i(x,"getRangeAt")?O=function(t,e){try{return t.getRangeAt(e)}catch(t){return null}}:T&&(O=function(t){var e=g(t.anchorNode),n=h.createRange(e);return n.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),n.collapsed!==this.isCollapsed&&n.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),n}),z.prototype=h.selectionPrototype;var Q=[];function V(t,e){for(var n,i,o=Q.length;o--;)if(i=(n=Q[o]).selection,"deleteAll"==e)X(i);else if(n.win==t)return"delete"==e?(Q.splice(o,1),!0):i;return"deleteAll"==e&&(Q.length=0),null}function G(t){if(t&&t instanceof z)return t.refresh(),t;var e=V(t=y(t,"getNativeSelection")),n=o(t),i=S?C(t):null;return e?(e.nativeSelection=n,e.docSelection=i,e.refresh()):(e=new z(n,i,t),Q.push({win:t,selection:e})),e}h.getSelection=G,n.createAliasForDeprecatedMethod(h,"getIframeSelection","getSelection");var Y,K=z.prototype;function J(t,e){for(var n,i=g(e[0].startContainer),o=m(i).createControlRange(),a=0,s=e.length;a<s;++a){n=W(e[a]);try{o.add(n)}catch(t){throw c.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}o.select(),j(t)}if(!_&&T&&n.areHostMethods(x,["removeAllRanges","addRange"])){K.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),$(this)};var Z=function(t,e){I(t.nativeSelection,e),t.refresh()};K.addRange=D?function(t,e){if(H&&S&&this.docSelection.type==p)U(this,t);else if(b(e)&&k)Z(this,t);else{var n;n=N?this.rangeCount:(this.removeAllRanges(),0);var i=B(t).cloneRange();try{this.nativeSelection.addRange(i)}catch(t){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==n+1){if(h.config.checkSelectionRanges){var o=O(this.nativeSelection,this.rangeCount-1);o&&!v(o,t)&&(t=new s(o))}this._ranges[this.rangeCount-1]=t,L(this,t,et(this.nativeSelection)),this.isCollapsed=a(this)}else this.refresh()}}:function(t,e){b(e)&&k?Z(this,t):(this.nativeSelection.addRange(B(t)),this.refresh())},K.setRanges=function(t){if(H&&S&&1<t.length)J(this,t);else{this.removeAllRanges();for(var e=0,n=t.length;e<n;++e)this.addRange(t[e])}}}else{if(!(i(x,"empty")&&i(R,"select")&&H&&_))return c.fail("No means of selecting a Range or TextRange was found"),!1;K.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var t;if(this.anchorNode)t=g(this.anchorNode);else if(this.docSelection.type==p){var e=this.docSelection.createRange();e.length&&(t=g(e.item(0)))}if(t)m(t).createTextRange().select(),this.docSelection.empty()}}catch(t){}$(this)},K.addRange=function(t){this.docSelection.type==p?U(this,t):(h.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,L(this,t,!1))},K.setRanges=function(t){this.removeAllRanges();var e=t.length;1<e?J(this,t):e&&this.addRange(t[0])}}if(K.getRangeAt=function(t){if(t<0||t>=this.rangeCount)throw new l("INDEX_SIZE_ERR");return this._ranges[t].cloneRange()},_)Y=function(t){var e;h.isSelectionValid(t.win)?e=t.docSelection.createRange():(e=m(t.win.document).createTextRange()).collapse(!0),t.docSelection.type==p?j(t):F(e)?q(t,e):$(t)};else if(i(x,"getRangeAt")&&yt()(x.rangeCount)==e)Y=function(t){if(H&&S&&t.docSelection.type==p)j(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var e=0,n=t.rangeCount;e<n;++e)t._ranges[e]=new h.WrappedRange(t.nativeSelection.getRangeAt(e));L(t,t._ranges[t.rangeCount-1],et(t.nativeSelection)),t.isCollapsed=a(t)}else $(t)};else{if(!T||yt()(x.isCollapsed)!=t||yt()(R.collapsed)!=t||!f.implementsDomRange)return c.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;Y=function(t){var e,n=t.nativeSelection;n.anchorNode?(e=O(n,0),t._ranges=[e],t.rangeCount=1,function(t){var e=t.nativeSelection;t.anchorNode=e.anchorNode,t.anchorOffset=e.anchorOffset,t.focusNode=e.focusNode,t.focusOffset=e.focusOffset}(t),t.isCollapsed=a(t)):$(t)}}K.refresh=function(t){var e=t?this._ranges.slice(0):null,n=this.anchorNode,i=this.anchorOffset;if(Y(this),t){var o=e.length;if(o!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=i)return!0;for(;o--;)if(!v(e[o],this._ranges[o]))return!0;return!1}};function tt(t,e){var n=t.getAllRanges();t.removeAllRanges();for(var i=0,o=n.length;i<o;++i)v(e,n[i])||t.addRange(n[i]);t.rangeCount||$(t)}var et;function nt(t,e){if(t.win.document!=g(e))throw new l("WRONG_DOCUMENT_ERR")}function it(i){return function(t,e){var n;this.rangeCount?(n=this.getRangeAt(0))["set"+(i?"Start":"End")](t,e):(n=h.createRange(this.win.document)).setStartAndEnd(t,e),this.setSingleRange(n,this.isBackward())}}function ot(t){var e=[],n=new u(t.anchorNode,t.anchorOffset),i=new u(t.focusNode,t.focusOffset),o="function"==typeof t.getName?t.getName():"Selection";if(void 0!==t.rangeCount)for(var a=0,s=t.rangeCount;a<s;++a)e[a]=r.inspect(t.getRangeAt(a));return"["+o+"(Ranges: "+e.join(", ")+")(anchor: "+n.inspect()+", focus: "+i.inspect()+"]"}K.removeRange=H&&S?function(t){if(this.docSelection.type==p){for(var e=this.docSelection.createRange(),n=W(t),i=g(e.item(0)),o=m(i).createControlRange(),a=!1,s=0,r=e.length;s<r;++s)e.item(s)!==n||a?o.add(e.item(s)):a=!0;o.select(),j(this)}else tt(this,t)}:function(t){tt(this,t)},!_&&T&&f.implementsDomRange?(et=w,K.isBackward=function(){return et(this)}):et=K.isBackward=function(){return!1},K.isBackwards=K.isBackward,K.toString=function(){for(var t=[],e=0,n=this.rangeCount;e<n;++e)t[e]=""+this._ranges[e];return t.join("")},K.collapse=function(t,e){nt(this,t);var n=h.createRange(t);n.collapseToPoint(t,e),this.setSingleRange(n),this.isCollapsed=!0},K.collapseToStart=function(){if(!this.rangeCount)throw new l("INVALID_STATE_ERR");var t=this._ranges[0];this.collapse(t.startContainer,t.startOffset)},K.collapseToEnd=function(){if(!this.rangeCount)throw new l("INVALID_STATE_ERR");var t=this._ranges[this.rangeCount-1];this.collapse(t.endContainer,t.endOffset)},K.selectAllChildren=function(t){nt(this,t);var e=h.createRange(t);e.selectNodeContents(t),this.setSingleRange(e)},K.deleteFromDocument=function(){if(H&&S&&this.docSelection.type==p){for(var t,e=this.docSelection.createRange();e.length;)t=e.item(0),e.remove(t),d.removeNode(t);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var i=0,o=n.length;i<o;++i)n[i].deleteContents();this.addRange(n[o-1])}}},K.eachRange=function(t,e){for(var n=0,i=this._ranges.length;n<i;++n)if(t(this.getRangeAt(n)))return e},K.getAllRanges=function(){var e=[];return this.eachRange(function(t){e.push(t)}),e},K.setSingleRange=function(t,e){this.removeAllRanges(),this.addRange(t,e)},K.callMethodOnEachRange=function(e,n){var i=[];return this.eachRange(function(t){i.push(t[e].apply(t,n||[]))}),i},K.setStart=it(!0),K.setEnd=it(!1),h.rangePrototype.select=function(t){G(this.getDocument()).setSingleRange(this,t)},K.changeEachRange=function(e){var n=[],t=this.isBackward();this.eachRange(function(t){e(t),n.push(t)}),this.removeAllRanges(),t&&1==n.length?this.addRange(n[0],"backward"):this.setRanges(n)},K.containsNode=function(e,n){return this.eachRange(function(t){return t.containsNode(e,n)},!0)||!1},K.getBookmark=function(t){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[t])}},K.moveToBookmark=function(t){for(var e,n,i=[],o=0;e=t.rangeBookmarks[o++];)(n=h.createRange(this.win)).moveToBookmark(e),i.push(n);t.backward?this.setSingleRange(i[0],"backward"):this.setRanges(i)},K.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},K.restoreRanges=function(t){this.removeAllRanges();for(var e,n=0;e=t.ranges[n];++n)this.addRange(e,t.backward&&0==n)},K.toHtml=function(){var e=[];return this.eachRange(function(t){e.push(r.toHtml(t))}),e.join("")},f.implementsTextRange&&(K.getNativeTextRange=function(){var t;if(t=this.docSelection){var e=t.createRange();if(F(e))return e;throw c.createError("getNativeTextRange: selection is a control selection")}if(0<this.rangeCount)return h.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw c.createError("getNativeTextRange: selection contains no range")}),K.getName=function(){return"WrappedSelection"},K.inspect=function(){return ot(this)},K.detach=function(){V(this.win,"delete"),X(this)},z.detachAll=function(){V(null,"deleteAll")},z.inspect=ot,z.isDirectionBackward=b,h.Selection=z,h.selectionPrototype=K,h.addShimListener(function(t){void 0===t.getSelection&&(t.getSelection=function(){return G(t)}),t=null})});function W(t){F||(F=!0,!E.initialized&&E.config.autoInitialize&&I())}var F=!1;x&&("complete"==document.readyState?W():(d(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",W,!1),A(window,"load",W)));var q,j=E;j.createModule("ClassApplier",["WrappedSelection"],function(o,h){var d=o.dom,a=d.DomPosition,s=d.arrayContains,t=o.util,m=t.forEach,i=t.isHostMethod(document,"createElementNS");function f(t,e){for(var n in t)if(t.hasOwnProperty(n)&&!1===e(n,t[n]))return!1;return!0}function p(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function r(t,e){return!!t&&new RegExp("(?:^|\\s)"+e+"(?:\\s|$)").test(t)}function c(t,e){return"object"===yt()(t.classList)?t.classList.contains(e):r("string"==typeof t.className?t.className:t.getAttribute("class"),e)}function g(t,e){if("object"==yt()(t.classList))t.classList.add(e);else{var n="string"==typeof t.className,i=n?t.className:t.getAttribute("class");i?r(i,e)||(i+=" "+e):i=e,n?t.className=i:t.setAttribute("class",i)}}var v=function(t,e){if("object"===yt()(t.classList))t.classList.remove(e);else{var n="string"==typeof t.className,i=n?t.className:t.getAttribute("class");i=i.replace(new RegExp("(^|\\s)"+e+"(\\s|$)"),l),n?t.className=i:t.setAttribute("class",i)}};function l(t,e,n){return e&&n?" ":""}function e(t){return"string"==typeof t.className?t.className:t.getAttribute("class")}function b(t){return t&&t.split(/\s+/).sort().join(" ")}function n(t){return b(e(t))}function u(t,e){return n(t)===n(e)}function y(t,e){for(var n=e.split(/\s+/),i=0,o=n.length;i<o;++i)if(!c(t,p(n[i])))return!1;return!0}function C(t,e,n,i){-1===n&&(n=e.childNodes.length);var o=t.parentNode,a=d.getNodeIndex(t);m(i,function(t){!function(t,e,n,i,o){var a=t.node,s=t.offset,r=a,c=s;a===i&&o<s&&++c,a!==e||s!==n&&s!==n+1||(r=i,c+=o-n),a===e&&n+1<s&&--c,t.node=r,t.offset=c}(t,o,a,e,n)}),e.childNodes.length==n?e.appendChild(t):e.insertBefore(t,e.childNodes[n])}function w(t,e){var n=t.parentNode,i=d.getNodeIndex(t);m(e,function(t){!function(t,e,n){t.node===e&&t.offset>n&&--t.offset}(t,n,i)}),d.removeNode(t)}function A(t,e){return function(t,e,n,i,o){for(var a,s=[];a=t.firstChild;)C(a,e,n++,o),s.push(a);return i&&w(t,o),s}(t,t.parentNode,d.getNodeIndex(t),!0,e)}function S(t,e){var n=t.cloneRange();n.selectNodeContents(e);var i=n.intersection(t);return""!=(i?i.toString():"")}function _(t){for(var e,n=t.getNodes([3]),i=0;(e=n[i])&&!S(t,e);)++i;for(var o=n.length-1;(e=n[o])&&!S(t,e);)--o;return n.slice(i,o+1)}function x(t,e){if(t.attributes.length!=e.attributes.length)return!1;for(var n,i,o,a=0,s=t.attributes.length;a<s;++a)if("class"!=(o=(n=t.attributes[a]).name)){if(null===n!=(null===(i=e.attributes.getNamedItem(o))))return!1;if(n.specified!=i.specified)return!1;if(n.specified&&n.nodeValue!==i.nodeValue)return!1}return!0}function R(t,e){for(var n,i=0,o=t.attributes.length;i<o;++i)if(n=t.attributes[i].name,(!e||!s(e,n))&&t.attributes[i].specified&&"class"!=n)return!0;return!1}var E=d.getComputedStyleProperty,T="boolean"==typeof document.createElement("div").isContentEditable?function(t){return t&&1==t.nodeType&&t.isContentEditable}:function(t){return!(!t||1!=t.nodeType||"false"==t.contentEditable)&&("true"==t.contentEditable||T(t.parentNode))};function k(t){var e;return t&&1==t.nodeType&&((e=t.parentNode)&&9==e.nodeType&&"on"==e.designMode||T(t)&&!T(t.parentNode))}function D(t){return(T(t)||1!=t.nodeType&&T(t.parentNode))&&!k(t)}var N=/^inline(-block|-table)?$/i;function P(t){return t&&1==t.nodeType&&!N.test(E(t,"display"))}var I=/[^\r\n\t\f \u200B]/;function M(t){var e,n,i=[];for(e=0;n=t[e++];)i.push(new a(n.startContainer,n.startOffset),new a(n.endContainer,n.endOffset));return i}function O(t,e){for(var n,i,o,a=0,s=t.length;a<s;++a)n=t[a],i=e[2*a],o=e[2*a+1],n.setStartAndEnd(i.node,i.offset,o.node,o.offset)}function H(t,e,n,i){var o,a,s=0==n;if(d.isAncestorOf(e,t))return t;if(d.isCharacterDataNode(e)){var r=d.getNodeIndex(e);if(0===n)n=r;else{if(n!==e.length)throw h.createError("splitNodeAt() should not be called with offset in the middle of a data node ("+n+" in "+e.data);n=r+1}e=e.parentNode}if(function(t,e){return d.isCharacterDataNode(t)?0==e?!!t.previousSibling:e!=t.length||!!t.nextSibling:0<e&&e<t.childNodes.length}(e,n)){o=e.cloneNode(!1),a=e.parentNode,o.id&&o.removeAttribute("id");for(var c,l=0;c=e.childNodes[n];)C(c,o,l++,i);return C(o,a,d.getNodeIndex(e)+1,i),e==t?o:H(t,a,d.getNodeIndex(o),i)}if(t==e)return t;o=e.parentNode;var u=d.getNodeIndex(e);return s||u++,H(t,o,u,i)}function L(a){var s=a?"nextSibling":"previousSibling";return function(t,e){var n=t.parentNode,i=t[s];if(i){if(i&&3==i.nodeType)return i}else if(e&&(i=n[s])&&1==i.nodeType&&function(t,e){return t.namespaceURI==e.namespaceURI&&t.tagName.toLowerCase()==e.tagName.toLowerCase()&&u(t,e)&&x(t,e)&&"inline"==E(t,"display")&&"inline"==E(e,"display")}(n,i)){var o=i[a?"firstChild":"lastChild"];if(o&&3==o.nodeType)return o}return null}}var $=L(!1),B=L(!0);function W(t){this.isElementMerge=1==t.nodeType,this.textNodes=[];var e=this.isElementMerge?t.lastChild:t;e&&(this.textNodes[0]=e)}var F=["elementTagName","ignoreWhiteSpace","applyToEditableOnly","useExistingElements","removeEmptyElements","onElementCreate"],q={};function j(t,e,n){var i,o,a,s,r=this;r.cssClass=r.className=t;var c=null,l={};if("object"==yt()(e)&&null!==e){for(void 0!==e.elementTagName&&(e.elementTagName=e.elementTagName.toLowerCase()),n=e.tagNames,c=e.elementProperties,l=e.elementAttributes,o=0;s=F[o++];)e.hasOwnProperty(s)&&(r[s]=e[s]);i=e.normalize}else i=e;r.normalize=void 0===i||i,r.attrExceptions=[];var u=document.createElement(r.elementTagName);r.elementProperties=r.copyPropertiesToElement(c,u,!0),f(l,function(t,e){r.attrExceptions.push(t),l[t]=""+e}),r.elementAttributes=l,r.elementSortedClassName=r.elementProperties.hasOwnProperty("className")?b(r.elementProperties.className+" "+t):t,r.applyToAnyTagName=!1;var h=yt()(n);if("string"===h)"*"===n?r.applyToAnyTagName=!0:r.tagNames=p(n.toLowerCase()).split(/\s*,\s*/);else if("object"===h&&"number"==typeof n.length)for(r.tagNames=[],o=0,a=n.length;o<a;++o)"*"===n[o]?r.applyToAnyTagName=!0:r.tagNames.push(n[o].toLowerCase());else r.tagNames=[r.elementTagName]}j.prototype={elementTagName:"span",elementProperties:{},elementAttributes:{},ignoreWhiteSpace:!0,applyToEditableOnly:(W.prototype={doMerge:function(t){var e=this.textNodes,i=e[0];if(1<e.length){var o,a=d.getNodeIndex(i),s=[],r=0;m(e,function(e,n){o=e.parentNode,0<n&&(o.removeChild(e),o.hasChildNodes()||d.removeNode(o),t&&m(t,function(t){t.node==e&&(t.node=i,t.offset+=r),t.node==o&&t.offset>a&&(--t.offset,t.offset==a+1&&n<len-1&&(t.node=i,t.offset=r))})),s[n]=e.data,r+=e.data.length}),i.data=s.join("")}return i.data},getLength:function(){for(var t=this.textNodes.length,e=0;t--;)e+=this.textNodes[t].length;return e},toString:function(){var n=[];return m(this.textNodes,function(t,e){n[e]="'"+t.data+"'"}),"[Merge("+n.join(",")+")]"}},!1),useExistingElements:!0,removeEmptyElements:!0,onElementCreate:null,copyPropertiesToElement:function(t,e,n){var i,o,a,s,r,c,l={};for(var u in t)if(t.hasOwnProperty(u))if(s=t[u],r=e[u],"className"===u)g(e,s),g(e,this.className),e[u]=b(e[u]),n&&(l[u]=s);else if("style"==u){for(i in o=r,n&&(l[u]=a={}),t[u])t[u].hasOwnProperty(i)&&(o[i]=s[i],n&&(a[i]=o[i]));this.attrExceptions.push(u)}else e[u]=s,n&&(l[u]=e[u],c=q.hasOwnProperty(u)?q[u]:u,this.attrExceptions.push(c));return n?l:""},copyAttributesToElement:function(t,e){for(var n in t)t.hasOwnProperty(n)&&!/^class(?:Name)?$/i.test(n)&&e.setAttribute(n,t[n])},appliesToElement:function(t){return s(this.tagNames,t.tagName.toLowerCase())},getEmptyElements:function(t){var e=this;return t.getNodes([1],function(t){return e.appliesToElement(t)&&!t.hasChildNodes()})},hasClass:function(t){return 1===t.nodeType&&(this.applyToAnyTagName||this.appliesToElement(t))&&c(t,this.className)},getSelfOrAncestorWithClass:function(t){for(;t;){if(this.hasClass(t))return t;t=t.parentNode}return null},isModifiable:function(t){return!this.applyToEditableOnly||D(t)},isIgnorableWhiteSpaceNode:function(t){return this.ignoreWhiteSpace&&t&&3===t.nodeType&&function(t){if(0==t.data.length)return!0;if(I.test(t.data))return!1;switch(E(t.parentNode,"whiteSpace")){case"pre":case"pre-wrap":case"-moz-pre-wrap":return!1;case"pre-line":if(/[\r\n]/.test(t.data))return!1}return P(t.previousSibling)||P(t.nextSibling)}(t)},postApply:function(t,e,n,i){var o,a,s=t[0],r=t[t.length-1],c=[],l=s,u=r,h=0,d=r.length;m(t,function(t){(a=$(t,!i))?(o||(o=new W(a),c.push(o)),o.textNodes.push(t),t===s&&(l=o.textNodes[0],h=l.length),t===r&&(u=o.textNodes[0],d=o.getLength())):o=null});var f=B(r,!i);if(f&&(o||(o=new W(r),c.push(o)),o.textNodes.push(f)),c.length){for(var p=0,g=c.length;p<g;++p)c[p].doMerge(n);e.setStartAndEnd(l,h,u,d)}},createContainer:function(t){var e=d.getDocument(t),n=i&&!d.isHtmlNamespace(t)&&t.namespaceURI?e.createElementNS(t.namespaceURI,this.elementTagName):e.createElement(this.elementTagName);return this.copyPropertiesToElement(this.elementProperties,n,!1),this.copyAttributesToElement(this.elementAttributes,n),g(n,this.className),this.onElementCreate&&this.onElementCreate(n,this),n},elementHasProperties:function(n,t){var i=this;return f(t,function(t,e){if("className"===t)return y(n,e);if("object"===yt()(e)){if(!i.elementHasProperties(n[t],e))return!1}else if(n[t]!==e)return!1})},elementHasAttributes:function(n,t){return f(t,function(t,e){if(n.getAttribute(t)!==e)return!1})},applyToTextNode:function(t,e){if(function(t){var e=t.parentNode;return e&&1===e.nodeType&&!/^(textarea|style|script|select|iframe)$/i.test(e.nodeName)}(t)){var n=t.parentNode;if(1===n.childNodes.length&&this.useExistingElements&&this.appliesToElement(n)&&this.elementHasProperties(n,this.elementProperties)&&this.elementHasAttributes(n,this.elementAttributes))g(n,this.className);else{var i=t.parentNode,o=this.createContainer(i);i.insertBefore(o,t),o.appendChild(t)}}},isRemovable:function(t){return t.tagName.toLowerCase()===this.elementTagName&&n(t)===this.elementSortedClassName&&this.elementHasProperties(t,this.elementProperties)&&!R(t,this.attrExceptions)&&this.elementHasAttributes(t,this.elementAttributes)&&this.isModifiable(t)},isEmptyContainer:function(t){var e=t.childNodes.length;return 1===t.nodeType&&this.isRemovable(t)&&(0===e||1===e&&this.isEmptyContainer(t.firstChild))},removeEmptyContainers:function(t){var e=this,n=t.getNodes([1],function(t){return e.isEmptyContainer(t)}),i=[t],o=M(i);m(n,function(t){w(t,o)}),O(i,o)},undoToTextNode:function(t,e,n,i){if(!e.containsNode(n)){var o=e.cloneRange();o.selectNode(n),o.isPointInRange(e.endContainer,e.endOffset)&&(H(n,e.endContainer,e.endOffset,i),e.setEndAfter(n)),o.isPointInRange(e.startContainer,e.startOffset)&&(n=H(n,e.startContainer,e.startOffset,i))}this.isRemovable(n)?A(n,i):v(n,this.className)},splitAncestorWithClass:function(t,e,n){var i=this.getSelfOrAncestorWithClass(t);i&&H(i,t,e,n)},undoToAncestor:function(t,e){this.isRemovable(t)?A(t,e):v(t,this.className)},applyToRange:function(t,e){var n=this,i=M((e=e||[])||[]);t.splitBoundariesPreservingPositions(i),n.removeEmptyElements&&n.removeEmptyContainers(t);var o=_(t);if(o.length){m(o,function(t){n.isIgnorableWhiteSpaceNode(t)||n.getSelfOrAncestorWithClass(t)||!n.isModifiable(t)||n.applyToTextNode(t,i)});var a=o[o.length-1];t.setStartAndEnd(o[0],0,a,a.length),n.normalize&&n.postApply(o,t,i,!1),O(e,i)}var s=n.getEmptyElements(t);m(s,function(t){g(t,n.className)})},applyToRanges:function(t){for(var e=t.length;e--;)this.applyToRange(t[e],t);return t},applyToSelection:function(t,e){var n=o.getSelection(t),i=n.getAllRanges();n.setRanges(this.applyToRanges(i))},undoToRange:function(t,e){var n=this,i=M(e=e||[]);t.splitBoundariesPreservingPositions(i),n.removeEmptyElements&&n.removeEmptyContainers(t,i);var o,a,s=_(t),r=s[s.length-1];if(s.length){n.splitAncestorWithClass(t.endContainer,t.endOffset,i),n.splitAncestorWithClass(t.startContainer,t.startOffset,i);for(var c=0,l=s.length;c<l;++c)o=s[c],(a=n.getSelfOrAncestorWithClass(o))&&n.isModifiable(o)&&n.undoToAncestor(a,i);t.setStartAndEnd(s[0],0,r,r.length),n.normalize&&n.postApply(s,t,i,!0),O(e,i)}var u=n.getEmptyElements(t);m(u,function(t){v(t,n.className)})},undoToRanges:function(t){for(var e=t.length;e--;)this.undoToRange(t[e],t);return t},undoToSelection:function(t){var e=o.getSelection(t),n=o.getSelection(t).getAllRanges();this.undoToRanges(n),e.setRanges(n)},isAppliedToRange:function(t){if(t.collapsed||""==t.toString())return!!this.getSelfOrAncestorWithClass(t.commonAncestorContainer);var e=t.getNodes([3]);if(e.length)for(var n,i=0;n=e[i++];)if(!this.isIgnorableWhiteSpaceNode(n)&&S(t,n)&&this.isModifiable(n)&&!this.getSelfOrAncestorWithClass(n))return!1;return!0},isAppliedToRanges:function(t){var e=t.length;if(0===e)return!1;for(;e--;)if(!this.isAppliedToRange(t[e]))return!1;return!0},isAppliedToSelection:function(t){var e=o.getSelection(t);return this.isAppliedToRanges(e.getAllRanges())},toggleRange:function(t){this.isAppliedToRange(t)?this.undoToRange(t):this.applyToRange(t)},toggleSelection:function(t,e){this.isAppliedToSelection(t)?this.undoToSelection(t):this.applyToSelection(t,e)},getElementsWithClassIntersectingRange:function(t){var n=[],i=this;return t.getNodes([3],function(t){var e=i.getSelfOrAncestorWithClass(t);e&&!s(n,e)&&n.push(e)}),n},detach:function(){}},j.util={hasClass:c,addClass:g,removeClass:v,getClass:e,hasSameClasses:u,hasAllClasses:y,replaceWithOwnChildren:A,elementsHaveSameNonClassAttributes:x,elementHasNonClassAttributes:R,splitNodeAt:H,isEditableElement:T,isEditingHost:k,isEditable:D},o.CssClassApplier=o.ClassApplier=j,o.createClassApplier=function(t,e,n){return new j(t,e,n)},t.createAliasForDeprecatedMethod(o,"createCssClassApplier","createClassApplier",h)}),j.createModule("Highlighter",["ClassApplier"],function(S,t){var e=S.dom,o=e.arrayContains,c=e.getBody,_=S.util.createOptions,x=S.util.forEach,s=1;function n(t,e){return t.characterRange.start-e.characterRange.start}function y(t,e){return e?t.getElementById(e):c(t)}var i={};function a(t,e){this.type=t,this.converterCreator=e}function r(t,e){i[t]=new a(t,e)}function C(t){var e=i[t];if(e instanceof a)return e.create();throw new Error("Highlighter type '"+t+"' is not valid")}function R(t,e){this.start=t,this.end=e}a.prototype.create=function(){var t=this.converterCreator();return t.type=this.type,t},S.registerHighlighterType=r,R.prototype={intersects:function(t){return this.start<t.end&&this.end>t.start},isContiguousWith:function(t){return this.start==t.end||this.end==t.start},union:function(t){return new R(Math.min(this.start,t.start),Math.max(this.end,t.end))},intersection:function(t){return new R(Math.max(this.start,t.start),Math.min(this.end,t.end))},getComplements:function(t){var e=[];if(this.start>=t.start){if(this.end<=t.end)return[];e.push(new R(t.end,this.end))}else e.push(new R(this.start,Math.min(this.end,t.start))),this.end>t.end&&e.push(new R(t.end,this.end));return e},toString:function(){return"[CharacterRange("+this.start+", "+this.end+")]"}},R.fromCharacterRange=function(t){return new R(t.start,t.end)};var l,u={rangeToCharacterRange:function(t,e){var n=t.getBookmark(e);return new R(n.start,n.end)},characterRangeToRange:function(t,e,n){var i=S.createRange(t);return i.moveToBookmark({start:e.start,end:e.end,containerNode:n}),i},serializeSelection:function(t,e){for(var n=t.getAllRanges(),i=[],o=1===n.length&&t.isBackward(),a=0,s=n.length;a<s;++a)i[a]={characterRange:this.rangeToCharacterRange(n[a],e),backward:o};return i},restoreSelection:function(t,e,n){t.removeAllRanges();for(var i,o,a=t.win.document,s=0,r=e.length;s<r;++s)(o=e[s]).characterRange,i=this.characterRangeToRange(a,o.characterRange,n),t.addRange(i,o.backward)}};function E(t,e,n,i,o,a){o?(this.id=o,s=Math.max(s,o+1)):this.id=s++,this.characterRange=e,this.doc=t,this.classApplier=n,this.converter=i,this.containerElementId=a||null,this.applied=!1}function h(t,e){e=e||"textContent",this.doc=t||document,this.classAppliers={},this.highlights=[],this.converter=C(e)}r("textContent",function(){return u}),r("TextRange",function(){if(!l){var t=S.modules.TextRange;if(!t)throw new Error("TextRange module is missing.");if(!t.supported)throw new Error("TextRange module is present but not supported.");l={rangeToCharacterRange:function(t,e){return R.fromCharacterRange(t.toCharacterRange(e))},characterRangeToRange:function(t,e,n){var i=S.createRange(t);return i.selectCharacters(n,e.start,e.end),i},serializeSelection:function(t,e){return t.saveCharacterRanges(e)},restoreSelection:function(t,e,n){t.restoreCharacterRanges(n,e)}}}return l}),E.prototype={getContainerElement:function(){return y(this.doc,this.containerElementId)},getRange:function(){return this.converter.characterRangeToRange(this.doc,this.characterRange,this.getContainerElement())},fromRange:function(t){this.characterRange=this.converter.rangeToCharacterRange(t,this.getContainerElement())},getText:function(){return this.getRange().toString()},containsElement:function(t){return this.getRange().containsNodeContents(t.firstChild)},unapply:function(){this.classApplier.undoToRange(this.getRange()),this.applied=!1},apply:function(){this.classApplier.applyToRange(this.getRange()),this.applied=!0},getHighlightElements:function(){return this.classApplier.getElementsWithClassIntersectingRange(this.getRange())},toString:function(){return"[Highlight(ID: "+this.id+", class: "+this.classApplier.className+", character range: "+this.characterRange.start+" - "+this.characterRange.end+")]"}},h.prototype={addClassApplier:function(t){this.classAppliers[t.className]=t},getHighlightForElement:function(t){for(var e=this.highlights,n=0,i=e.length;n<i;++n)if(e[n].containsElement(t))return e[n];return null},getHighlightsForElement:function(t){for(var e=this.highlights,n=[],i=0,o=e.length;i<o;++i)e[i].containsElement(t)&&n.push(e[i]);return n},removeHighlights:function(t){for(var e,n=0,i=this.highlights.length;n<i;++n)e=this.highlights[n],o(t,e)&&(e.unapply(),this.highlights.splice(n--,1))},removeAllHighlights:function(){this.removeHighlights(this.highlights)},getIntersectingHighlights:function(t){var n=[],i=this.highlights;return x(t,function(e){x(i,function(t){e.intersectsRange(t.getRange())&&!o(n,t)&&n.push(t)})}),n},highlightCharacterRanges:function(t,e,n){var i,o,a,s,r,c,l,u,h,d,f,p,g=this.highlights,m=this.converter,v=this.doc,b=[],y=t?this.classAppliers[t]:null,C=(n=_(n,{containerElementId:null,exclusive:!0})).containerElementId,w=n.exclusive;for(C&&(s=this.doc.getElementById(C))&&((r=S.createRange(this.doc)).selectNodeContents(s),c=new R(0,r.toString().length)),i=0,o=e.length;i<o;++i)if(l=e[i],f=[],c&&(l=l.intersection(c)),l.start!==l.end){for(a=0;a<g.length;++a)h=!1,C===g[a].containerElementId&&(u=g[a].characterRange,p=!(d=y===g[a].classApplier)&&w,(u.intersects(l)||u.isContiguousWith(l))&&(d||p)&&(p&&x(u.getComplements(l),function(t){f.push(new E(v,t,g[a].classApplier,m,null,C))}),h=!0,d&&(l=u.union(l)))),h?(b.push(g[a]),g[a]=new E(v,u.union(l),y,m,null,C)):f.push(g[a]);y&&f.push(new E(v,l,y,m,null,C)),this.highlights=g=f}x(b,function(t){t.unapply()});var A=[];return x(g,function(t){t.applied||(t.apply(),A.push(t))}),A},highlightRanges:function(t,e,n){var i,o=[],a=this.converter,s=(n=_(n,{containerElement:null,exclusive:!0})).containerElement,r=s?s.id:null;return s&&(i=S.createRange(s)).selectNodeContents(s),x(e,function(t){var e=s?i.intersection(t):t;o.push(a.rangeToCharacterRange(e,s||c(t.getDocument())))}),this.highlightCharacterRanges(t,o,{containerElementId:r,exclusive:n.exclusive})},highlightSelection:function(o,t){var a=this,s=this.converter,r=!!o&&this.classAppliers[o];t=_(t,{containerElementId:null,exclusive:!0});var c,l=[],u=t.exclusive,h=t.selection||S.getSelection(this.doc),d=h.win.document,e=t.containerElementId;!1===Array.isArray(e)&&(e=[e]);var f=y(d,null),p=s.serializeSelection(h,f);return e.forEach(function(t){if(c=y(d,t),!r&&!1!==o)throw new Error("No class applier found for class '"+o+"'");var e=s.serializeSelection(h,c),i=[];x(e,function(t){i.push(R.fromCharacterRange(t.characterRange))});var n=t;!1===Array.isArray(n)&&(n=[n]),n.forEach(function(t,e){var n=a.highlightCharacterRanges(o,i,{containerElementId:t,exclusive:u});l=l.concat(n)}),s.restoreSelection(h,p,f)}),l},unhighlightSelection:function(t){var e=[];t=Array.isArray(t)&&"string"==typeof t[0]?(e=t,S.getSelection(this.doc)):t||S.getSelection(this.doc);var n=this.getIntersectingHighlights(t.getAllRanges());return 0<e.length&&(n=n.filter(function(t){return-1<e.indexOf(t.classApplier.className)})),0<n.length&&this.removeHighlights(n),t.removeAllRanges(),n},getHighlightsInSelection:function(t){return t=t||S.getSelection(this.doc),this.getIntersectingHighlights(t.getAllRanges())},selectionOverlapsHighlight:function(t){return 0<this.getHighlightsInSelection(t).length},serialize:function(o){var t,a,s,r,c=this,e=c.highlights;return e.sort(n),t=(o=_(o,{serializeHighlightText:!1,type:c.converter.type})).type,(s=t!==c.converter.type)&&(r=C(t)),a=["type:"+t],x(e,function(t){var e,n=t.characterRange;s&&(e=t.getContainerElement(),n=r.rangeToCharacterRange(c.converter.characterRangeToRange(c.doc,n,e),e));var i=[n.start,n.end,t.id,t.classApplier.className,t.containerElementId];o.serializeHighlightText&&i.push(t.getText()),a.push(i.join("$"))}),a.join("|")},deserialize:function(t,e){if("string"!=typeof t||""===t)return!1;var n,i,o,a,s,r,c,l,u,h=(e=e||{}).append,d=t.split("|"),f=[],p=d[0],g=!1;if(!p||!(n=/^type:(\w+)$/.exec(p)))throw new Error("Serialized highlights are invalid.");(i=n[1])!==this.converter.type&&(o=C(i),g=!0),d.shift(),!0===h&&(u=this.highlights.length+1);for(var m,v=d.length;0<v--;){if(r=new R(+(m=d[v].split("$"))[0],+m[1]),c=m[4]||null,g&&(l=y(this.doc,c),r=this.converter.rangeToCharacterRange(o.characterRangeToRange(this.doc,r,l),l)),!(a=this.classAppliers[m[3]]))throw new Error("No class applier found for class '"+m[3]+"'");var b=parseInt(m[2]);"number"==typeof u&&(b=++u),(s=new E(this.doc,r,a,this.converter,b,c)).apply(),f.push(s)}this.highlights=!0===h?this.highlights.concat(f):f},deserializeAsync:function(g,t){var m=this;if("string"!=typeof g||""===g)return!1;var v=(t=t||{}).append;return new Promise(function(o,t){var e,n,a,s,r,c,l,u,h,d=g.split("|"),f=[],i=d[0],p=!1;if(!i||!(e=/^type:(\w+)$/.exec(i)))throw new Error("Serialized highlights are invalid.");(n=e[1])!==m.converter.type&&(a=C(n),p=!0),d.shift(),!0===v&&(h=m.highlights.length+1),function t(e){if(-1<--e){var n=d[e].split("$");if(c=new R(+n[0],+n[1]),l=n[4]||null,p&&(u=y(m.doc,l),c=m.converter.rangeToCharacterRange(a.characterRangeToRange(m.doc,c,u),u)),!(s=m.classAppliers[n[3]]))throw new Error("No class applier found for class '"+n[3]+"'");var i=parseInt(n[2]);"number"==typeof h&&(i=++h),(r=new E(m.doc,c,s,m.converter,i,l)).apply(),f.push(r),setTimeout(function(){t(e)},0)}else m.highlights=!0===v?m.highlights.concat(f):f,o()}(d.length)})}},S.Highlighter=h,S.createHighlighter=function(t,e){return new h(t,e)}}),(q=j).createModule("Position",["WrappedSelection"],function(u,l){var h="number",e="undefined",n=u.WrappedRange,d=u.WrappedTextRange,f=u.dom,t=u.util,p=f.DomPosition;function i(t){var e=0,n=0;if(yt()(t.pageXOffset)==h&&yt()(t.pageYOffset)==h)e=t.pageXOffset,n=t.pageYOffset;else{var i=t.document,o=i.documentElement,a=i.compatMode,s="string"==typeof a&&0<=a.indexOf("CSS")&&o?o:f.getBody(i);if(s&&yt()(s.scrollLeft)==h&&yt()(s.scrollTop)==h)try{e=s.scrollLeft,n=s.scrollTop}catch(t){}}return{x:e,y:n}}function g(t,e){for(e=e.toLowerCase();t;){if(1==t.nodeType&&t.tagName.toLowerCase()==e)return t;t=t.parentNode}return null}function c(t,e,n,i){this.top=t,this.right=e,this.bottom=n,this.left=i,this.width=e-i,this.height=n-t,this.middle=t+this.height/2,this.center=i+this.width/2}function m(t,e,n){return new c(t.top+n,t.right+e,t.bottom+n,t.left+e)}function v(t,e){var n=0,i=0,o=e.documentElement,a=f.getBody(e),s=0===o.clientWidth&&yt()(a.clientTop)==h?a:o,r=s.clientLeft,c=s.clientTop;return r&&(n=-r),c&&(i=-c),m(t,n,i)}function b(t){for(var e,n=[],i=[],o=[],a=[],s=0,r=t.length;s<r;++s)(e=t[s])&&(n.push(e.top),i.push(e.bottom),o.push(e.left),a.push(e.right));return new c(Math.min.apply(Math,n),Math.max.apply(Math,a),Math.max.apply(Math,i),Math.min.apply(Math,o))}function o(t,e,n){var i=f.getBody(t).createTextRange();i.moveToPoint(e,n);var o=new u.WrappedTextRange(i);return new p(o.startContainer,o.startOffset)}function a(t,e,n){var i=t.caretPositionFromPoint(e,n);return new p(i.offsetNode,i.offset)}function s(t,e,n){var i=t.caretRangeFromPoint(e,n);return new p(i.startContainer,i.startOffset)}function y(t){var e=(t.nativeRange||t).getClientRects();return 0<e.length?e[e.length-1]:null}function C(t,e,n){return console.log("pointIsInOrAboveRect",t,e,Math.floor(n.top),Math.floor(n.right),Math.floor(n.bottom),Math.floor(n.left)),e<n.bottom&&t>=n.left&&t<=n.right}function r(t,e,n,i){var o=t.elementFromPoint(e,n);console.log("elementFromPoint is ",o);var a=u.createRange(t);a.selectNodeContents(o),a.collapse(!0);var s,r,c,l=o.firstChild;if(l){t:for(;l;){if(3==l.nodeType){for(s=0,c=l.length;s<=c;++s)if(a.setEnd(l,s),(r=y(a))&&C(e,n,r)){r.right-e>e-r.left&&--s;break t}}else if(a.setEndAfter(l),(r=y(a))&&C(e,n,r)){s=f.getNodeIndex(l),l=o.parentNode,i||++s;break}l=l.nextSibling}l||(s=(l=o).childNodes.length)}else l=o.parentNode,s=f.getNodeIndex(o),i||++s;return new p(l,s)}function w(t){if(u.features.implementsTextRange)return o;if(yt()(t.caretPositionFromPoint)!=e)return a;if(yt()(t.caretRangeFromPoint)!=e)return s;if(yt()(t.elementFromPoint)!=e&&x)return r;throw l.createError("createCaretPositionFromPointGetter(): Browser does not provide a recognised method to create a selection from pixel coordinates")}function A(t,e,n,i,o){var a=w(o=f.getContentDocument(o,l,"createRangeFromPoints")),s=a(o,t,e,!1),r=a(o,n,i,!0),c=u.createRange(o);return c.setStartAndEnd(s.node,s.offset,r.node,r.offset),c}var S=document.createElement("span"),_=t.isHostMethod(S,"getBoundingClientRect");S=null;var x=!1,R=!1;if(u.features.implementsDomRange){var E=u.createNativeRange();x=t.isHostMethod(E,"getClientRects"),R=t.isHostMethod(E,"getBoundingClientRect")}t.extend(u.features,{rangeSupportsGetBoundingClientRect:R,rangeSupportsGetClientRects:x,elementSupportsGetBoundingClientRect:_});var T=function(n){return function(){var t=this.cloneRange();t.collapse(n);var e=t.getBoundingClientRect();return{x:e[n?"left":"right"],y:e[n?"top":"bottom"]}}},k=u.rangePrototype;if(u.features.implementsTextRange&&_)k.getBoundingClientRect=function(){var t,e=d.rangeToTextRange(this),n=this.getNodes([1],function(t){return/^t[dh]$/i.test(t.tagName)}),i=[];if(0<n.length){for(var o,a,s,r,c=g(this.startContainer,"table"),l=0;o=n[l];++l)s=g(o,"table"),c&&s==c||(r=this.cloneRange(),c&&r.setStartAfter(c),r.setEndBefore(s),i.push(d.rangeToTextRange(r).getBoundingClientRect())),this.containsNode(o)?i.push(o.getBoundingClientRect()):((a=e.duplicate()).moveToElementText(o),-1==a.compareEndPoints("StartToStart",e)?a.setEndPoint("StartToStart",e):1==a.compareEndPoints("EndToEnd",e)&&a.setEndPoint("EndToEnd",e),i.push(a.getBoundingClientRect())),c=s;!g(this.endContainer,"table")&&c&&((r=this.cloneRange()).setStartAfter(c),i.push(d.rangeToTextRange(r).getBoundingClientRect())),t=b(i)}else t=e.getBoundingClientRect();return v(t,f.getDocument(this.startContainer))};else if(u.features.implementsDomRange){var D=function(t){return t instanceof n?t:new n(t)};if(R)k.getBoundingClientRect=function(){var t=D(this).nativeRange;return v(t.getBoundingClientRect()||t.getClientRects()[0],f.getDocument(this.startContainer))},x&&(T=function(n){return function(){var t,e=D(this).nativeRange.getClientRects();if(0==e.length&&_&&this.collapsed&&1==this.startContainer.nodeType&&this.startOffset<this.startContainer.childNodes.length&&this.startContainer.childNodes[this.startOffset].getClientRects,0<e.length)return n?{x:(t=e[0]).left,y:t.top}:{x:(t=e[e.length-1]).right,y:t.bottom};throw l.createError("Cannot get position for range "+this.inspect())}});else{var N=_?function(t){return v(t.getBoundingClientRect(),f.getDocument(t))}:function(t){for(var e=0,n=0,i=t,o=t.offsetWidth,a=t.offsetHeight;i;)e+=i.offsetLeft,n+=i.offsetTop,i=i.offsetParent;return v(new c(n,e+o,n+a,e),f.getDocument(t))};k.getBoundingClientRect=function(t){return function(e){var t;e.splitBoundaries();var n=document.createElement("span");if(e.collapsed)e.insertNode(n),t=N(n),n.parentNode.removeChild(n);else{var i=e.cloneRange();i.collapse(!0),i.insertNode(n);var o=N(n);n.parentNode.removeChild(n),i.collapseToPoint(e.endContainer,e.endOffset),i.insertNode(n);var a=N(n);n.parentNode.removeChild(n);for(var s=[o,a],r=e.getNodes([1],function(t){return e.containsNode(t)}),c=0,l=r.length;c<l;++c)s.push(N(r[c]));t=b(s)}return e.normalizeBoundaries(),t}(D(t))}}}function P(n){return function(){var t=this["get"+(n?"Start":"End")+"ClientPos"](),e=i(f.getWindow(this.startContainer));return{x:t.x+e.x,y:t.y+e.y}}}function I(t,e){return t.compareBoundaryPoints(e.START_TO_START,e)}function M(i){return function(){for(var t="getBounding"+(i?"Document":"Client")+"Rect",e=[],n=0;n<this.rangeCount;++n)e.push(this.getRangeAt(n)[t]());return b(e)}}function O(n,i){return function(){if(0==this.rangeCount)return null;var t=i?"Document":"Client",e=this.getAllRanges();return 1<e.length&&e.sort(I),n?e[0]["getStart"+t+"Pos"]():e[e.length-1]["getEnd"+t+"Pos"]()}}t.extend(k,{getBoundingDocumentRect:function(){var t=i(f.getWindow(this.startContainer));return m(this.getBoundingClientRect(),t.x,t.y)},getStartClientPos:T(!0),getEndClientPos:T(!1),getStartDocumentPos:P(!0),getEndDocumentPos:P(!1)}),t.extend(u.selectionPrototype,{getBoundingClientRect:M(!1),getBoundingDocumentRect:M(!0),getStartClientPos:O(!0,!1),getEndClientPos:O(!1,!1),getStartDocumentPos:O(!0,!0),getEndDocumentPos:O(!1,!0)}),u.positionFromPoint=function(t,e,n){return w(n=f.getContentDocument(n,l,"positionFromPoint"))(n,t,e)},u.createRangeFromPoints=A,u.moveSelectionToPoints=function(t,e,n,i,o){var a,s,r,c;c=i<e||e==i&&n<t?(a=n,s=i,r=t,e):(a=t,s=e,r=n,i);var l=q.getSelection(o),u=A(a,s,r,c,o);return l.setSingleRange(u),l}}),j.createModule("SaveRestore",["WrappedRange"],function(c,s){var r=c.dom,l=r.removeNode,u=c.Selection.isDirectionBackward,h="";function d(t,e){return(e||document).getElementById(t)}function f(t,e){var n,i="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),o=r.getDocument(t.startContainer),a=t.cloneRange();return a.collapse(e),(n=o.createElement("span")).id=i,n.style.lineHeight="0",n.style.display="none",n.className="rangySelectionBoundary",n.appendChild(o.createTextNode(h)),a.insertNode(n),n}function p(t,e,n,i){var o=d(n,t);o?(e[i?"setStartBefore":"setEndBefore"](o),l(o)):s.warn("Marker element has been removed. Cannot restore selection.")}function g(t,e){return e.compareBoundaryPoints(t.START_TO_START,t)}function m(t,e){var n,i=c.DomRange.getRangeDocument(t),o=t.toString(),a=u(e);return t.collapsed?{document:i,markerId:(n=f(t,!1)).id,collapsed:!0}:(n=f(t,!1),{document:i,startMarkerId:f(t,!0).id,endMarkerId:n.id,collapsed:!1,backward:a,toString:function(){return"original text: '"+o+"', new text: '"+t.toString()+"'"}})}function i(t,e){var n=t.document;void 0===e&&(e=!0);var i=c.createRange(n);if(t.collapsed){var o=d(t.markerId,n);if(o){o.style.display="inline";var a=o.previousSibling;a&&3==a.nodeType?(l(o),i.collapseToPoint(a,a.length)):(i.collapseBefore(o),l(o))}else s.warn("Marker element has been removed. Cannot restore selection.")}else p(n,i,t.startMarkerId,!0),p(n,i,t.endMarkerId,!1);return e&&i.normalizeBoundaries(),i}function a(t,e){var n,i,o=[],a=u(e);(t=t.slice(0)).sort(g);for(var s=0,r=t.length;s<r;++s)o[s]=m(t[s],a);for(s=r-1;0<=s;--s)n=t[s],i=c.DomRange.getRangeDocument(n),n.collapsed?n.collapseAfter(d(o[s].markerId,i)):(n.setEndBefore(d(o[s].endMarkerId,i)),n.setStartAfter(d(o[s].startMarkerId,i)));return o}function v(t){for(var e=[],n=t.length-1;0<=n;n--)e[n]=i(t[n],!0);return e}function b(t,e){var n=d(e,t);n&&l(n)}c.util.extend(c,{saveRange:m,restoreRange:i,saveRanges:a,restoreRanges:v,saveSelection:function(t){if(!c.isSelectionValid(t))return s.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null;var e=c.getSelection(t),n=e.getAllRanges(),i=1==n.length&&e.isBackward(),o=a(n,i);return i?e.setSingleRange(n[0],i):e.setRanges(n),{win:t,rangeInfos:o,restored:!1}},restoreSelection:function(t,e){if(!t.restored){var n=t.rangeInfos,i=c.getSelection(t.win),o=v(n);1==n.length&&e&&c.features.selectionHasExtend&&n[0].backward?(i.removeAllRanges(),i.addRange(o[0],!0)):i.setRanges(o),t.restored=!0}},removeMarkerElement:b,removeMarkers:function(t){for(var e,n=t.rangeInfos,i=0,o=n.length;i<o;++i)(e=n[i]).collapsed?b(t.doc,e.markerId):(b(t.doc,e.startMarkerId),b(t.doc,e.endMarkerId))}})}),j.createModule("TextRange",["WrappedSelection"],function(v,e){var t,n,i,g="character",m="word",c=v.dom,o=v.util,a=o.extend,r=o.createOptions,l=c.getBody,s=/^[ \t\f\r\n]+$/,u=/^[ \t\f\r]+$/,d=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,h=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,f="en",b=v.Selection.isDirectionBackward,p=!1,y=!1;function C(t,e){for(var n=t.slice(e.start,e.end),i={isWord:e.isWord,chars:n,toString:function(){return n.join("")}},o=0,a=n.length;o<a;++o)n[o].token=i;return i}function w(t,e,n){for(var i,o=n(t,e),a=[],s=0;i=o[s++];)a.push(C(t,i));return a}t=c.createTestElement(document,"<p>1 </p><p></p>",!0),n=t.firstChild,(i=v.getSelection()).collapse(n.lastChild,2),i.setStart(n.firstChild,0),t.innerHTML="1 <br />",i.collapse(t,2),i.setStart(t.firstChild,0),p=1==(""+i).length,t.innerHTML="1 <p>1</p>",i.collapse(t,2),i.setStart(t.firstChild,0),y=1==(""+i).length,c.removeNode(t),i.removeAllRanges();var A={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includeSpaceBeforeBlock:!0,includePreLineTrailingSpace:!0,ignoreCharacters:""},S={includeBlockContentTrailingSpace:!1,includeSpaceBeforeBr:!p,includeSpaceBeforeBlock:!y,includePreLineTrailingSpace:!0},_={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:function(t,e){var n,i=t.join(""),o=[];function a(t,e,n){o.push({start:t,end:e,isWord:n})}for(var s,r,c=0;n=e.wordRegex.exec(i);){if(r=(s=n.index)+n[0].length,c<s&&a(c,s,!1),e.includeTrailingSpace)for(;h.test(t[r]);)++r;a(s,r,!0),c=r}return c<t.length&&a(c,t.length,!1),o}}},x={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},R={wordOptions:null,characterOptions:null},E={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},T={wordOptions:null,characterOptions:null,direction:"forward"};function k(t,e){var n=r(t,e);return e.hasOwnProperty("wordOptions")&&(n.wordOptions=function(t){var e,n;return t?(e=t.language||f,a(n={},_[e]||_[f]),a(n,t),n):_[f]}(n.wordOptions)),e.hasOwnProperty("characterOptions")&&(n.characterOptions=r(n.characterOptions,A)),n}var D,N,P,I=c.getComputedStyleProperty;N=document.createElement("table"),(P=l(document)).appendChild(N),D="block"==I(N,"display"),P.removeChild(N);var M={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};function O(t,e){var n=I(t,"display",e),i=t.tagName.toLowerCase();return"block"==n&&D&&M.hasOwnProperty(i)?M[i]:n}function H(t){for(var e=function(t){return function(t){for(var e=[];t.parentNode;)e.unshift(t.parentNode),t=t.parentNode;return e}(t).concat([t])}(t),n=0,i=e.length;n<i;++n)if(1==e[n].nodeType&&"none"==O(e[n]))return!0;return!1}function L(t,e){return!e&&t.hasChildNodes()?t.firstChild:function(t){for(;t&&!t.nextSibling;)t=t.parentNode;return t?t.nextSibling:null}(t)}function $(t){var e=t.previousSibling;if(e){for(t=e;t.hasChildNodes();)t=t.lastChild;return t}var n=t.parentNode;return n&&1==n.nodeType?n:null}function B(t){if(!t||3!=t.nodeType)return!1;var e=t.data;if(""===e)return!0;var n=t.parentNode;if(!n||1!=n.nodeType)return!1;var i=I(t.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(e)&&/^(normal|nowrap)$/.test(i)||/^[\t\r ]+$/.test(e)&&"pre-line"==i}function W(t){return""===t.data||!!B(t)&&(!t.parentNode||!!H(t))}function F(t){var e=t.nodeType;return 7==e||8==e||H(t)||/^(script|style)$/i.test(t.nodeName)||function(t){var e;return 3==t.nodeType&&(e=t.parentNode)&&"hidden"==I(e,"visibility")}(t)||W(t)}function q(t,e){var n=t.nodeType;return 7==n||8==n||1==n&&"none"==O(t,e)}function j(){this.store={}}function U(i,o,a){return function(t){var e=this.cache;if(e.hasOwnProperty(i))return e[i];var n=o.call(this,a?this[a]:this,t);return e[i]=n}}function z(t,e){this.node=t,this.session=e,this.cache=new j,this.positions=new j}j.prototype={get:function(t){return this.store.hasOwnProperty(t)?this.store[t]:null},set:function(t,e){return this.store[t]=e}};var X={getPosition:function(t){var e=this.positions;return e.get(t)||e.set(t,new et(this,t))},toString:function(){return"[NodeWrapper("+c.inspectNode(this.node)+")]"}},Q="NON_SPACE",V="UNCOLLAPSIBLE_SPACE",G="COLLAPSIBLE_SPACE",Y="TRAILING_SPACE_BEFORE_BLOCK",K="TRAILING_SPACE_IN_BLOCK",J="TRAILING_SPACE_BEFORE_BR",Z="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK",tt="INCLUDED_TRAILING_LINE_BREAK_AFTER_BR";function et(t,e){this.offset=e,this.nodeWrapper=t,this.node=t.node,this.session=t.session,this.cache=new j}a(z.prototype=X,{isCharacterDataNode:U("isCharacterDataNode",c.isCharacterDataNode,"node"),getNodeIndex:U("nodeIndex",c.getNodeIndex,"node"),getLength:U("nodeLength",c.getNodeLength,"node"),containsPositions:U("containsPositions",function(t){return c.isCharacterDataNode(t)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(t.nodeName)},"node"),isWhitespace:U("isWhitespace",B,"node"),isCollapsedWhitespace:U("isCollapsedWhitespace",W,"node"),getComputedDisplay:U("computedDisplay",O,"node"),isCollapsed:U("collapsed",F,"node"),isIgnored:U("ignored",q,"node"),next:U("nextPos",L,"node"),previous:U("previous",$,"node"),getTextNodeInfo:U("textNodeInfo",function(t){var e=null,n=!1,i=I(t.parentNode,"whiteSpace"),o="pre-line"==i;return o?(e=u,n=!0):"normal"!=i&&"nowrap"!=i||(e=s,n=!0),{node:t,text:t.data,spaceRegex:e,collapseSpaces:n,preLine:o}},"node"),hasInnerText:U("hasInnerText",function(t,e){for(var n=this.session,i=n.getPosition(t.parentNode,this.getNodeIndex()+1),o=n.getPosition(t,0),a=e?i:o,s=e?o:i;a!==s;){if(a.prepopulateChar(),a.isDefinitelyNonEmpty())return!0;a=e?a.previousVisible():a.nextVisible()}return!1},"node"),isRenderedBlock:U("isRenderedBlock",function(t){for(var e=t.getElementsByTagName("br"),n=0,i=e.length;n<i;++n)if(!F(e[n]))return!0;return!!t.getElementsByTagName("svg").length||this.hasInnerText()},"node"),getTrailingSpace:U("trailingSpace",function(t){if("br"==t.tagName.toLowerCase())return"";switch(this.getComputedDisplay()){case"inline":for(var e=t.lastChild;e;){if(!q(e))return 1==e.nodeType?this.session.getNodeWrapper(e).getTrailingSpace():"";e=e.previousSibling}break;case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":break;case"table-cell":return"\t";default:return this.isRenderedBlock(!0)?"\n":""}return""},"node"),getLeadingSpace:U("leadingSpace",function(t){switch(this.getComputedDisplay()){case"inline":case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":case"table-cell":break;default:return this.isRenderedBlock(!1)?"\n":""}return""},"node")});var nt={character:"",characterType:"EMPTY",isBr:!1,prepopulateChar:function(){var t=this;if(!t.prepopulatedChar){var e=t.node,n=t.offset,i="",o="EMPTY",a=!1;if(0<n)if(3==e.nodeType){var s=e.data,r=s.charAt(n-1),c=t.nodeWrapper.getTextNodeInfo(),l=c.spaceRegex;c.collapseSpaces?l.test(r)?1<n&&l.test(s.charAt(n-2))||(o=c.preLine&&"\n"===s.charAt(n)?(i=" ",Z):(i=" ",G)):(i=r,o=Q,a=!0):(i=r,o=V,a=!0)}else{var u=e.childNodes[n-1];if(u&&1==u.nodeType&&!F(u)&&("br"==u.tagName.toLowerCase()?(i="\n",t.isBr=!0,a=!(o=G)):t.checkForTrailingSpace=!0),!i){var h=e.childNodes[n];h&&1==h.nodeType&&!F(h)&&(t.checkForLeadingSpace=!0)}}t.prepopulatedChar=!0,t.character=i,t.characterType=o,t.isCharInvariant=a}},isDefinitelyNonEmpty:function(){var t=this.characterType;return t==Q||t==V},resolveLeadingAndTrailingSpaces:function(){if(this.prepopulatedChar||this.prepopulateChar(),this.checkForTrailingSpace){var t=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();t&&(this.isTrailingSpace=!0,this.character=t,this.characterType=G),this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){var e=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();e&&(this.isLeadingSpace=!0,this.character=e,this.characterType=G),this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(t){for(var e=this;e=e.previousVisible();)if(""!==e.getCharacter(t))return e;return null},getCharacter:function(t){this.resolveLeadingAndTrailingSpaces();var e=this.character,n=function(t){var e=t||"",n="string"==typeof e?e.split(""):e;return n.sort(function(t,e){return t.charCodeAt(0)-e.charCodeAt(0)}),n.join("").replace(/(.)\1+/g,"$1")}(t.ignoreCharacters),i=""!==e&&-1<n.indexOf(e);if(this.isCharInvariant)return i?"":e;var o=["character",t.includeSpaceBeforeBr,t.includeBlockContentTrailingSpace,t.includePreLineTrailingSpace,n].join("_"),a=this.cache.get(o);if(null!==a)return a;var s,r,c="",l=this.characterType==G,u=!1,h=this;function d(){return u||(r=h.getPrecedingUncollapsedPosition(t),u=!0),r}return l&&(this.type==tt?c="\n":" "==e&&(!d()||r.isTrailingSpace||"\n"==r.character||" "==r.character&&r.characterType==G)||("\n"==e&&this.isLeadingSpace?d()&&"\n"!=r.character&&(c="\n"):(s=this.nextUncollapsed())&&(s.isBr?this.type=J:s.isTrailingSpace&&"\n"==s.character?this.type=K:s.isLeadingSpace&&"\n"==s.character&&(this.type=Y),"\n"==s.character?this.type==J&&!t.includeSpaceBeforeBr||this.type==Y&&!t.includeSpaceBeforeBlock||this.type==K&&s.isTrailingSpace&&!t.includeBlockContentTrailingSpace||this.type==Z&&s.type==Q&&!t.includePreLineTrailingSpace||("\n"==e?s.isTrailingSpace?this.isTrailingSpace||this.isBr&&(s.type="TRAILING_LINE_BREAK_AFTER_BR",d()&&r.isLeadingSpace&&!r.isTrailingSpace&&"\n"==r.character?s.character="":s.type=tt):c="\n":" "==e&&(c=" ")):c=e))),-1<n.indexOf(c)&&(c=""),this.cache.set(o,c),c},equals:function(t){return!!t&&this.node===t.node&&this.offset===t.offset},inspect:function(){return"[Position("+c.inspectNode(this.node)+":"+this.offset+")]"},toString:function(){return this.character}};a(et.prototype=nt,{next:U("nextPos",function(t){var e,n,i,o=t.nodeWrapper,a=t.node,s=t.offset,r=o.session;return a?(n=s==o.getLength()?(e=a.parentNode)?o.getNodeIndex()+1:0:o.isCharacterDataNode()?(e=a,s+1):(i=a.childNodes[s],r.getNodeWrapper(i).containsPositions()?(e=i,0):(e=a,s+1)),e?r.getPosition(e,n):null):null}),previous:U("previous",function(t){var e,n,i,o=t.nodeWrapper,a=t.node,s=t.offset,r=o.session;return n=0==s?(e=a.parentNode)?o.getNodeIndex():0:o.isCharacterDataNode()?(e=a,s-1):(i=a.childNodes[s-1],r.getNodeWrapper(i).containsPositions()?(e=i,c.getNodeLength(i)):(e=a,s-1)),e?r.getPosition(e,n):null}),nextVisible:U("nextVisible",function(t){var e=t.next();if(!e)return null;var n=e.nodeWrapper,i=e.node,o=e;return n.isCollapsed()&&(o=n.session.getPosition(i.parentNode,n.getNodeIndex()+1)),o}),nextUncollapsed:U("nextUncollapsed",function(t){for(var e=t;e=e.nextVisible();)if(e.resolveLeadingAndTrailingSpaces(),""!==e.character)return e;return null}),previousVisible:U("previousVisible",function(t){var e=t.previous();if(!e)return null;var n=e.nodeWrapper,i=e.node,o=e;return n.isCollapsed()&&(o=n.session.getPosition(i.parentNode,n.getNodeIndex())),o})});var it,ot=null,at=(it=o.isHostProperty(document.documentElement,"uniqueID"),rt.prototype={initCaches:function(){var e;this.elementCache=it?(e=new j,{get:function(t){return e.get(t.uniqueID)},set:function(t){e.set(t.node.uniqueID,t)}}):st("tagName"),this.textNodeCache=st("data"),this.otherNodeCache=st("nodeName")},getNodeWrapper:function(t){var e;if(!t)throw new Error("node is undefined");switch(t.nodeType){case 1:e=this.elementCache;break;case 3:e=this.textNodeCache;break;default:e=this.otherNodeCache}var n=e.get(t);return n||(n=new z(t,this),e.set(n)),n},getPosition:function(t,e){return this.getNodeWrapper(t).getPosition(e)},getRangeBoundaryPosition:function(t,e){var n=e?"start":"end";return this.getPosition(t[n+"Container"],t[n+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}},rt);function st(o){var a=new j;return{get:function(t){var e=a.get(t[o]);if(e)for(var n,i=0;n=e[i++];)if(n.node===t)return n;return null},set:function(t){var e=t.node[o];(a.get(e)||a.set(e,[])).push(t)}}}function rt(){this.initCaches()}function ct(){return ot||(lt(),ot=new at)}function lt(){ot&&ot.detach(),ot=null}function ut(t,n,i,o){i&&(n?F(i.node)&&(i=t.previousVisible()):F(i.node)&&(i=i.nextVisible()));var a,s=t,r=!1,c=!1;return{next:function(){if(c)return c=!1,a;for(var t;e=void 0,e=null,n?(e=s,r||(s=s.previousVisible(),r=!s||i&&s.equals(i))):r||(e=s=s.nextVisible(),r=!s||i&&s.equals(i)),r&&(s=null),t=e;)if(t.getCharacter(o))return a=t;return null;var e},rewind:function(){if(!a)throw e.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");c=!0},dispose:function(){t=i=null}}}a(c,{nextNode:L,previousNode:$});var ht=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var n=0,i=t.length;n<i;++n)if(t[n]===e)return n;return-1};function dt(t,e,n){var r=ut(t,!1,null,e),c=ut(t,!0,null,e),i=n.tokenizer;function o(t){for(var e,n,i=[],o=t?r:c,a=!1,s=!1;e=o.next();){if(n=e.character,d.test(n))s&&(a=!(s=!1));else{if(a){o.rewind();break}s=!0}i.push(e)}return i}var a=o(!0),s=o(!1).reverse(),l=w(s.concat(a),n,i),u=a.length?l.slice(ht(l,a[0].token)):[],h=s.length?l.slice(0,ht(l,s.pop().token)+1):[];return{nextEndToken:function(){for(var t,e;1==u.length&&!(t=u[0]).isWord&&0<(e=o(!0)).length;)u=w(t.chars.concat(e),n,i);return u.shift()},previousStartToken:function(){for(var t,e;1==h.length&&!(t=h[0]).isWord&&0<(e=o(!1)).length;)h=w(e.reverse().concat(t.chars),n,i);return h.pop()},dispose:function(){r.dispose(),c.dispose(),u=h=null}}}function ft(t,e,n,i){var o=t.getRangeBoundaryPosition(e,!0),a=t.getRangeBoundaryPosition(e,!1);return ut(i?a:o,!!i,i?o:a,n)}function pt(t,e,n,i,o){var a,s,r,c,l,u,h=b(o.direction),d=ut(t,h,t.session.getRangeBoundaryPosition(i,h),o.characterOptions),f="",p=[],g=null;function m(t,e){var n=p[t].previousVisible(),i=p[e-1];return{startPos:n,endPos:i,valid:!o.wholeWordsOnly||function(t,e,n){var i=v.createRange(t.node);return i.setStartAndEnd(t.node,t.offset,e.node,e.offset),!i.expand("word",{wordOptions:n})}(n,i,o.wordOptions)}}for(;a=d.next();)if(s=a.character,n||o.caseSensitive||(s=s.toLowerCase()),h?(p.unshift(a),f=s+f):(p.push(a),f+=s),n){if(l=e.exec(f))if(c=(r=l.index)+l[0].length,u){if(!h&&c<f.length||h&&0<r){g=m(r,c);break}}else u=!0}else if(-1!=(r=f.indexOf(e))){g=m(r,r+e.length);break}return u&&(g=m(r,c)),d.dispose(),g}function gt(i){return function(){var t=!!ot,e=[ct()].concat(o.toArray(arguments)),n=i.apply(this,e);return t||lt(),n}}function mt(r,c){return gt(function(t,e,n,i){"undefined"==yt()(n)&&(n=e,e=g),i=k(i,R);var o=r;c&&(o=0<=n,this.collapse(!o));var a=function(t,e,n,i,o){var a,s,r,c,l=0,u=t,h=Math.abs(n);if(0!==n){var d=n<0;switch(e){case g:for(s=ut(t,d,null,i);(a=s.next())&&l<h;)++l,u=a;r=a,s.dispose();break;case m:for(var f=dt(t,i,o),p=d?f.previousStartToken:f.nextEndToken;(c=p())&&l<h;)c.isWord&&(++l,u=d?c.chars[0]:c.chars[c.chars.length-1]);break;default:throw new Error("movePositionBy: unit '"+e+"' not implemented")}d?(u=u.previousVisible(),l=-l):u&&u.isLeadingSpace&&!u.isTrailingSpace&&(e==m&&(r=(s=ut(t,!1,null,i)).next(),s.dispose()),r&&(u=r.previousVisible()))}return{position:u,unitsMoved:l}}(t.getRangeBoundaryPosition(this,o),e,n,i.characterOptions,i.wordOptions),s=a.position;return this[o?"setStart":"setEnd"](s.node,s.offset),a.unitsMoved})}function vt(s){return gt(function(t,e){for(var n,i=ft(t,this,e=r(e,A),!s),o=0;(n=i.next())&&d.test(n.character);)++o;i.dispose();var a=0<o;return a&&this[s?"moveStart":"moveEnd"]("character",s?o:-o,{characterOptions:e}),a})}function bt(i){return gt(function(t,e){var n=!1;return this.changeEachRange(function(t){n=t[i](e)||n}),n})}a(v.rangePrototype,{moveStart:mt(!0,!1),moveEnd:mt(!1,!1),move:mt(!0,!0),trimStart:vt(!0),trimEnd:vt(!1),trim:gt(function(t,e){var n=this.trimStart(e),i=this.trimEnd(e);return n||i}),expand:gt(function(t,e,n){var i=!1,o=(n=k(n,E)).characterOptions;if((e=e||g)!=m)return this.moveEnd(g,1,n);var a,s,r=n.wordOptions,c=t.getRangeBoundaryPosition(this,!0),l=t.getRangeBoundaryPosition(this,!1),u=dt(c,o,r).nextEndToken(),h=u.chars[0].previousVisible();return s=(a=this.collapsed?u:dt(l,o,r).previousStartToken()).chars[a.chars.length-1],h.equals(c)||(this.setStart(h.node,h.offset),i=!0),s&&!s.equals(l)&&(this.setEnd(s.node,s.offset),i=!0),n.trim&&(n.trimStart&&(i=this.trimStart(o)||i),n.trimEnd&&(i=this.trimEnd(o)||i)),i}),text:gt(function(t,e){return this.collapsed?"":function(t,e,n){for(var i,o=[],a=ft(t,e,n);i=a.next();)o.push(i);return a.dispose(),o}(t,this,r(e,A)).join("")}),selectCharacters:gt(function(t,e,n,i,o){var a={characterOptions:o};e=e||l(this.getDocument()),this.selectNodeContents(e),this.collapse(!0),this.moveStart("character",n,a),this.collapse(!0),this.moveEnd("character",i-n,a)}),toCharacterRange:gt(function(t,e,n){var i,o=(e=e||l(this.getDocument())).parentNode,a=c.getNodeIndex(e),s=-1==c.comparePoints(this.startContainer,this.endContainer,o,a),r=this.cloneRange();return{start:i=s?(r.setStartAndEnd(this.startContainer,this.startOffset,o,a),-r.text(n).length):(r.setStartAndEnd(o,a,this.startContainer,this.startOffset),r.text(n).length),end:i+this.text(n).length}}),findText:gt(function(t,e,n){(n=k(n,x)).wholeWordsOnly&&(n.wordOptions.includeTrailingSpace=!1);var i=b(n.direction),o=n.withinRange;o||(o=v.createRange()).selectNodeContents(this.getDocument());var a=e,s=!1;"string"==typeof a?n.caseSensitive||(a=a.toLowerCase()):s=!0;var r=t.getRangeBoundaryPosition(this,!i);-1===o.comparePoint(r.node,r.offset)&&(r=t.getRangeBoundaryPosition(o,!0));for(var c,l=r,u=!1;;){try{c=pt(l,a,s,o,n)}catch(t){return!1}if(c){if(c.valid)return this.setStartAndEnd(c.startPos.node,c.startPos.offset,c.endPos.node,c.endPos.offset),!0;l=i?c.startPos:c.endPos}else{if(!n.wrap||u)return!1;o=o.cloneRange(),l=t.getRangeBoundaryPosition(o,!i),o.setBoundary(r.node,r.offset,i),u=!0}}}),pasteHtml:function(t){if(this.deleteContents(),t){var e=this.createContextualFragment(t),n=e.lastChild;this.insertNode(e),this.collapseAfter(n)}}}),a(v.selectionPrototype,{expand:gt(function(t,e,n){this.changeEachRange(function(t){t.expand(e,n)})}),move:gt(function(t,e,n,i){var o=0;if(this.focusNode){this.collapse(this.focusNode,this.focusOffset);var a=this.getRangeAt(0);(i=i||{}).characterOptions=r(i.characterOptions,S),o=a.move(e,n,i),this.setSingleRange(a)}return o}),trimStart:bt("trimStart"),trimEnd:bt("trimEnd"),trim:bt("trim"),selectCharacters:gt(function(t,e,n,i,o,a){var s=v.createRange(e);s.selectCharacters(e,n,i,a),this.setSingleRange(s,o)}),saveCharacterRanges:gt(function(t,e,n){for(var i=this.getAllRanges(),o=[],a=1==i.length&&this.isBackward(),s=0,r=i.length;s<r;++s)o[s]={characterRange:i[s].toCharacterRange(e,n),backward:a,characterOptions:n};return o}),restoreCharacterRanges:gt(function(t,e,n){this.removeAllRanges();for(var i,o,a,s=0,r=n.length;s<r;++s)a=(o=n[s]).characterRange,(i=v.createRange(e)).selectCharacters(e,a.start,a.end,o.characterOptions),this.addRange(i,o.backward)}),text:gt(function(t,e){for(var n=[],i=0,o=this.rangeCount;i<o;++i)n[i]=this.getRangeAt(i).text(e);return n.join("")})}),v.innerText=function(t,e){var n=v.createRange(t);return n.selectNodeContents(t),n.text(e)},v.createWordIterator=function(t,e,n){var i=ct();n=k(n,T);var o=dt(i.getPosition(t,e),n.characterOptions,n.wordOptions),a=b(n.direction);return{next:function(){return a?o.previousStartToken():o.nextEndToken()},dispose:function(){o.dispose(),this.next=function(){}}}},v.noMutation=function(t){t(ct()),lt()},v.noMutation.createEntryPointFunction=gt,v.textRange={isBlockNode:function(t){return t&&(1==t.nodeType&&!/^(inline(-block|-table)?|none)$/.test(O(t))||9==t.nodeType||11==t.nodeType)},isCollapsedWhitespaceNode:W,createPosition:gt(function(t,e,n){return t.getPosition(e,n)})}});var U,z,X,Q,V,G,Y,K,J,Z,tt,et,nt,it,ot,at=j,st=n(3),rt=n.n(st),ct={jquery:rt.a,rangy:at,articleNode:null,sectionNodes:null,paragraphNodes:null,selectionApplier:null,selectionHighlighter:null,selection:null,selectionSaved:null,lastSelectionSaved:null,highlighter:null,highlightClasses:[],hoverHighlighter:null,hoverAnnotation:null,hoverAnnotationLock:!1,searchResultApplier:null,searchResultTimer:null,events:{},rectHighlighter:null,selectionLock:!1},lt=n(0),ut=n.n(lt),ht=n(1),dt=n.n(ht),ft={props:["lib","status"],data:function(){return ct},computed:{},watch:{},mounted:function(){this._initRangy(),this._initAnchorPosition(),this._initOnSelectEventListener(),this._initHighlighter()},destroyed:function(){this.removeHighlights(),this.selectionHighlighter.removeAllHighlights(),this.hoverHighlighter.removeAllHighlights(),this.rectHighlighter.removeAllHighlights()},methods:{_initRangy:function(){this.rangy.init()}}};(U=ft).computed.isPinned=function(){return 0<this.selectionHighlighter.highlights.length},U.computed.rangyConfig=function(){var t={};return"object"===yt()(this.status)&&"object"===yt()(this.status.readingConfig)&&(t.articleSelector=this.status.readingConfig.selector.article,t.sectionSelector=this.status.readingConfig.selector.section,t.annotationTypeModules=this.status.readingConfig.annotationTypeModules),t},ft.watch["status.search.keyword"]=function(t){var e=this;clearTimeout(this.searchResultTimer),this.searchResultTimer=setTimeout(function(){e.searchInArticle(t)},100)},(z=ft).methods._getAnchorPositionFromElement=function(t,e){var n,i,o=this.highlighter.getHighlightsForElement(t);if(null===o)return null;if(o.forEach(function(t){var e=t.getText();(!n||i>e.length)&&(n=t,i=e.length)}),n){var a={},s=n.characterRange.start,r=n.characterRange.end,c=n.containerElementId;void 0===a[c]?a[c]={start_pos:s,end_pos:r,paragraph_id:c}:(s<a[c].start_pos&&(a[c].start_pos=s),r>a[c].end_pos&&(a[c].end_pos=r));var l=[];for(var u in a)l.push(a[u]);return{anchorPositions:l,event:e}}},z.methods.getAnchorTextArrayFromAnnotation=function(t){return t.anchorPositions.map(function(t){if(t.anchor_text)return t.anchor_text;if(!t.paragraph_id||"number"!=typeof t.start_pos||"number"!=typeof t.end_pos)throw new Error("Anchor Positions is not well defined.\n"+JSON.stringify(t,null,2));var e,n=t.start_pos,i=t.end_pos,o=t.paragraph_id,a=document.getElementById(o);return e=0<n?a.innerText.slice(n,i):a.innerText.slice(0,i-1),t.anchor_text=e})},z.methods.getAnchorTextFromSelection=function(){return this.rangy.getSelection().toString()},z.methods.getRectFromAnchorPositions=function(t){if(t&&!1!==Array.isArray(t)&&0!==t.length){if("section"===t[0].type)return this.getRectFromSection(t[0].section_id);var e=this.rangy.saveSelection(),n=t.map(function(t,e){return[t.start_pos,t.end_pos,e+1,"pacor-rect",t.paragraph_id].join("$")});n.unshift("type:textContent");var i=n.join("|");this.rectHighlighter.deserialize(i);var o=this.rectHighlighter.highlights[0].getRange().getBoundingDocumentRect();return this.rectHighlighter.removeAllHighlights(),this.rangy.restoreSelection(e),o}},z.methods.getSectionAnnotationElement=function(t){if(!t)throw new Error("Annotation is undefined");var e=t.id,n=rt()('.SectionPanel > .SectionAnnotationList .AnnotationItem[data-annotation-id="'.concat(e,'"]:first'));if(0!==n.length)return n},z.methods.getRectFromSectionAnnotation=function(t){var e=this.getSectionAnnotationElement(t);if(e){var n=e.offset(),i=e.width(),o=e.height(),a={bottom:n.top+o,height:o,left:n.left,right:n.left+i,top:n.top,width:i};return a.middle=a.top+a.height/2,a.center=a.left+a.width/2,a}},z.methods.getAnchorPositionsFromSelection=function(c){var l=this;if(!c)return null;var t=this.rectHighlighter.highlightSelection("pacor-rect",{exclusive:!1,containerElementId:c.anchorParagraphIds,selection:c}),u=[];t.forEach(function(t){for(var e=t.containerElementId,n=0;n<c.anchorPositions.length;n++){var i=c.anchorPositions[n];if(i.paragraph_id===e){var o=l._getAnchorPositionFromHighlight(t),a=o.start_pos,s=o.end_pos,r=o.anchor_text;i.start_pos=a,i.end_pos=s,i.anchor_text=r,i.type="textContent",u.push(i);break}}}),c.anchorPositions=u;var e=this.rangy.saveSelection();return this.rectHighlighter.removeAllHighlights(),this.rangy.restoreSelection(e),c.anchorPositions},z.methods.getRectFromSection=function(t){var e='[data-pacor-section-seq-id="'.concat(t,'"]'),n=document.querySelector(e);if(n)return{top:n.offsetTop,height:n.offsetHeight,bottom:n.offsetTop+n.offsetHeight,left:n.offsetLeft,width:n.offsetWidth,right:n.offsetLeft+n.offsetWidth,center:n.offsetLeft+n.offsetWidth/2,middle:n.offsetTop+n.offsetHeight/2}},(X=ft).methods._initHighlighter=function(){var r=this;if("object"!==yt()(this.rangyConfig.annotationTypeModules))return!1;var c=[];function e(t,e,n){if(o[n]&&!0===o[n])return null;var i=r._getAnchorPositionFromElement(t,e);if(!i)return null;o[n]=!0,r.triggerEvent(n,i),setTimeout(function(){o[n]=!1},0)}this.highlighter=this.rangy.createHighlighter();var n,o={},l={ignoreWhiteSpace:!0,tagNames:["span","a","b","img"],elementAttributes:{"data-pacor-highlight":""},elementProperties:{onclick:function(t){e(this,t,"highlightClick")},ontouch:function(t){e(this,t,"highlightClick")},onmouseover:function(t){e(this,t,"highlightMouseover")},onmouseout:function(t){e(this,t,"highlightMouseout")},onmousedown:function(t){e(this,t,"highlightMousedown")},onmousemove:function(t){e(this,t,"highlightMousemove")},onmouseup:function(t){e(this,t,"highlightMouseup")},ontouchstart:function(t){e(this,t,"highlightMousedown")},ontouchend:function(t){e(this,t,"highlightMouseup")}}};["my","others"].forEach(function(t){for(var e in r.rangyConfig.annotationTypeModules){var n=t+"-"+e,i=r.rangy.createClassApplier(n,l);r.highlighter.addClassApplier(i),r.highlightClasses.push(n);var o=r.rangyConfig.annotationTypeModules[e];if("object"===yt()(o.style)&&"object"===yt()(o.style.highlight)&&"string"==typeof o.style.highlight[t]){var a=o.style.highlight[t];if("string"==typeof a){var s="[data-pacor-section-seq-id] [data-pacor-paragraph-seq-id] .".concat(n);c.push("".concat(s," {").concat(a,"}"))}}}}),0<c.length&&(0<window.document.styleSheets.length?n=window.document.styleSheets[0]:((n=document.createElement("style")).type="text/css",document.head.appendChild(n)),c.reverse(),c.forEach(function(t){n.insertRule(t,n.cssRules.length)}))},X.methods._getAnchorPositionFromHighlight=function(t){if(void 0!==t){var e=t.characterRange.start,n=t.characterRange.end,i=document.getElementById(t.containerElementId);return{start_pos:e,end_pos:n,anchor_text:0<e?i.innerText.slice(e,n):i.innerText.slice(0,n-1)}}},X.methods.highlightPinnedSelection=function(t,e,n){return-1!==this.highlightClasses.indexOf(t)&&null!==this.selectionSaved&&(this.rangy.restoreSelection(this.selectionSaved),this.highlighter.highlightSelection(t,{exclusive:!1,containerElementId:e}),!1!==n&&(this.rangy.getSelection().removeAllRanges(),this.selectionSaved=null,this.unpinSelection()),this)},X.methods.removeMyHighlights=function(){this.highlighter.highlights=this.highlighter.highlights.filter(function(t){return!t.classApplier.className.startsWith("my-")||(t.unapply(),!1)})},X.methods.removeHighlights=function(){this.highlighter.removeAllHighlights()},X.methods.removeHighlightByAnnotation=function(a){var s=this.lib.auth.getHighlightAnnotationType(a);if(-1===this.highlightClasses.indexOf(s))return!1;var r=[];this.highlighter.highlights.forEach(function(t){for(var e=t.characterRange,n=t.classApplier.className,i=0;i<a.anchorPositions.length;i++){var o=a.anchorPositions[i];if(s===n&&t.containerElementId===o.paragraph_id&&e.start===o.start_pos&&e.end===o.end_pos){t.unapply(),r.push(t);break}}}),this.highlighter.highlights=this.highlighter.highlights.filter(function(t){return-1===r.indexOf(t)}),this.unpinSelection(),this.hoverOut(!0)},X.methods.removeHighlightFromPinnedSelection=function(t){return-1!==this.highlightClasses.indexOf(t)&&null!==this.selectionSaved&&(this.rangy.restoreSelection(this.selectionSaved),this.highlighter.unhighlightSelection([t]),null!==this.selection&&this.selection.removeAllRanges(),this.unpinSelection(),this)},X.methods._highlightToAnchorPosition=function(t){var e=t.characterRange;return{start_pos:e.start,end_pos:e.end,paragraph_id:t.containerElementId}},X.methods._annotationToHighlighString=function(t,e){var n=this;if(null==t)return"";!1===Array.isArray(t)&&(t=[t]);var i=[],o=0;return t.forEach(function(t){void 0===e&&(e=t.type,e=t.user_id===n.status.userID?"my-"+e:"others-"+e),t.anchorPositions.forEach(function(t){o++,i.push([t.start_pos,t.end_pos,o,e,t.paragraph_id].join("$"))})}),i.unshift("type:textContent"),i=i.join("|")},X.methods.deserialize=function(){var n=dt()(ut.a.mark(function t(e,n){return ut.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return"string"!=typeof e&&(e=this._annotationToHighlighString(e)),this.highlighter.deserializeAsync(e,n),t.abrupt("return",this);case 3:case"end":return t.stop()}},t,this)}));return function(t,e){return n.apply(this,arguments)}}(),X.methods.deserializeAppend=function(){var e=dt()(ut.a.mark(function t(e){return ut.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.deserialize(e,{append:!0});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),(Q=ft).methods.glowSectionAnnotation=function(t){if(this.lib.AnnotationHelper.isPublicSectionAnnotation(t)){var e=this.getSectionAnnotationElement(t);return e&&e.transition("glow"),!0}},Q.methods.hoverIn=function(e,n){var i=this;return this.hoverAnnotation===e?(!0!==n&&this.hoverOut(),this.hoverAnnotationLock=n,!1):(this.hoverOut(),setTimeout(function(){var t=i._annotationToHighlighString(e,"pacor-hover");i.hoverHighlighter.deserialize(t),i.hoverAnnotation=e,i.hoverAnnotationLock=n},0),this)},Q.methods.hoverOut=function(t){return!0===t&&(this.hoverAnnotationLock=!1),!0!==this.hoverAnnotationLock&&(this.hoverHighlighter.removeAllHighlights(),this.hoverAnnotation=null,this)},Q.methods.getHoverAnchorText=function(){var t=this.hoverHighlighter.highlights[0];return this._getAnchorPositionFromHighlight(t).anchor_text},(V=ft).methods._initSearch=function(){var t=this.rangy.modules.ClassApplier;if(!(this.rangy.supported&&t&&t.supported))return!1;this.searchResultApplier=this.rangy.createClassApplier("pacor-search-result")},V.methods.searchInArticle=function(){var e=dt()(ut.a.mark(function t(n){var i=this;return ut.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.jquery(".pacor-search-result").removeClass("pacor-search-result"),""===n)return t.abrupt("return",!1);t.next=3;break;case 3:G||(G=this.rangy.createRange(),Y=this.rangy.createRange(),K=this.articleNode.find("[data-pacor-section-seq-id]"),J={caseSensitive:!1,wholeWordsOnly:!1,withinRange:Y,direction:"forward"},this._initSearch()),K.each(function(t,e){for(G.selectNodeContents(e);G.findText(n,J);)i.searchResultApplier.applyToRange(G),G.collapse(!1)});case 5:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}(),(Z=ft).methods.onselect=function(){var o=this.rangy.getSelection();if(0<o.toString().length&&!1===o.isCollapsed){var t=o.getRangeAt(0).cloneRange().getBoundingDocumentRect();o.rect=t,o.anchorPositions=[],o.anchorParagraphIds=[];var e=this._getNodesInRange(o.getAllRanges()),a=[];if(e.forEach(function(t){if("function"==typeof t.getAttribute&&"undefined"!==t.getAttribute("data-pacor-highlight")&&t.classList.forEach(function(t){(t.startsWith("my-")||t.endsWith("others-"))&&-1===a.indexOf(t)&&a.push(t)}),"function"==typeof t.getAttribute||"string"!=typeof t.wholeText||0===t.wholeText.trim().length)return!1;var e,n,i={};return 1===(e=void 0!==(t=rt()(t)).attr("data-pacor-section-seq-id")?t:t.parents("[data-pacor-section-seq-id]:first")).length&&(i.section_id=parseInt(e.attr("data-pacor-section-seq-id"),10),1===(n=void 0!==t.attr("data-pacor-paragraph-seq-id")?t:t.parents("[data-pacor-paragraph-seq-id]:first")).length&&(i.seq_id=parseInt(n.attr("data-pacor-paragraph-seq-id"),10),i.paragraph_id=n.attr("id"),!(-1<o.anchorParagraphIds.indexOf(i.paragraph_id))&&(o.anchorParagraphIds.push(i.paragraph_id),void o.anchorPositions.push(i))))}),0===o.anchorPositions.length)return!1;o.highlights=a,this.triggerEvent("select",o),this.selection=o}else null!==this.selection&&(this.selection=null,this.triggerEvent("selectcollapsed"))},Z.methods._getNextNode=function(t){if(t.firstChild)return t.firstChild;for(;t;){if(t.nextSibling)return t.nextSibling;t=t.parentNode}},Z.methods._getNodesInRange=function(t){var a=this,s=[];return!1===Array.isArray(t)&&(t=[t]),t.forEach(function(t){var e,n=t.startContainer,i=t.endContainer,o=t.commonAncestorContainer;for(e=n.parentNode;e&&(s.push(e),e!==o);e=e.parentNode);for(s.reverse(),e=n;e&&(s.push(e),e!==i);e=a._getNextNode(e));}),s},Z.methods.pinSelection=function(){var r=this;if(this.unpinSelection(),null===this.selection||!1===Array.isArray(this.selection.anchorPositions)||!1===Array.isArray(this.selection.anchorParagraphIds))return!1;this.selectionSaved=this.rangy.saveSelection();var c=this.selectionHighlighter.highlightSelection("pacor-selection",{exclusive:!1,containerElementId:this.selection.anchorParagraphIds});return this.selection.anchorPositions.forEach(function(t,e){var n=c[e],i=r._getAnchorPositionFromHighlight(n),o=i.start_pos,a=i.end_pos,s=i.anchor_text;t.start_pos=o,t.end_pos=a,t.anchor_text=s,t.type="textContent"}),this.selection.removeAllRanges(),this.selection},Z.methods.unpinSelection=function(t){return this.selectionHighlighter.removeAllHighlights(),this.jquery(".pacor-selection").removeClass("pacor-selection"),this.hoverOut(!0),!0!==t||null===this.selectionSaved||0===this.rangy.getSelection().toString().length&&(this.rangy.restoreSelection(this.selectionSaved),this.selectionSaved=null),this},Z.methods.getPinSelectionAnchorText=function(){var t=this.selectionHighlighter.highlights[0];return t?this._getAnchorPositionFromHighlight(t).anchor_text:this.getAnchorTextFromSelection()},Z.methods.cancelSelection=function(){this.rangy.getSelection().removeAllRanges(),this.triggerEvent("selectcollapsed")},Z.methods.isSelecting=function(){return""!==this.rangy.getSelection().toString()},(tt=ft).methods.addEventListener=function(t,e){var n=this;return"function"==typeof e&&(Array.isArray(t)?t.forEach(function(t){n.addEventListenser(t,e)}):(!1===Array.isArray(this.events[t])&&(this.events[t]=[]),this.events[t].push(e)),this)},tt.methods.triggerEvent=function(){var n=dt()(ut.a.mark(function t(e,n){var i,o;return ut.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!Array.isArray(this.events[e])){t.next=9;break}i=this.events[e],o=0;case 3:if(o<i.length)return t.next=6,i[o](n);t.next=9;break;case 6:o++,t.next=3;break;case 9:case"end":return t.stop()}},t,this)}));return function(t,e){return n.apply(this,arguments)}}(),ft.methods.reloadMyHighlights=dt()(ut.a.mark(function t(){var e,n;return ut.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.removeMyHighlights(),e={},t.next=4,this.lib.AxiosHelper.get("/client/Highlight/highlightsMy",e);case 4:0!==(n=t.sent)&&this.deserializeAppend(n);case 6:case"end":return t.stop()}},t,this)})),(et=ft).methods.highlightPinnedSelectionFromAnnotation=function(t){if("textContent"!==t.anchorPositions[0].type)return null;var e=t.anchorPositions.map(function(t){return t.paragraph_id});this.highlightPinnedSelection("my-"+t.type,e)},et.methods.getSerializedHighlightsFromAnnotation=function(t){var e=this.lib.AnnotationHelper.highlightType(t);return this.getSerializedHighlightsFromAnchorPositions(e,t.anchorPositions)},et.methods.getSerializedHighlightsFromAnchorPositions=function(n,t){var e=t.map(function(t,e){return[t.start_pos,t.end_pos,e+1,n,t.paragraph_id].join("$")});return e.unshift("type:textContent"),e.join("|")},(nt=ft).methods.selectRandomRange=dt()(ut.a.mark(function t(){var e,n,i,o,a,s,r,c,l,u,h=this;return ut.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=rt()("[data-pacor-paragraph-seq-id]"),n=Math.floor(Math.random()*e.length),i=e.eq(n),o=i[0],this.lib.style.scrollIntoView(o,{behavior:"smooth"}),(a=i.text().trim().length)<3)return t.next=9,this.selectRandomRange();t.next=10;break;case 9:return t.abrupt("return",t.sent);case 10:for((s=Math.floor(Math.random()*a)-10-3)<0&&(s=0),r=s+Math.floor(10*Math.random())+3,a<=r&&(r=9);s===r;)r=Math.floor(Math.random()*a);return c=Math.min(s,r),l=Math.max(s,r),(u=this.rangy.createRange()).selectCharacters(o,c,l),this.rangy.getSelection().addRange(u),t.abrupt("return",new Promise(function(e,t){setTimeout(dt()(ut.a.mark(function t(){return ut.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!1===h.isSelecting())return t.next=3,h.selectRandomRange();t.next=6;break;case 3:e(!0),t.next=8;break;case 6:e(!0),h.onselect();case 8:case"end":return t.stop()}},t)})),1e3)}));case 23:case"end":return t.stop()}},t,this)})),nt.methods.selectDemoText=dt()(ut.a.mark(function t(){var n,e,i,o,a,s,r,c=this;return ut.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return 0===(n=rt()("[data-pacor-paragraph-seq-id]:eq(1)")).length&&(n=rt()("[data-pacor-paragraph-seq-id]:first")),e=n[0],i=n.text().trim().length,(o=Math.floor(Math.random()*i)-3)<0&&(o=0),o+=30,a=Math.floor(3*Math.random())+3,i<(s=o+a)&&(s=i),(r=this.rangy.createRange()).selectCharacters(e,o,s),this.rangy.getSelection().addRange(r),t.abrupt("return",new Promise(function(t,e){setTimeout(function(){c.onselect(),it=c.rangy.saveSelection(),t(n)},1e3)}));case 14:case"end":return t.stop()}},t,this)})),nt.methods.restoreLastSelectDemoText=dt()(ut.a.mark(function t(){var n=this;return ut.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isSelecting())return this.cancelSelection(),t.next=4,this.lib.VueHelper.sleep(100);t.next=4;break;case 4:return this.rangy.restoreSelection(it),t.abrupt("return",new Promise(function(t,e){setTimeout(function(){n.onselect(),it=n.rangy.saveSelection(),t(!0)},1e3)}));case 6:case"end":return t.stop()}},t,this)})),(ot=ft).methods._initOnSelectEventListener=function(){function t(){if(!0===e.selectionLock)return!1;setTimeout(function(){e.onselect()},0)}var e=this;document.body.addEventListener("keyup",t),document.body.addEventListener("mouseup",t),document.body.addEventListener("mousedown",t),document.body.addEventListener("contextmenu",t),document.body.addEventListener("touchend",t),this._initSelectionApplier()},ot.methods._initSelectionApplier=function(){var t=this.rangy.modules.ClassApplier;if(this.rangy.supported&&t&&t.supported){var e={tagNames:["span","a","b","img"],ignoreWhiteSpace:!0},n=this.rangy.createClassApplier("pacor-selection",e);this.selectionHighlighter=this.rangy.createHighlighter(),this.selectionHighlighter.addClassApplier(n);var i=this.rangy.createClassApplier("pacor-hover",e);this.hoverHighlighter=this.rangy.createHighlighter(),this.hoverHighlighter.addClassApplier(i);var o=this.rangy.createClassApplier("pacor-rect",e);this.rectHighlighter=this.rangy.createHighlighter(),this.rectHighlighter.addClassApplier(o)}},ot.methods._initAnchorPosition=function(){if(null!==document.querySelector("[data-pacor-section-seq-id]"))return!1;for(var t=0;t<this.rangyConfig.articleSelector.length;t++){var e=rt()(this.rangyConfig.articleSelector[t]);if(0<e.length){this.articleNode=e;break}}if(null===this.articleNode)throw this.$t("Cannot found any article node.");for(var n=this.articleNode.children(),i=0;i<this.rangyConfig.sectionSelector.length;i++){var o=n.filter(this.rangyConfig.sectionSelector[i]);if(0<o.length){this.sectionNodes=o;break}}if(null===this.sectionNodes)throw this.$t("Cannot found any section node.");this.sectionNodes.each(function(t,e){e.setAttribute("data-pacor-section-seq-id",t)}),this.sectionNodes.children().each(function(t,e){if(e.setAttribute("data-pacor-paragraph-seq-id",t),"string"!=typeof e.id||""===e.id){var n="pacor-paragraph-id-"+t;e.setAttribute("id",n)}})};var pt=ft,gt=(n(512),n(2)),mt=Object(gt.a)(pt,i,[],!1,null,null,null);mt.options.__file="webpack-app/client/Reading/components/annotation/RangyManager/RangyManager.vue";e.default=mt.exports},function(t,e,n){"use strict";n.r(e);function i(){var t=this,e=t.$createElement,n=t._self._c||e;return n("fragment",[t.isLoaded?n("annotation-type-selector",{ref:"AnnotationTypeSelector",attrs:{config:t.config,status:t.status,lib:t.lib}}):t._e(),t._v(" "),t.isLoaded?n("annotation-float-widget",{ref:"AnnotationFloatWidget",attrs:{config:t.config,status:t.status,lib:t.lib}}):t._e()],1)}i._withStripped=!0;function o(){var n=this,t=n.$createElement,i=n._self._c||t;return i("div",{ref:"Selector",staticClass:"annotation-type-selector"},[i("vue-fab",{ref:"fab",attrs:{mainBtnColor:"white",mainColor:"#666",size:"big",iconType:"SemanticUI",activeIcon:"angle down",clickAutoCloseType:"fab",position:n.computedFABPosition,verticalMargin:"10em",hideOnStart:!0,activeIconRotate:!1,transitionEnable:!1,scrollAutoShow:!1,scrollAutoHide:!1,clickOutsideCloseMenu:!1,autoOpenMenu:!0}},[n._l(n.annotationModules,function(e,t){return i("fab-item",{key:e.type,class:e.type,attrs:{idx:t,title:n.$t("ANNOTATION_TYPE."+e.type),icon:e.style.button.icon,btnColor:e.style.button.backgroundColor},on:{clickItem:function(t){return n.addAnnotation(e.type)}}})}),n._v(" "),n.enableList?i("fab-item",{attrs:{icon:"list",idx:n.annotationModules.length,title:n.$t("List Annotations")},on:{clickItem:n.list}}):n._e()],2)],1)}var a=n(0),s=n.n(a),r=n(1),c=n.n(r);o._withStripped=!0;var l=n(4),u=n.n(l),h=n(3),d=n.n(h),f={props:["status","config","lib"],data:function(){return this.$i18n.locale=this.config.locale,{timer:null,selection:null,anchorPositions:null,anchorParagraphIds:null,isTutorialMode:!1}},watch:{selection:function(){if(!0===this.isTutorialMode)return!1;var t=this.$refs.fab;clearTimeout(this.timer),null!==this.selection?this.timer=setTimeout(function(){t.onOffFab(!0)},100):this.timer=setTimeout(function(){t.onOffFab(!1)},100)}},computed:{annotationModules:function(){var n=[],t=this.lib.auth.currentStep;if("string"==typeof t){var i=this.status.readingConfig;if("object"===u()(i)){var e=i.readingProgressModules[t].highlightAnnotation.types;Array.isArray(e)&&e.forEach(function(t){var e=i.annotationTypeModules[t];"object"===u()(e)&&!0===e.addable&&(e.type=t,n.push(e))})}}return n.reverse(),n},computedFABPosition:function(){return!0===this.lib.style.isLeftHanded?"bottom-left":"bottom-right"},enableList:function(){return null!==this.selection&&0<this.selection.highlights.length}},mounted:function(){this.initRangyEvent()},methods:{initRangyEvent:function(){var e=this,t=this.lib.RangyManager;t.addEventListener("select",function(t){if(!1===e.lib.AnnotationPanel.isHide)return!1;e.selection=t,e.anchorPositions=t.anchorPositions,e.anchorParagraphIds=t.anchorParagraphIds}),t.addEventListener("selectcollapsed",function(t){if(!0===e.isTutorialMode)return!1;e.selection=null}),this.setupTutorial()},addAnnotation:function(t){var e=this;if(0===this.selection.anchorPositions.length&&(this.selection.anchorPositions=this.anchorPositions),0===this.selection.anchorParagraphIds.length&&(this.selection.anchorParagraphIds=this.anchorParagraphIds),!this.selection)return null;if(this.isTutorialMode){var n={anchorPositions:[],type:t};return this.lib.AnnotationPanel.setAnnotation(n),this.selection=null,!1}console.log({sa:this.selection.anchorPositions});var i=this.lib.RangyManager.getAnchorPositionsFromSelection(this.selection);console.log({ap:i});var o={anchorPositions:i,type:t};try{this.lib.AnnotationHelper.validate(o)}catch(t){return console.error(t),this.selection=null}this.lib.RangyManager.pinSelection(this.selection),this.lib.AnnotationPanel.setAnnotation(o,{cancel:function(){e.lib.RangyManager.unpinSelection(!0)}}),this.selection=null},list:function(){var t=this.lib.RangyManager.getAnchorPositionsFromSelection(this.selection);this.lib.AnnotationPanel.setAnchorPositions(t),this.lib.RangyManager.cancelSelection()},_testAdd:function(){var t={anchorPositions:[{seq_id:0,paragraph_id:"pacor-paragraph-id-4",start_pos:5,end_pos:8}],type:"MainIdea"};this.lib.AnnotationPanel.setAnnotation(t)}}};f.methods.setupTutorial=function(){var i=this;if("IndividualReading"!==this.lib.auth.currentStep)return!1;var t,e,n,o=d()(this.$el);this.lib.TutorialManager.addAction({element:(t=c()(s.a.mark(function t(){var e;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i.isTutorialMode=!0,i.lib.RangyManager.restoreLastSelectDemoText(),e=o.find(".fab-container,.fabMask,.fab-item-title"),t.abrupt("return",e);case 4:case"end":return t.stop()}},t)})),function(){return t.apply(this,arguments)}),content:this.$t("Select an annotation type to highlight the selected text."),order:21,scroll:!1}),this.lib.TutorialManager.addAction({element:(n=c()(s.a.mark(function t(){var e,n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return!1===i.lib.RangyManager.isSelecting()&&i.lib.RangyManager.restoreLastSelectDemoText(),e=o.find(".MainIdea > .fabMask:first"),t.next=4,i.lib.TutorialManager.showClick(e);case 4:return n=o.find(".MainIdea > .fabMask,.MainIdea > .fab-item-title"),t.abrupt("return",n);case 6:case"end":return t.stop()}},t)})),function(){return n.apply(this,arguments)}),content:this.$t('For example, if you choose "Main Idea" type.'),order:22,afterClick:(e=c()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:!1===i.lib.RangyManager.isSelecting()&&i.lib.RangyManager.restoreLastSelectDemoText(),i.addAnnotation("MainIdea"),i.isTutorialMode=!1;case 3:case"end":return t.stop()}},t)})),function(){return e.apply(this,arguments)}),scroll:!1})};var p=f,g=(n(579),n(2)),m=n(581),v=Object(g.a)(p,o,[],!1,null,"4249dfa8",null);"function"==typeof m.default&&Object(m.default)(v),v.options.__file="webpack-app/client/Reading/components/annotation/AnnotationManager/AnnotationTypeSelector/AnnotationTypeSelector.vue";function b(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"annotation-float-widget AnnotationFloatWidget",class:e.computedContainerClassNames},[e.isFixed?n("div",{staticClass:"close-container floating ui black label",on:{click:function(t){return t.stopPropagation(),e.reset(t)}}},[n("i",{staticClass:"close icon"})]):e._e(),e._v(" "),0<e.annotationCount?n("div",{staticClass:"ui tertiary segment"},[n("annotation-item",{attrs:{config:e.config,status:e.status,lib:e.lib,mode:"full",annotation:e.annotation,findAnnotation:e.viewAnnotation,findUser:e.findUser,findType:e.findType},on:{comment:e.viewAnnotationComment}}),e._v(" "),n("div",{staticClass:"ui column grid footer-row"},[n("div",{staticClass:"column",class:e.computedButtonsClassNames},[n("user-avatar-icons",{staticStyle:{"margin-right":"0.5em"},attrs:{config:e.config,status:e.status,lib:e.lib,users:e.users,userCount:e.userCount},on:{find:e.findUser}}),e._v(" "),e._l(e.types,function(t){return n("annotation-type-button",{key:t.type,attrs:{lib:e.lib,config:e.config,status:e.status,type:t.type,count:t.count},on:{find:e.findType}})}),e._v(" "),e.isFixed?n("button",{staticClass:"ui mini white basic button list-button",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),e.list(t)}}},[e._v("\r\n          "+e._s(e.$t("List all {0} annotations...",[e.annotationCount]))+"\r\n        ")]):e._e()],2)])],1):e._e()])}var y=v.exports;b._withStripped=!0;var C,w,A,S,_,x={props:["lib","status","config"],data:function(){return this.$i18n.locale=this.config.locale,{anchorPositions:null,triggerEvent:null,isFixed:!1,isFixedMouseout:!1,annotation:null,annotationCount:0,users:[],userCount:0,types:[],lastPosition:null}},computed:{},watch:{},mounted:function(){this.initRangyEvents()},destroyed:function(){this.lib.RangyManager.hoverOut()},methods:{}};(C=x).computed.computedContainerClassNames=function(){if(null===this.anchorPositions)return this.lastPosition;var t=[];t.push("show");var e=window.innerHeight;return this.triggerEvent.clientY<e/2?(t.push("bottom"),this.lastPosition="bottom"):this.lastPosition="top",this.lib.RangyManager.isSelecting()&&t.push("selecting"),!1===this.lib.style.isEnableAnimte&&t.push("disable-animate"),0<t.length?t.join(" "):void 0},C.computed.computedButtonsClassNames=function(){var t=[];return!0===this.lib.style.isLeftHanded?t.push("left-handed"):t.push("right aligned"),t.join(" ")},x.watch.anchorPositions=function(){this.load()},(w=x).methods.load=c()(s.a.mark(function t(){var e,n,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.lib.auth.stepHighlightAnnotationConfig){t.next=2;break}return t.abrupt("return",!1);case 2:if(this.anchorPositions){t.next=4;break}return t.abrupt("return",!1);case 4:return this.annotationCount=0,this.annotation=null,this.users=[],this.userCount=0,this.types=[],e={anchorPositions:this.anchorPositions},this.lib.AnnotationHelper.filter(e),t.next=14,this.lib.AxiosHelper.post("client/Annotation/floatWidget",e);case 14:if(null===(n=t.sent))return t.abrupt("return",!1);t.next=17;break;case 17:for(i in n)this[i]=n[i];0===this.annotationCount&&console.log("no annotation");case 19:case"end":return t.stop()}},t,this)})),w.methods.viewAnnotation=function(t){this.lib.AnnotationPanel.setAnnotation(t),this.reset()},w.methods.viewAnnotationComment=function(t){this.lib.AnnotationPanel.setAnnotation(t),this.lib.AnnotationPanel.focusCommentInput(),this.reset()},w.methods.findUser=function(t){this.lib.AnnotationPanel.findUser(t),this.list()},w.methods.findType=function(t){this.lib.AnnotationPanel.findType(t),this.list()},w.methods.list=function(){this.lib.AnnotationPanel.setAnchorPositions(this.anchorPositions),this.reset()},w.methods.reset=function(){this.anchorPositions=null,this.isFixed=!1},_=!1,(A=x).methods.initRangyEvents=function(){var e=this;(S=this.lib.RangyManager).addEventListener("highlightClick",function(t){e.rangyEventClick(t)}),S.addEventListener("highlightMousemove",function(t){e.rangyEventMousemove(t)}),S.addEventListener("highlightMouseover",function(t){e.rangyEventMouseover(t)}),S.addEventListener("highlightMouseout",function(t){e.rangyEventMouseout(t)})},A.methods.rangyEventClick=function(t){if(!1===this.lib.AnnotationPanel.isHide)return!1;!0===_?!0===this.isFixed&&!0===this.isFixedMouseout?(this.triggerEvent=t.event,this.anchorPositions=t.anchorPositions,this.isFixedMouseout=!1):this.isFixed=!this.isFixed:(this.triggerEvent=t.event,this.anchorPositions=t.anchorPositions)},A.methods.rangyEventMouseover=function(t){return!0!==S.isSelecting()&&!1!==this.lib.AnnotationPanel.isHide&&!0!==this.isFixed&&(this.triggerEvent=t.event,this.anchorPositions=t.anchorPositions,void(_=!0))},A.methods.rangyEventMouseout=function(t){return!1!==this.lib.AnnotationPanel.isHide&&(!0===this.isFixed?!(this.isFixedMouseout=!0):(this.anchorPositions=null,void(_=!1)))},A.methods.rangyEventMousemove=function(t){if(!1===S.isSelecting())return!1;this.anchorPositions=null,_=!1,this.isFixed=!1,this.isFixedMouseout=!0},A.methods.rangyEventSelect=function(t){!0===this.isFixed&&(this.isFixed=!1,this.anchorPositions=null,_=!1)},A.methods.rangyEventSelectcollapsed=function(t){};var R=x,E=(n(582),n(584)),T=Object(g.a)(R,b,[],!1,null,"72028fd0",null);"function"==typeof E.default&&Object(E.default)(T),T.options.__file="webpack-app/client/Reading/components/annotation/AnnotationManager/AnnotationFloatWidget/AnnotationFloatWidget.vue";var k,D,N,P={props:["lib","status","config"],data:function(){return this.$i18n.locale=this.config.locale,{isLoaded:!1,pause:!1,tutorialInited:!1,afterTime:null,loadHighlightInterval:this.lib.auth.stepHighlightAnnotationConfig.otherHighlightBatchInterval}},components:{"annotation-type-selector":y,"annotation-float-widget":T.exports},computed:{highlightsURL:function(){var t;return t=!0===this.lib.auth.isEnableCollaboration?null===this.afterTime&&!1===this.isLoaded?"/client/Highlight/highlights":"/client/Highlight/highlightsOthers":"/client/Highlight/highlightsMy",t}},watch:{"lib.RangyManager":(D=c()(s.a.mark(function t(e){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",!1);case 2:return this.afterTime=null,this.addFocusBlurEvent(),t.next=6,this.loadHighlights();case 6:this.status.progress.highlights=!0;case 7:case"end":return t.stop()}},t,this)})),function(t){return D.apply(this,arguments)}),"status.filter.focusUser":function(){this.reloadHighlights()},"status.filter.findType":function(){this.reloadHighlights()}},destroyed:function(){this.status.progress.highlights=!1,this.removeFocusBlurEvent()},mounted:function(){},methods:{addFocusBlurEvent:function(){window.addEventListener("focus",this.focusEvent),window.addEventListener("blur",this.blurEvent)},removeFocusBlurEvent:function(){window.removeEventListener("focus",this.focusEvent),window.removeEventListener("blur",this.blurEvent),this.pause=!0},focusEvent:function(){!0===this.pause&&(this.pause=!1,this.loadHighlights())},blurEvent:function(){if("reader"!==this.status.role)return!1;this.pause=!0},loadHighlights:(k=c()(s.a.mark(function t(){var e,n,i=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.lib.auth.stepHighlightAnnotationConfig&&!0!==this.pause){t.next=2;break}return t.abrupt("return",null);case 2:return e={sessionToken:this.status.sessionToken},"number"==typeof this.afterTime&&(e.afterTime=this.afterTime),this.lib.AnnotationHelper.filter(e),t.next=7,this.lib.AxiosHelper.get(this.highlightsURL,e);case 7:if(n=t.sent,this.lib.RangyManager){t.next=10;break}return t.abrupt("return",!1);case 10:if(0!==n)return t.next=13,this.lib.RangyManager.deserializeAppend(n);t.next=13;break;case 13:if(!(this.isLoaded=!0)===this.lib.auth.isEnableCollaboration)return this.setupTutorial(),t.abrupt("return",!1);t.next=17;break;case 17:"number"==typeof this.loadHighlightInterval&&setTimeout(function(){i.loadHighlights()},this.loadHighlightInterval),this.afterTime=(new Date).getTime(),this.setupTutorial();case 20:case"end":return t.stop()}},t,this)})),function(){return k.apply(this,arguments)}),reloadHighlights:function(){this.afterTime=null,this.lib.RangyManager.removeHighlights(),this.loadHighlights()}}};(N=P).methods.setupTutorial=function(){if(!0===this.tutorialInited)return!1;(this.tutorialInited=!0)===this.lib.auth.isEnableCollaboration?this.setupTutorialCollaborationReading():this.setupTutorialIndividualReading()},N.methods.setupTutorialCollaborationReading=function(){this.lib.TutorialManager.addAction({element:function(){var t=d()('[data-pacor-paragraph-seq-id] [data-pacor-highlight][class^="others-"]');if(0===t.length&&(t=d()("[data-pacor-paragraph-seq-id] [data-pacor-highlight]")),0!==t.length)return t=t.parents("[data-pacor-paragraph-seq-id]:first"),t},content:this.$t("You can read other's annotations."),scroll:"start",order:1})},N.methods.setupTutorialIndividualReading=function(){var t,a=this;this.lib.TutorialManager.addAction({element:(t=c()(s.a.mark(function t(){var e,n,i,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,a.lib.RangyManager.selectDemoText();case 3:if(e=t.sent,a.lib.RangyManager.isSelecting())return t.abrupt("break",8);t.next=6;break;case 6:t.next=0;break;case 8:return t.next=10,a.lib.RangyManager.rangy.getSelection();case 10:return n=t.sent,i=n.getRangeAt(0).cloneRange(),o=i.getBoundingDocumentRect(),a.lib.TutorialManager.showClick(o),t.abrupt("return",e);case 15:case"end":return t.stop()}},t)})),function(){return t.apply(this,arguments)}),content:this.$t("Select text to highlight."),scroll:"start",order:1})};var I=P,M=(n(585),n(587)),O=Object(g.a)(I,i,[],!1,null,"1e9c1d9b",null);"function"==typeof M.default&&Object(M.default)(O),O.options.__file="webpack-app/client/Reading/components/annotation/AnnotationManager/AnnotationManager.vue";e.default=O.exports},,,,,,function(t,e,n){"use strict";n.r(e);function i(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{ref:"anchor",staticClass:"item AnnotationTypeFilter",on:{click:function(t){return t.target!==t.currentTarget?null:e.show(t)}}},[n("span",{staticClass:"item-icon"},[e.type?[n("annotation-type-button",{attrs:{lib:e.lib,config:e.config,status:e.status,type:e.type},on:{find:e.show}})]:[n("annotation-type-button",{attrs:{lib:e.lib,config:e.config,status:e.status},on:{find:e.show}})]],2),e._v(" "),n("span",{staticClass:"item-label in-vertical"},[e._v("\r\n    "+e._s(e.$t("Type Filtering"))+"\r\n  ")]),e._v(" "),n("div",{ref:"popup",staticClass:"ui tertiary popup"},[n("annotation-type-filter-popup",{ref:"AnnotationTypeFilterPopup",attrs:{config:e.config,status:e.status,lib:e.lib}})],1)])}i._withStripped=!0;function o(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"AnnotationTypeFilterPopup"},e._l(e.typeDataList,function(t){return n("type-item",{attrs:{typeData:t,config:e.config,status:e.status,lib:e.lib}})}),1)}function a(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"type-item TypeItem",on:{click:t.selectType}},[t.lib.auth.isEnableCollaboration?[t.othersIsAll?[t._m(0),t._v(" "),n("span",{staticClass:"column username"},[t._v("\r\n        "+t._s(t.$t("All"))+"\r\n      ")]),t._v(" "),n("span",{staticClass:"column"},[t._v("\r\n        :\r\n        "+t._s(t.typeData.othersCount)+"\r\n      ")])]:[n("span",{staticClass:"column"},[n("img",{staticClass:"user-avatar",attrs:{src:t.othersAvatar,title:t.othersUsername}})]),t._v(" "),n("span",{staticClass:"column username"},[n("span",{staticClass:"username-container"},[t._v("\r\n          "+t._s(t.othersUsername)+"\r\n        ")])]),t._v(" "),n("span",{staticClass:"column"},[t._v("\r\n        :\r\n        "+t._s(t.typeData.othersCount)+"\r\n      ")])]]:t._e(),t._v(" "),n("span",{staticClass:"column button"},[n("annotation-type-button",{attrs:{lib:t.lib,config:t.config,status:t.status,type:t.typeData.type},on:{find:t.selectType}})],1),t._v(" "),n("span",{staticClass:"column"},[n("img",{staticClass:"user-avatar",attrs:{src:t.myAvatar,title:t.username}})]),t._v(" "),n("span",{staticClass:"column username"},[n("span",{staticClass:"username-container"},[t._v("\r\n    "+t._s(t.username)+"\r\n    ")])]),t._v(" "),n("span",{staticClass:"column"},[t._v("\r\n    :\r\n    "+t._s(t.typeData.myCount)+"\r\n  ")])],2)}var s=n(0),r=n.n(s),c=n(1),l=n.n(c);a._withStripped=o._withStripped=!0;var u={props:["lib","status","config","typeData"],data:function(){return this.$i18n.locale=this.config.locale,{}},computed:{isSelected:function(){return this.status.search.findType===this.typeData.type},username:function(){return this.lib.auth.username},myAvatar:function(){return this.status.avatar},othersUsername:function(){if(this.status.filter.focusUser)return this.lib.auth.getUsername(this.status.filter.focusUser)},othersAvatar:function(){if(this.status.filter.focusUser)return this.status.filter.focusUser.avatar_url},othersIsAll:function(){return!this.status.filter.focusUser},othersIsMe:function(){return this.status.filter.focusUser&&this.status.filter.focusUser.id===this.status.userID},isOtherVisiable:function(){return this.lib.auth.isEnableCollaboration&&!this.othersIsMe}},methods:{selectType:function(){this.status.filter.findType=this.typeData.type,this.lib.AnnotationTypeFilter.hide()}}},h=(n(612),n(2)),d=n(614),f=Object(h.a)(u,a,[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"column"},[e("i",{staticClass:"large users icon"})])}],!1,null,"28af1646",null);"function"==typeof d.default&&Object(d.default)(f),f.options.__file="webpack-app/client/Reading/components/search/AnnotationTypeFilter/AnnotationTypeFilterPopup/TypeItem/TypeItem.vue";var p,g={props:["lib","status","config"],data:function(){return this.$i18n.locale=this.config.locale,{typeDataList:[],loadLock:!1}},components:{"type-item":f.exports},computed:{},methods:{load:(p=l()(r.a.mark(function t(){var e,n,i;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!0===this.loadLock)return t.abrupt("return",null);t.next=2;break;case 2:return this.loadLock=!0,e={},this.status.filter.focusUser&&(e.focusUserID=this.status.filter.focusUser.id),t.next=7,this.lib.AxiosHelper.get("/client/AnnotationTypeFilter/init",e);case 7:n=t.sent,i=this.getTotalItem(n),n.unshift(i),this.typeDataList=n,this.loadLock=!1;case 12:case"end":return t.stop()}},t,this)})),function(){return p.apply(this,arguments)}),getTotalItem:function(t){var e={type:null,myCount:0,othersCount:0};return t.forEach(function(t){e.myCount=e.myCount+parseInt(t.myCount,10),e.othersCount=e.othersCount+parseInt(t.othersCount,10)}),e}}},m=(n(615),n(617)),v=Object(h.a)(g,o,[],!1,null,"0bd5c2a2",null);"function"==typeof m.default&&Object(m.default)(v),v.options.__file="webpack-app/client/Reading/components/search/AnnotationTypeFilter/AnnotationTypeFilterPopup/AnnotationTypeFilterPopup.vue";var b,y=v.exports,C=n(3),w=n.n(C),A={props:["lib","status","config"],data:function(){return this.$i18n.locale=this.config.locale,{inited:!1,anchor:null}},components:{"annotation-type-filter-popup":y},computed:{type:function(){return this.status.filter.findType}},methods:{show:(b=l()(r.a.mark(function t(){var e,n=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.anchor||(this.anchor=w()(this.$refs.anchor)),!0===this.inited)return this.anchor.popup("show"),t.abrupt("return",null);t.next=4;break;case 4:return this.inited=!0,e=this.$refs.popup,t.next=8,this.$refs.AnnotationTypeFilterPopup.load();case 8:this.anchor.popup({popup:e,inline:!0,hoverable:!0,on:"click",position:"top center",onShow:function(){n.$refs.AnnotationTypeFilterPopup.load()}}),this.anchor.popup("show");case 10:case"end":return t.stop()}},t,this)})),function(){return b.apply(this,arguments)}),hide:function(){this.anchor.popup("hide all")}}},S=(n(618),n(620)),_=Object(h.a)(A,i,[],!1,null,"76134036",null);"function"==typeof S.default&&Object(S.default)(_),_.options.__file="webpack-app/client/Reading/components/search/AnnotationTypeFilter/AnnotationTypeFilter.vue";e.default=_.exports},,,,,,function(t,e,n){"use strict";n.r(e);function i(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ui action input SearchManager",class:e.computedInputClassList},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.status.search.keyword,expression:"status.search.keyword"}],ref:"input",attrs:{type:"text",placeholder:e.$t("Search..."),onfocus:"this.select()"},domProps:{value:e.status.search.keyword},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchAnnotation(t)},input:function(t){t.target.composing||e.$set(e.status.search,"keyword",t.target.value)}}}),e._v(" "),n("button",{staticClass:"ui icon button",attrs:{type:"button"},on:{click:e.searchAnnotation}},[0<e.count&&""!==e.status.search.keyword?n("div",{staticClass:"floating ui red label"},[e._v("\r\n      "+e._s(e.count)+"\r\n    ")]):e._e(),e._v(" "),n("i",{staticClass:"search icon"})])])}i._withStripped=!0;var o={props:["status","lib","size"],data:function(){return{enableShowList:!1,composition:!1}},computed:{count:function(){return this.lib.NumberHelper.parseRoughNumber(this.$t,this.status.search.count)},computedInputClassList:function(){var t=[];return this.size&&t.push(this.size),t.join(" ")}},methods:{searchAnnotation:function(){this.$emit("search"),this.lib.AnnotationPanel.findKeyword(this.status.search.keyword),this.lib.AnnotationPanel.setAnchorPositions({delete:function(){this.status.search.count--}})}}},a=(n(600),n(2)),s=n(602),r=Object(a.a)(o,i,[],!1,null,"5624c452",null);"function"==typeof s.default&&Object(s.default)(r),r.options.__file="webpack-app/client/Reading/components/search/SearchManager/SearchInput/SearchInput.vue";e.default=r.exports},function(t,e,n){"use strict";n.r(e);function i(){var t=this.$createElement;return(this._self._c||t)("fragment")}i._withStripped=!0;var o,a=n(0),s=n.n(a),r=n(1),c={props:["status","lib","config"],data:function(){return{}},watch:{"status.search.keyword":function(){this.countSearchResult()}},mounted:function(){""!==this.status.search.keyword&&this.countSearchResult()},methods:{countSearchResult:(o=n.n(r)()(s.a.mark(function t(){var e;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""===this.status.search.keyword)return this.count=0,t.abrupt("return",!1);t.next=3;break;case 3:return e={withCount:!0,keyword:this.status.search.keyword},"/client/Annotation/listCount",this.lib.AnnotationHelper.filter(e),t.next=8,this.lib.AxiosHelper.post("/client/Annotation/listCount",e);case 8:if(this.status.search.count=t.sent,""===this.status.search.keyword)return this.count=0,t.abrupt("return",!1);t.next=12;break;case 12:case"end":return t.stop()}},t,this)})),function(){return o.apply(this,arguments)})}},l=n(2),u=Object(l.a)(c,i,[],!1,null,null,null);u.options.__file="webpack-app/client/Reading/components/search/SearchManager/SearchManager.vue";e.default=u.exports},,,function(t,e,n){"use strict";n.r(e);function i(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"item in-vertical",attrs:{href:"https://github.com/pulipulichen/PACOR/blob/master/help/AboutPACOR.md",target:"AboutPACOR"}},[e("i",{staticClass:"info circle icon"}),this._v("\r\n  "+this._s(this.$t("About PACOR"))+"\r\n")])}i._withStripped=!0;var o={props:["lib","status","config"],data:function(){return this.$i18n.locale=this.config.locale,{}},methods:{show:function(){console.error("@AboutItem")}}},a=(n(609),n(2)),s=n(611),r=Object(a.a)(o,i,[],!1,null,"2cbcde9e",null);"function"==typeof s.default&&Object(s.default)(r),r.options.__file="webpack-app/client/Reading/components/ui-navigation/AboutItem/AboutItem.vue";e.default=r.exports},function(t,e,n){"use strict";n.r(e);function i(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{staticClass:"fitted item avatar NavigationHeaderItem",on:{click:function(t){return e.$emit("click")}}},[n("user-avatar",{attrs:{config:e.config,status:e.status,lib:e.lib}}),e._v(" "),n("div",{staticClass:"username"},[n("span",{staticClass:"username-container"},[e._v("\r\n      "+e._s(e.lib.auth.username)+"\r\n    ")]),e._v(" "),n("div",{staticClass:"step"},["FreeReading"!==e.lib.auth.currentStep?[e._v("\r\n        "+e._s(e.$t("In {0} step",[e.$t("READING_PROGRESS."+e.lib.auth.currentStep)]))+"\r\n        "),n("i",{staticClass:"question circle icon"})]:e._e(),e._v(" "),"reader"!==e.status.role?[e._v("\r\n        "+e._s(e.$t("Open Administration Panel"))+"\r\n        "),n("i",{staticClass:"cog icon"})]:e._e()],2)])],1)}i._withStripped=!0;var o={props:["lib","status","config"],data:function(){return this.$i18n.locale=this.config.locale,{}}},a=(n(606),n(2)),s=n(608),r=Object(a.a)(o,i,[],!1,null,"6eab25ef",null);"function"==typeof s.default&&Object(s.default)(r),r.options.__file="webpack-app/client/Reading/components/ui-navigation/NavigationHeaderItem/NavigationHeaderItem.vue";e.default=r.exports},function(t,e,n){"use strict";n.r(e);function i(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"non-invasive-web-style-framework"},[n("modal",{ref:"Modal",staticClass:"InstructionMessage",attrs:{config:t.config,status:t.status,lib:t.lib,cancelable:!1,contentURL:t.contentURL,disableOpenWindow:!0},on:{hide:t.onHide},scopedSlots:t._u([{key:"header",fn:function(){return[n("div",{on:{dblclick:t.nextStep}},[t._v("\r\n          "+t._s(t.$t("READING_PROGRESS."+t.lib.auth.currentStep))+"\r\n        ")])]},proxy:!0},t.contentURL?null:{key:"content",fn:function(){return[n("div",{domProps:{innerHTML:t._s(t.instruction)}})]},proxy:!0},{key:"actions",fn:function(){return[n("div",{staticClass:"ui positive button",on:{click:t.startTutorial}},[t._v("\r\n          "+t._s(t.$t("Start Tutorial"))+"\r\n        ")]),t._v(" "),n("div",{staticClass:"ui button",on:{click:t.hide}},[t._v("\r\n          "+t._s(t.$t("Close"))+"\r\n        ")])]},proxy:!0}],null,!0)})],1)}i._withStripped=!0;var o={props:["lib","status","config"],data:function(){return this.$i18n.locale=this.config.locale,{tempStepName:this.lib.auth.currentStep}},computed:{stepName:function(){return this.lib.auth.currentStep},localStorageKeyPrefix:function(){return"InstructionMessage."+this.status.userID+"."+this.tempStepName},instruction:function(){return this.lib.auth.currentStepConfig.instruction},contentURL:function(){if(this.lib.StringHelper.isURL(this.instruction))return this.instruction}},mounted:function(){this.checkAutoShow()},destroyed:function(){localStorage.removeItem(this.localStorageKeyPrefix)},methods:{checkAutoShow:function(){if(!this.instruction)return null;null===localStorage.getItem(this.localStorageKeyPrefix)&&this.show()},hide:function(){this.$refs.Modal.hide()},startTutorial:function(){this.hide(),this.lib.TutorialManager.start()},show:function(){this.$refs.Modal.show()},onHide:function(){localStorage.setItem(this.localStorageKeyPrefix,1)},nextStep:function(){this.lib.auth.nextStep()}}},a=(n(603),n(2)),s=n(605),r=Object(a.a)(o,i,[],!1,null,"343bc5bc",null);"function"==typeof s.default&&Object(s.default)(r),r.options.__file="webpack-app/client/Reading/components/ui/InstructionMessage/InstructionMessage.vue";e.default=r.exports}])]);