(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{110:function(e,t,s){"use strict";var r=s(71);s.n(r).a},111:function(e,t,s){(e.exports=s(16)(!1)).push([e.i,"",""])},112:function(e,t,s){"use strict";var r=s(72),i=s.n(r);t.default=i.a},118:function(e,t,s){"use strict";s.r(t);function r(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ui form segment"},[""!==t.errorMessage?s("div",{staticClass:"ui field"},[s("div",{staticClass:"ui negative message"},[t._v("\r\n      "+t._s(t.errorMessage)+"\r\n    ")])]):t._e(),t._v(" "),s("div",{staticClass:"ui field"},[s("label",{attrs:{for:"loginUsername"}},[t._v("\r\n      "+t._s(t.$t("Username"))+"\r\n    ")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",id:"loginUsername"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),t._v(" "),"register"===t.mode?s("div",{staticClass:"ui field",class:{error:!t.isEmail}},[s("label",{attrs:{for:"loginEmail"}},[t._v("\r\n      "+t._s(t.$t("Email"))+"\r\n    ")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{type:"email",id:"loginEmail"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]):t._e(),t._v(" "),s("div",{staticClass:"ui field"},[s("label",{attrs:{for:"loginPassword"}},[t._v("\r\n      "+t._s(t.$t("Password"))+"\r\n    ")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",id:"loginPassword"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"ui six buttons"},[s("button",{staticClass:"ui button",class:{disabled:"login"===t.mode&&!t.isLoginEnable},attrs:{type:"button"},on:{click:t.login}},[t._v("\r\n      "+t._s(t.$t("Login"))+"\r\n    ")]),t._v(" "),s("button",{staticClass:"ui button",class:{disabled:"register"===t.mode&&!t.isRegisterEnable},attrs:{type:"button"},on:{click:t.register}},[t._v("\r\n      "+t._s(t.$t("Register"))+"\r\n    ")]),t._v(" "),s("button",{staticClass:"ui google button",attrs:{type:"button"},on:{click:function(e){return t.loginFromOAuth("google")}}},[s("i",{staticClass:"google icon"}),t._v("\r\n      "+t._s(t.$t("Login from Google"))+"\r\n    ")]),t._v(" "),s("button",{staticClass:"ui github button",attrs:{type:"button"},on:{click:function(e){return t.loginFromOAuth("github")}}},[s("i",{staticClass:"github icon"}),t._v("\r\n      "+t._s(t.$t("Login from GitHub"))+"\r\n    ")]),t._v(" "),s("button",{staticClass:"ui instagram button",attrs:{type:"button"},on:{click:function(e){return t.loginFromOAuth("instagram")}}},[s("i",{staticClass:"instagram icon"}),t._v("\r\n      "+t._s(t.$t("Login from Instagram"))+"\r\n    ")]),t._v(" "),s("button",{staticClass:"ui foursquare button",attrs:{type:"button"},on:{click:function(e){return t.loginFromOAuth("foursquare")}}},[s("i",{staticClass:"instagram icon"}),t._v("\r\n      "+t._s(t.$t("Login from Foursquare"))+"\r\n    ")])])])}r._withStripped=!0;var i,n,a=s(3),u=s.n(a),o=s(0),c=s.n(o),l=s(1),g=s.n(l),m={props:["lib","status","config","progress","error","view"],data:function(){return this.$i18n.locale=this.config.locale,{username:"",email:"",password:"",mode:"login",errorMessage:""}},computed:{isEmail:function(){return""===this.email.trim()||this.lib.StringHelper.validateEmail(this.email)},isLoginEnable:function(){return""!==this.username.trim()&&""!==this.password.trim()},isRegisterEnable:function(){return!0===this.isEmail&&""!==this.username.trim()&&""!==this.email.trim()&&""!==this.password.trim()}},watch:{},mounted:function(){},methods:{register:(n=g()(c.a.mark(function e(){var t,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("register"!==this.mode)return this.mode="register",e.abrupt("return",!1);e.next=3;break;case 3:return e.next=5,this.lib.AxiosHelper.get("/client/user/register",{username:this.username,email:this.email,password:this.password});case 5:if(t=e.sent,"string"==typeof(s=t).error)return"user-is-existed"===s.error?this.errorMessage=this.$t("User {0} is registed.",[this.username]):this.errorMessage=s.error,e.abrupt("return",!1);e.next=12;break;case 12:this.status.username=this.username,this.errorMessage="",this.view="Chat",this.reset();case 16:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)}),login:(i=g()(c.a.mark(function e(){var t,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.mode="login",e.next=3,this.lib.AxiosHelper.get("/client/user/login",{username:this.username,password:this.password});case 3:if(t=e.sent,void 0===(s=t))return this.errorMessage=this.$t("User {0} is not existed.",[this.username]),e.abrupt("return");e.next=8;break;case 8:if("string"==typeof s.error)return"no-user"===s.error?this.errorMessage=this.$t("User {0} is not existed.",[this.username]):"password-wrong"===s.error?this.errorMessage=this.$t("Password is incorrect.",[this.username]):this.errorMessage=s.error,e.abrupt("return",!1);e.next=13;break;case 13:this.status.username=this.username,this.errorMessage="",this.view="Chat",this.reset();case 17:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)}),loginFromOAuth:function(e){var t=400;t>screen.availWidth&&(t=screen.availWidth);var s=600;s>screen.availHeight&&(s=screen.availHeight);var r=void 0!==window.screenLeft?window.screenLeft:window.screenX,i=void 0!==window.screenTop?window.screenTop:window.screenY,n=(screen.availWidth-t)/2+r,a=(screen.availHeight-s)/2+i,o=window.open("".concat(this.config.baseURL,"/client/oauth/request/").concat(e),"_blank","location=0,menubar=no,copyhistory=no,directories=0,status=0,width=".concat(t,",height=").concat(s,",top=").concat(a,",left=").concat(n));this.loginOAuthCallback(e,o)},loginOAuthCallback:function(i,n){var a=this,o=function(){var t=g()(c.a.mark(function e(t){var s,r;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.origin!==a.config.baseURL)return e.abrupt("return",!1);e.next=2;break;case 2:if(n.close(),s=t.data,"object"===u()(s))return s.driver=i,e.next=8,a.lib.AxiosHelper.get("/client/oauth/login",s);e.next=10;break;case 8:!1!==(r=e.sent)&&(a.status.username=r);case 10:window.removeEventListener("message",o,!1);case 11:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}();window.addEventListener("message",o,!1)},reset:function(){this.username="",this.email="",this.password="",this.errorMessage="",this.mode="login"}}},d=(s(110),s(4)),p=s(112),h=Object(d.a)(m,r,[],!1,null,"7f785ee2",null);"function"==typeof p.default&&Object(p.default)(h),h.options.__file="webpack-app/client/components/Login/Login.vue";t.default=h.exports},71:function(e,t,s){var r=s(111);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};s(17)(r,i);r.locals&&(e.exports=r.locals)},72:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"en":{},"zh-TW":{"User {0} is not existed.":"使用者{0}不存在。","User {0} is registed.":"使用者{0}已經註冊。","Password is incorrect.":"密碼錯誤。","Username":"使用者名稱","Password":"密碼","Email":"電子信箱地址","Login":"登入","Register":"註冊","Login from Google":"從Google帳號登入","Login from GitHub":"從GitHub帳號登入","Login from Instagram":"從Instagram帳號登入"}}'),delete e.options._Ctor}}}]);