!function(u){function e(e){for(var t,n,r=e[0],i=e[1],s=e[2],a=0,o=[];a<r.length;a++)n=r[a],Object.prototype.hasOwnProperty.call(l,n)&&l[n]&&o.push(l[n][0]),l[n]=0;for(t in i)Object.prototype.hasOwnProperty.call(i,t)&&(u[t]=i[t]);for(f&&f(e);o.length;)o.shift()();return p.push.apply(p,s||[]),c()}function c(){for(var e,t=0;t<p.length;t++){for(var n=p[t],r=!0,i=1;i<n.length;i++){var s=n[i];0!==l[s]&&(r=!1)}r&&(p.splice(t--,1),e=d(d.s=n[0]))}return e}var n={},l={8:0},p=[];function d(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return u[e].call(t.exports,t,t.exports,d),t.l=!0,t.exports}d.e=function(i){var e=[],n=l[i];if(0!==n)if(n)e.push(n[2]);else{var t=new Promise(function(e,t){n=l[i]=[e,t]});e.push(n[2]=t);var r,s=document.createElement("script");s.charset="utf-8",s.timeout=120,d.nc&&s.setAttribute("nonce",d.nc),s.src=function(e){return d.p+""+({9:"client-components/CollaborativeReading",10:"client-components/Exit",11:"client-components/FreeReading",12:"client-components/IndividualReading",13:"client-components/Questionnaire",14:"client-components/ReadingComponents",15:"vendors/HTMLEditor",16:"vendors/semantic-ui-niwsf"}[e]||e)+".js"}(i);var a=new Error;r=function(e){s.onerror=s.onload=null,clearTimeout(o);var t=l[i];if(0!==t){if(t){var n=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;a.message="Loading chunk "+i+" failed.\n("+n+": "+r+")",a.name="ChunkLoadError",a.type=n,a.request=r,t[1](a)}l[i]=void 0}};var o=setTimeout(function(){r({type:"timeout",target:s})},12e4);s.onerror=s.onload=r,document.head.appendChild(s)}return Promise.all(e)},d.m=u,d.c=n,d.d=function(e,t,n){d.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},d.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.t=function(t,e){if(1&e&&(t=d(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(d.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)d.d(n,r,function(e){return t[e]}.bind(null,r));return n},d.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return d.d(t,"a",t),t},d.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},d.p="http://127.0.0.1:3333/spa/",d.oe=function(e){throw console.error(e),e};var t=window.webpackJsonp=window.webpackJsonp||[],r=t.push.bind(t);t.push=e,t=t.slice();for(var i=0;i<t.length;i++)e(t[i]);var f=r;p.push([128,0,1]),c()}({115:function(e,t,n){"use strict";var r=n(26);n.n(r).a},116:function(e,t,n){(e.exports=n(5)(!1)).push([e.i,"",""])},128:function(e,t,n){"use strict";n.r(t);function r(){var e=this.$createElement;return(this._self._c||e)("span",{staticClass:"BlockExit"})}var i=n(3),s=(n(60),n(62),n(45)),a=n(34),o=n(35),u=n(36),c=n(37),l=n(9),p=n.n(l),d=n(73),f=n.n(d),m=n(10),g=n(41),h=n(44),v=n(39);r._withStripped=!0;function b(e){e.returnValue=""}var w={data:function(){return{}},created:function(){window.addEventListener("beforeunload",b,!0)},destroyed:function(){window.removeEventListener("beforeunload",b,!0)}},y=n(4),x=n(51),k=Object(y.a)(w,r,[],!1,null,null,null);"function"==typeof x.default&&Object(x.default)(k),k.options.__file="webpack-app/components/BlockExit/BlockExit.vue";function _(){var e=this.$createElement;return(this._self._c||e)("span")}var L=k.exports;_._withStripped=!0;function P(){!1===U&&(U=!0,C=(new Date).getTime())}var C,H,E,S=n(0),O=n.n(S),R=n(2),A=n.n(R),U=!1,j={props:["config","lib"],data:function(){return{timer:null,lastTime:null}},created:function(){var t=this,e=window.document;e.addEventListener("mousemove",P),e.addEventListener("keyup",P),e.addEventListener("touchend",P);var n=this.config.detectActivitySeconds;this.timer=setInterval(A()(O.a.mark(function e(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.send();case 1:case"end":return e.stop()}},e)})),1e3*n)},destroyed:(E=A()(O.a.mark(function e(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:clearInterval(this.timer),this.send();case 2:case"end":return e.stop()}},e,this)})),function(){return E.apply(this,arguments)}),methods:{toNow:function(){return Math.round(((new Date).getTime()-C)/1e3)},send:(H=A()(O.a.mark(function e(){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===U)return e.next=3,this.lib.AxiosHelper.get("/client/ReadingProgress/activityTimer",{seconds:this.toNow()});e.next=4;break;case 3:U=!1;case 4:case"end":return e.stop()}},e,this)})),function(){return H.apply(this,arguments)})}},M=Object(y.a)(j,_,[],!1,null,null,null);M.options.__file="webpack-app/components/ActivityTimer/ActivityTimer.vue";var T=M.exports,$=n(40);i.a.component("pagination",g.a),i.a.component("modal",h.a),i.a.component("step-progress-bar",v.a),i.a.component("block-exit",L),i.a.component("activity-timer",T),i.a.component("navigation",$.a),i.a.component("HTMLEditor",function(){return Promise.all([n.e(0),n.e(15)]).then(n.bind(null,301))});function D(){var e=this.$createElement;return(this._self._c||e)("fragment")}var I=n(42),J=n(43);D._withStripped=!0;var N,V,B,F,G,Q,W,z,q=n(1),K=n.n(q),X={props:["lib","status","config","progress","error"],data:function(){return{}},watch:{"status.needLogin":(z=A()(O.a.mark(function e(){var t;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!1===this.status.needLogin)return e.next=3,this.getCurrentStep();e.next=9;break;case 3:if(t=e.sent,this.lib.ValidateHelper.isURL(t))return e.next=7,this._redirect(t);e.next=8;break;case 7:return e.abrupt("return",e.sent);case 8:this.status.view=t;case 9:case"end":return e.stop()}},e,this)})),function(){return z.apply(this,arguments)})},mounted:(W=A()(O.a.mark(function e(){var t;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof this.config.username&&"string"==typeof this.config.usernameQueryURL)return e.next=3,this.loadUsernameFromURL();e.next=4;break;case 3:this.config.username=e.sent;case 4:if(t=!1,"string"==typeof this.config.username)return e.next=8,this.attemptLoginViaUsername(this.config.username);e.next=9;break;case 8:t=e.sent;case 9:if(!1===t)return e.next=12,this.checkLogin();e.next=12;break;case 12:case"end":return e.stop()}},e,this)})),function(){return W.apply(this,arguments)}),methods:{loadUsernameFromURL:(Q=A()(O.a.mark(function e(){var t;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.lib.AxiosHelper.getOther(this.config.usernameQueryURL);case 2:if("string"==typeof(t=e.sent))return e.abrupt("return",t);e.next=5;break;case 5:case"end":return e.stop()}},e,this)})),function(){return Q.apply(this,arguments)}),attemptLoginViaUsername:(G=A()(O.a.mark(function e(t){var n;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.lib.AxiosHelper.get("/client/user/attempt-login-via-username",{username:t});case 2:if("string"==typeof(n=e.sent))return this.status.username=n,e.abrupt("return",!0);e.next=8;break;case 8:return e.abrupt("return",!1);case 9:case"end":return e.stop()}},e,this)})),function(e){return G.apply(this,arguments)}),checkLogin:(F=A()(O.a.mark(function e(){var t,n;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.lib.AxiosHelper.get("/client/auth/checkLogin");case 2:if(t=e.sent,"object"===K()(t)){for(n in t)this.status[n]=t[n];this.status.needLogin=!1}else this.showLogin();case 4:case"end":return e.stop()}},e,this)})),function(){return F.apply(this,arguments)}),getCurrentStep:(B=A()(O.a.mark(function e(){var t,n,r;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Array.isArray(this.status.readingProgresses)&&0<this.status.readingProgresses.length)){e.next=19;break}t=0;case 2:if(!(t<this.status.readingProgresses.length)){e.next=14;break}if(!0===(n=this.status.readingProgresses[t]).isCompleted)return e.abrupt("continue",11);e.next=6;break;case 6:if("number"!=typeof n.start_timestamp)return n.start_timestamp=this.lib.DayJSHelper.time(),e.abrupt("return",n.step_name);e.next=9;break;case 9:if("number"==typeof n.start_timestamp&&"number"!=typeof n.end_timestamp)return e.abrupt("return",n.step_name);e.next=11;break;case 11:t++,e.next=2;break;case 14:if(r=this.status.readingConfig.readingProgressesFinish,this.lib.ValidateHelper.isURL(r))return e.next=18,this._redirect(r);e.next=18;break;case 18:return e.abrupt("return",r);case 19:return e.abrupt("return","not-yet-started");case 20:case"end":return e.stop()}},e,this)})),function(){return B.apply(this,arguments)}),_redirect:(V=A()(O.a.mark(function e(t){return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:location.href=t;case 1:case"end":return e.stop()}},e)})),function(e){return V.apply(this,arguments)}),showLogin:function(){this.status.needLogin=!0,this.status.view="Login"},nextStep:(N=A()(O.a.mark(function e(t){var n,r,i;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==t)return e.next=3,this.lib.AxiosHelper.get("/client/ReadingProgress/end");e.next=3;break;case 3:n=this.lib.DayJSHelper.time(),r=0;case 5:if(!(r<this.status.readingProgresses.length)){e.next=15;break}if(!0===(i=this.status.readingProgresses[r]).isCompleted)return e.abrupt("continue",12);e.next=9;break;case 9:if("number"==typeof i.start_timestamp&&"number"!=typeof i.end_timestamp)return i.end_timestamp=n,e.abrupt("break",15);e.next=12;break;case 12:r++,e.next=5;break;case 15:return e.next=17,this.getCurrentStep();case 17:this.status.view=e.sent;case 18:case"end":return e.stop()}},e,this)})),function(e){return N.apply(this,arguments)})}},Y=Object(y.a)(X,D,[],!1,null,null,null);Y.options.__file="webpack-app/client/components/Auth/Auth.vue";function Z(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login-modal"},[n("modal",{ref:"LoginModal",attrs:{config:t.config,status:t.status,progress:t.progress,error:t.error,lib:t.lib,dimmerTransparent:"false",cancelable:"false"},scopedSlots:t._u([{key:"header",fn:function(){return[n("div",{on:{click:function(e){t.adminMode=!t.adminMode}}},[t._v("\r\n          "+t._s(t.$t("Welcome to PACOR"))+"\r\n        ")])]},proxy:!0},{key:"content",fn:function(){return[n("div",{staticClass:"ui middle aligned grid"},[n("div",{staticClass:"six wide column"},[n("img",{staticClass:"ui image",attrs:{src:t.config.baseURL+"/imgs/pacor.svg"}})]),t._v(" "),n("div",{staticClass:"ten wide column"},[n("div",{staticClass:"ui field"},[n("label",{attrs:{for:"loginUsername"}},[t._v("\r\n                "+t._s(t.$t("Username"))+"\r\n              ")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",id:"loginUsername"},domProps:{value:t.username},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)},input:function(e){e.target.composing||(t.username=e.target.value)}}})]),t._v(" "),t.adminMode?n("div",{staticClass:"ui field"},[n("label",{attrs:{for:"loginPassword"}},[t._v("\r\n                "+t._s(t.$t("Password"))+"\r\n              ")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",id:"loginPassword"},domProps:{value:t.password},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)},input:function(e){e.target.composing||(t.password=e.target.value)}}})]):t._e(),t._v(" "),n("div",{staticClass:"ui field",domProps:{innerHTML:t._s(t.$t("agreement-link",[t.agreementLink]))}})])])]},proxy:!0},{key:"actions",fn:function(){return[n("div",{staticClass:"ui button",class:{disabled:t.isDisableLogin},on:{click:t.login}},[t._v(t._s(t.$t("LOGIN")))])]},proxy:!0}])})],1)}var ee=Y.exports;Z._withStripped=!0;var te,ne={props:["lib","status","config","progress","error"],data:function(){return this.$i18n.locale=this.config.locale,{username:"a",password:"",adminMode:!1}},computed:{isDisableLogin:function(){return""===this.username||!1!==this.adminMode&&""!==this.password},agreementLink:function(){return this.config.baseURL+"/client/webpage/agreement"}},watch:{},mounted:function(){this.$refs.LoginModal.show()},methods:{login:(te=A()(O.a.mark(function e(){var t,n,r;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={username:this.username},this.adminMode&&(t.password=this.password),e.next=4,this.lib.AxiosHelper.get("/client/Auth/login",t);case 4:if(n=e.sent,"object"!==K()(n))return e.abrupt("return");e.next=7;break;case 7:for(r in n)this.status[r]=n[r];this.status.username=this.username,this.reset(),this.$refs.LoginModal.hide(),this.status.needLogin=!1;case 12:case"end":return e.stop()}},e,this)})),function(){return te.apply(this,arguments)}),reset:function(){this.username="",this.password=""}}},re=(n(115),n(55)),ie=Object(y.a)(ne,Z,[],!1,null,"7f785ee2",null);"function"==typeof re.default&&Object(re.default)(ie),ie.options.__file="webpack-app/client/components/Login/Login.vue";var se=ie.exports,ae={Loading:I.a,"error-handler":J.a,Auth:ee,Login:se,CollaborativeReading:function(){return n.e(9).then(n.bind(null,306))},IndividualReading:function(){return n.e(12).then(n.bind(null,300))},PostRecall:function(){return n.e(13).then(n.bind(null,303))},PreImaginary:function(){return n.e(13).then(n.bind(null,308))},Exit:function(){return n.e(10).then(n.bind(null,304))},FreeReading:function(){return n.e(11).then(n.bind(null,305))}},oe=n.p;oe=oe.split("/").slice(0,3).join("/"),m.a.baseURL=oe;var ue=p()(document.currentScript);1===ue.length&&ue.before('<div id="app"></div>'),window.onerror=function(e,t,n,r,i){ce.data.error=i},i.a.config.errorHandler=function(e,t,n){ce.data.error=e,console.error(e)};var ce={data:{config:m.a,status:{needLogin:!0,username:"",displayName:"",avatar:"",role:"reader",readingProgresses:[],title:"",view:"Loading"},progress:{component:!1,data:!1,display:!1},lib:{AxiosHelper:a.a.setBaseURL(oe),DayJSHelper:o.a,StringHelper:u.a,ValidateHelper:c.a,auth:null},error:"",persistAttrs:[]},computed:{},watch:{"config.locale":function(){this.lib.DayJSHelper.setLocale(this.config.locale)}},created:function(){},mounted:function(){var n=this;this.lib.AxiosHelper.setErrorHandler(function(e){n.error=e}),this.lib.DayJSHelper.setI18N(function(e,t){return n.$t(e,t)}),this.lib.auth=this.$refs.auth},methods:{},el:"#app",i18n:s.a,template:f.a,components:ae};"string"==typeof oe&&p()(function(){new i.a(ce),p()("body > #TestMessage").remove()}),window.VueController=ce},18:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"en":null,"zh-TW":{"Please don\'t leave.":"請不要離開"}}'),delete e.options._Ctor}},26:function(e,t,n){var r=n(116);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(6)(r,i);r.locals&&(e.exports=r.locals)},27:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"en":{"agreement-link":"By clicking Sign Up, you agree to our <a href=\'{0}\' target=\'_blank\'>Agreement Terms</a>."},"zh-TW":{"User {0} is not existed.":"使用者{0}不存在。","User {0} is registed.":"使用者{0}已經註冊。","Password is incorrect.":"密碼錯誤。","Username":"使用者名稱","Password":"密碼","Email":"電子信箱地址","Login":"登入","Register":"註冊","Login from Google":"從Google帳號登入","Login from GitHub":"從GitHub帳號登入","Login from Instagram":"從Instagram帳號登入","agreement-link":"如果您按下「登入」按鈕，表示您同意我們的<a href=\'{0}\' target=\'_blank\'>知情同意書</a>。"}}'),delete e.options._Ctor}},51:function(e,t,n){"use strict";var r=n(18),i=n.n(r);t.default=i.a},55:function(e,t,n){"use strict";var r=n(27),i=n.n(r);t.default=i.a},73:function(e,t){e.exports='<div class="non-invasive-web-style-framework">\r\n\r\n  <auth v-bind:config="config"\r\n        v-bind:status="status"\r\n        v-bind:progress="progress"\r\n        v-bind:lib="lib"\r\n        v-bind:error="error"\r\n        ref="auth"></auth>\r\n  <error-handler v-bind:config="config"\r\n                 v-bind:error="error"\r\n                 ref="ErrorHandler"></error-handler>\r\n  \r\n  \x3c!--\r\n  <rangy-manager v-bind:config="config"\r\n        v-bind:status="status"\r\n        v-bind:progress="progress"\r\n        v-bind:lib="lib"\r\n        v-bind:error="error"\r\n        v-bind:view="view"></rangy-manager>\r\n  \r\n  <note-editor-manager v-bind:config="config"\r\n        v-bind:status="status"\r\n        v-bind:progress="progress"\r\n        v-bind:lib="lib"\r\n        v-bind:error="error"\r\n        v-bind:view="view"></note-editor-manager>\r\n  --\x3e\r\n  \r\n  <component v-bind:is="status.view"\r\n      v-bind:config="config"\r\n      v-bind:status="status"\r\n      v-bind:progress="progress"\r\n      v-bind:lib="lib"\r\n      v-bind:error="error"></component>\r\n</div>'}});