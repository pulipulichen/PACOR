(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{147:function(t,e,a){var s=a(235);"string"==typeof s&&(s=[[t.i,s,""]]);var i={insert:"head",singleton:!1};a(7)(s,i);s.locals&&(t.exports=s.locals)},148:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"en":{"Are you sure to remove {0}?":"Are you sure to remove {0}?"},"zh-TW":{"Are you sure to remove {0}?":"你確定要刪除{0}嗎？"}}'),delete t.options._Ctor}},234:function(t,e,a){"use strict";var s=a(147);a.n(s).a},235:function(t,e,a){(t.exports=a(6)(!1)).push([t.i,".hide[data-v-7812b932]{display:none}",""])},236:function(t,e,a){"use strict";var s=a(148),i=a.n(s);e.default=i.a},248:function(t,e,a){"use strict";a.r(e);function s(){var s=this,t=s.$createElement,i=s._self._c||t;return i("div",{staticClass:"ui segment form"},[i("h2",[s._v(s._s(s.$t("Material Management")))]),s._v(" "),i("div",{staticClass:"ui segment"},[i("div",{staticClass:"unstackable three fields"},[i("div",{staticClass:"field"},[i("label",{attrs:{for:"MaterialName"}},[s._v("\r\n          "+s._s(s.$t("Material Name"))+"\r\n        ")]),s._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:s.filename,expression:"filename"}],attrs:{type:"text",id:"MaterialName",size:"20",name:"MaterialName"},domProps:{value:s.filename},on:{input:function(t){t.target.composing||(s.filename=t.target.value)}}})]),s._v(" "),i("div",{staticClass:"field"},[i("label",{attrs:{for:"MaterialAsset"}},[s._v("\r\n          "+s._s(s.$t("File"))+"\r\n          "),i("a",{attrs:{href:"/materials/example-material.zip"}},[s._v("\r\n            ("+s._s(s.$t("example"))+")\r\n          ")])]),s._v(" "),i("input",{ref:"FileInput",attrs:{type:"file",id:"MaterialAsset",name:"MaterialAsset",accept:"application/zip"},on:{change:s.checkEnableUpload}})]),s._v(" "),i("div",{staticClass:"field"},[i("label",[s._v("\r\n           \r\n        ")]),s._v(" "),i("button",{staticClass:"ui fluid button",class:{disabled:!s.enableUpload},attrs:{type:"button"},on:{click:s.upload}},[s._v("\r\n          "+s._s(s.$t("UPLOAD"))+"\r\n        ")])])])]),s._v(" "),i("input",{ref:"EditUploadInput",staticClass:"hide",attrs:{type:"file",accept:"application/zip"},on:{change:s.editUpload}}),s._v(" "),i("pagination",{attrs:{pageConfig:s.pageConfig}}),s._v(" "),i("table",{staticClass:"ui unstackable table"},[i("thead",[i("tr",["global_admin"===s.status.role?i("th",[s._v("\r\n          "+s._s(s.$t("Domain"))+"\r\n        ")]):s._e(),s._v(" "),i("th",[s._v("\r\n          "+s._s(s.$t("Filename"))+"\r\n        ")]),s._v(" "),i("th",[s._v("\r\n          "+s._s(s.$t("Date"))+"\r\n        ")]),s._v(" "),i("th",[s._v("\r\n          "+s._s(s.$t("Management"))+"\r\n        ")])])]),s._v(" "),i("tbody",s._l(s.assets,function(e,a){return i("tr",["global_admin"===s.status.role?i("td",[s._v("\r\n          "+s._s(e.domain_id)+"\r\n        ")]):s._e(),s._v(" "),i("td",[i("div",{staticClass:"ui action input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.filename,expression:"asset.filename"}],attrs:{type:"text"},domProps:{value:e.filename},on:{input:[function(t){t.target.composing||s.$set(e,"filename",t.target.value)},function(t){return s.change(e.id)}]}}),s._v(" "),i("button",{staticClass:"ui icon button",class:{disabled:!s.isAssetChanged(e.id),green:s.isAssetChanged(e.id)},attrs:{type:"button"},on:{click:function(t){return s.edit(a)}}},[i("i",{staticClass:"edit icon"})])])]),s._v(" "),i("td",[s._v("\r\n          "+s._s(e.date)+"\r\n        ")]),s._v(" "),i("td",[i("div",{staticClass:"unstackable three fields"},[i("div",{staticClass:"field"},[i("a",{staticClass:"ui icon button",attrs:{target:"_blank",href:"/material/asset/"+e.id+"/"}},[i("i",{staticClass:"linkify icon"})])]),s._v(" "),i("div",{staticClass:"field"},[i("button",{staticClass:"ui icon button",attrs:{type:"button"},on:{click:function(t){return s.editUploadTrigger(e.id)}}},[i("i",{staticClass:"upload icon"})])]),s._v(" "),i("div",{staticClass:"field"},[i("button",{staticClass:"ui icon button",attrs:{type:"button"},on:{click:function(t){return s.remove(a)}}},[i("i",{staticClass:"close icon"})])])])])])}),0)]),s._v(" "),i("pagination",{attrs:{pageConfig:s.pageConfig,pathPrefix:"/materials/"}})],1)}s._withStripped=!0;var i,n,r,l,o,u=a(0),p=a.n(u),c=a(1),f=a.n(c),d=a(2),h=a.n(d),g={props:["lib","status","config","progress","error","view"],data:function(){return this.$i18n.locale=this.config.locale,{filename:"",file:null,assets:[],changedIDs:[],editUploadAssetID:null,pageConfig:{page:0,maxPage:0}}},computed:{enableUpload:function(){return""!==this.filename&&null!==this.file}},watch:{"pageConfig.page":function(){if(!1===isNaN(this.pageConfig.page)){var t=this.$route.params.page;!0!==isNaN(t)&&parseInt(t,10)===this.pageConfig.page||(this.$router.push("/material/"+this.pageConfig.page),localStorage.setItem("Material.page",this.pageConfig.page),this.list())}}},mounted:function(){this.initPage(),this.status.title=this.$t("Material Assets Management"),this.list()},methods:{initPage:function(){if(!0===isNaN(this.$route.params.page)){var t=localStorage.getItem("Material.page");!1===isNaN(t)&&null!==t?this.pageConfig.page=t:this.pageConfig.page=1}else this.pageConfig.page=parseInt(this.$route.params.page,10)},list:(o=h()(p.a.mark(function t(){var e;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.lib.AxiosHelper.get("/Admin/MaterialAsset/list",{page:this.pageConfig.page});case 2:if(e=t.sent,"object"!==f()(e)){t.next=10;break}if(!Array.isArray(e.assets)){t.next=9;break}if(0===e.assets.length)return 1!==this.pageConfig.page&&(this.pageConfig.page=1),t.abrupt("return",!1);t.next=8;break;case 8:this.assets=e.assets;case 9:"number"==typeof e.maxPage&&(this.pageConfig.maxPage=e.maxPage);case 10:case"end":return t.stop()}},t,this)})),function(){return o.apply(this,arguments)}),checkEnableUpload:function(){this.file=this.$refs.FileInput.files[0]},reset:function(){this.filename="",this.file=null,this.$refs.FileInput.value=""},upload:(l=h()(p.a.mark(function t(){var e;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.lib.AxiosHelper.upload("/Admin/MaterialAsset/upload",{asset:this.file,filename:this.filename});case 2:e=t.sent,this.assets.unshift({id:e.assetID,domain_id:e.domainID,date:e.date,filename:this.filename}),this._sortAssets(),this.reset();case 6:case"end":return t.stop()}},t,this)})),function(){return l.apply(this,arguments)}),_sortAssets:function(){this.assets=this.assets.sort(function(t,e){return t.filename>e.filename?1:-1})},change:function(t){for(var e=0;e<this.assets.length;e++){var a=this.assets[e];if(a.id===t&&""===a.filename)return!1}-1===this.changedIDs.indexOf(t)&&this.changedIDs.push(t)},isAssetChanged:function(t){for(var e=0;e<this.assets.length;e++){var a=this.assets[e];if(a.id===t&&""===a.filename)return!1}return-1<this.changedIDs.indexOf(t)},edit:(r=h()(p.a.mark(function t(e){var a,s;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""===(a=this.assets[e]).filename)return t.abrupt("return",!1);t.next=3;break;case 3:return t.next=5,this.lib.AxiosHelper.upload("/Admin/MaterialAsset/edit",{assetID:a.id,filename:a.filename});case 5:if(0===(s=t.sent)||null===s)return t.abrupt("return",!1);t.next=8;break;case 8:this.changedIDs=this.changedIDs.filter(function(t){return t!==a.id}),this._sortAssets();case 10:case"end":return t.stop()}},t,this)})),function(t){return r.apply(this,arguments)}),remove:(n=h()(p.a.mark(function t(e){var a,s,i;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""===(a=this.assets[e]).filename)return t.abrupt("return",!1);t.next=3;break;case 3:if(s=this.$t("Are you sure to remove {0}?",[a.filename]),!1===window.confirm(s))return t.abrupt("return",!1);t.next=6;break;case 6:return t.next=8,this.lib.AxiosHelper.upload("/Admin/MaterialAsset/remove",{assetID:a.id});case 8:if(0===(i=t.sent)||null===i)return t.abrupt("return",!1);t.next=11;break;case 11:this.changedIDs=this.changedIDs.filter(function(t){return t!==a.id}),this.assets.splice(e,1);case 13:case"end":return t.stop()}},t,this)})),function(t){return n.apply(this,arguments)}),editUploadTrigger:function(t){this.editUploadAssetID=t,this.$refs.EditUploadInput.click()},editUpload:(i=h()(p.a.mark(function t(){return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.lib.AxiosHelper.upload("/Admin/MaterialAsset/editUpload",{assetID:this.editUploadAssetID,asset:this.$refs.EditUploadInput.files[0]});case 2:1===t.sent&&window.alert(this.$t("File uploaded.")),this.editUploadAssetID=null,this.$refs.EditUploadInput.value="";case 6:case"end":return t.stop()}},t,this)})),function(){return i.apply(this,arguments)})}},m=(a(234),a(3)),v=a(236),_=Object(m.a)(g,s,[],!1,null,"7812b932",null);"function"==typeof v.default&&Object(v.default)(_),_.options.__file="webpack-app/admin/components/Material/Material.vue";e.default=_.exports}}]);